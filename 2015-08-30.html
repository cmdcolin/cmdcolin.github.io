<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/_next/static/css/82eb5efba2a6c9217a68.css" as="style"/><link rel="stylesheet" href="/_next/static/css/82eb5efba2a6c9217a68.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="/_next/static/chunks/webpack-1a8a258926ecde76681b.js" defer=""></script><script src="/_next/static/chunks/framework-b97a0ed4f13ff8397343.js" defer=""></script><script src="/_next/static/chunks/main-1f2c591c5d3bfcfc95e6.js" defer=""></script><script src="/_next/static/chunks/pages/_app-72a03db9ecdc52193d45.js" defer=""></script><script src="/_next/static/chunks/pages/2015-08-30-b54af3f07ecc707bdbe9.js" defer=""></script><script src="/_next/static/rS_NqY-qYMlI9kxUhJzBJ/_buildManifest.js" defer=""></script><script src="/_next/static/rS_NqY-qYMlI9kxUhJzBJ/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div><div><a href="/">Return home</a><img src="/avatar.png" style="height:2em;margin-left:1em"/></div><div class="blog"><h1>Weekend project: graphing tumblr reblogs using cytoscape.js</h1><p>In the past, I made an app that used RStudio&#x27;s Shiny platform to plot
network graphs with RGraphviz. This worked, and gave some nice results,
but when I found out about cytoscape.js, I really wanted to try that
out.</p><p>The app is designed to plot tumblr reblogs, so it has a tree structure,
but simply plotting things as a tree is not very space efficient (as in,
the visualization takes up too much space). Therefore, using different
types of layouts can really help. </p><p>In my first app with graphviz
<a href="https://colindiesh.shinyapps.io/tumblrgraph">https://colindiesh.shinyapps.io/tumblrgraph</a>, there are several
built-in graph layouts including &quot;neato&quot; &quot;twopi&quot;, &quot;circo&quot;, and &quot;dot&quot;</p><p>I made all of these available for users to try in the Shiny app. The
names of the layouts don&#x27;t lend much to their behavior, but they are
built-in functions in Graphviz. There are both &quot;tree&quot; and
&quot;force-directed&quot; style graph views. As I mentioned, the &quot;tree&quot; style
view make a lot of sense for the tumblr reblogs, but the force directed
graphs are also a lot more compact, so offering both styles is useful. </p><p><img src="../../media/128000908903_0.png"/></p><p>Figure 1. My default example graph from graphviz using the twopi layout.</p><p>I wanted to replicate all the features that I had in the Graphviz app in
Cytoscape.js. Here is the breakdown of the basic components that needed
replicating:</p><ol><li><p>Build the &quot;graph&quot; representation of reblogs in memory</p></li><li><p>Add user forms and configurability</p></li><li><p>Add color for distance from root using a breadth first search</p></li><li><p>Draw the graph</p></li></ol><p>As I went along, I was happy to learn that the concepts mapped very
easily to javascript and cytoscape.js. The implementations are a little
different, but it worked out very nicely.</p><p><img src="../../media/128000908903_1.png"/></p><p>Figure 2. Same data plotted in Cytoscape.js with the springy layout.</p><p>In the new app, we enabled several different layouts similar to the
Graphviz app too. In cytoscape.js, the layouts that are offered
include &quot;arbor&quot;, &quot;springy&quot;, &quot;cola&quot;, &quot;cose&quot;, and &quot;dagre&quot;. I like &quot;cola&quot;
because it really looks like bubbles moving around in a soda. Others are
worth experimenting with too.</p><p><img src="../../media/128000908903_2.png"/></p><p>Figure 3. A Cytoscape.js springy layout for a larger tumblr reblog graph</p><p>The new cytoscape.js app also has a nice animation feature. The old
graphviz app offered animation too (using Yihui&#x27;s animation library for
R) but the new version can automatically encode HTML5 video on the
client side from individual picture frames in the browser using
<a href="https://github.com/antimatter15/whammy">&quot;Whammy&quot;</a>! This quite
impressive!</p><p>So to animate the graph, what is done is</p><ol><li><p>Add nodes/edges and layout the graph (the simulation time is
configurable, because allowing the user to interact with the graph while
the simulation is running is useful)</p></li><li><p>Once layout is complete, the user can save the graph as an
animation, which first hides all nodes by adding visibility: hidden to
the CSS.</p></li><li><p>Then the nodes are re-shown one-by-one, preserving the layout, and a
frame is saved by the renderer at each step (takes a snapshot of the
canvas).</p></li></ol><p>This strategy for the animation is actually better than the original
graphviz version that I had because the layout is only done once, which
is time saving and it is also more consistent (the layout changes a lot
if you re run it on different sets of nodes). </p><p>Check out the app here <a href="http://cmdcolin.github.io/tumblrgraph2/">http://cmdcolin.github.io/tumblrgraph2/</a></p><p>Future goals:</p><ul><li>Test out super large graphs (I have tested up to about 500 reblogs
but after this, around 1000 reblogs, it slows down a lot and produces
bad layouts. Needs fixing)</li><li>Test out ability to place importance on certain nodes by increasing
node size based on it&#x27;s degree</li></ul><p>Check out an example of the HTML5 video here</p><p>::: {#footer}
<!-- -->[ August 30th, 2015 11:49pm ]<!-- -->{#timestamp} <!-- -->[cytoscapejs]<!-- -->{.tag}
<!-- -->[cytoscape]<!-- -->{.tag} <!-- -->[javascript]<!-- -->{.tag}
:::</p></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/2015-08-30","query":{},"buildId":"rS_NqY-qYMlI9kxUhJzBJ","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>