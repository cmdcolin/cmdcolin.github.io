{"pageProps":{"allPosts":[{"title":"Photos of life","date":"2022-07-29","slug":"2022-07-29-happy","mdxSource":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    img: \"img\",\n    a: \"a\"\n  }, _provideComponents(), props.components);\n  return _jsxs(_Fragment, {\n    children: [_jsx(_components.p, {\n      children: \"I started this post to try to talk about things that make me happy. It's not\\nreally a happiness though that I wanted to talk about, it's just about living\\nlife...sometimes it's a struggle and that can be rewarding also. So here are\\nsome photos of everyday things\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://cmdcolinphotos.s3.amazonaws.com/IMG_20220619_201622482.resized.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"sunset from backyard\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://cmdcolinphotos.s3.amazonaws.com/IMG_20220622_100019949.resized.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"a dog named remy i saw at the dog park visiting parents. remy has a funny habit of herding other dogs around\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://cmdcolinphotos.s3.amazonaws.com/IMG_20220624_210922889.resized.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"the sky from my parents backyard\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://cmdcolinphotos.s3.amazonaws.com/IMG_20220626_071349516.resized.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"my parents dogs zoe (right) and tux (left). my parents walk them everyday and it's great to join them\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://cmdcolinphotos.s3.amazonaws.com/IMG_20220627_145201639_HDR.resized.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"not everything is perfect in the world. the rental i live at is letting the place fall apart due to leaks in the roof\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://cmdcolinphotos.s3.amazonaws.com/IMG_20220704_133123492.resized.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"a salad I made with jicama, carrot, greens, and orange on memorial day\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://cmdcolinphotos.s3.amazonaws.com/IMG_20220705_200242153_HDR.resized.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"some hazy sun before a rainstorm in NM\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://cmdcolinphotos.s3.amazonaws.com/IMG_20220705_201600095_HDR.resized.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"some sun after the rain\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://cmdcolinphotos.s3.amazonaws.com/IMG_20220709_111938701_HDR.resized.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"cooking purple potatos\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://cmdcolinphotos.s3.amazonaws.com/IMG_20220709_115455797.resized.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"after cooking the purple potatos\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://cmdcolinphotos.s3.amazonaws.com/IMG_20220709_175755642.resized.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"hummingbird hanging out in the backyard\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://cmdcolinphotos.s3.amazonaws.com/IMG_20220710_175851539_HDR.resized.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"a fresno pepper from my weird backyard garden (all potted plants)\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://cmdcolinphotos.s3.amazonaws.com/IMG_20220713_200957865.resized.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"beezle hanging out in his favorite spot, on top of a box spring in the hallway\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://cmdcolinphotos.s3.amazonaws.com/IMG_20220714_200346243.resized.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"the belt I made for myself from a piece of leather that i found in a shop when I visited toronto pre-pandemic (more pics from making it \", _jsx(_components.a, {\n        href: \"https://imgur.com/a/Ff5Mn3l\",\n        children: \"https://imgur.com/a/Ff5Mn3l\"\n      }), \")\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://cmdcolinphotos.s3.amazonaws.com/IMG_20220715_230433785.resized.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"fruit and yogurts\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://cmdcolinphotos.s3.amazonaws.com/IMG_20220716_132939371.resized.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"making a drip irrigation system for my weird garden. the sunset timer was particularly funny. I put the battery pack in backwards and it didn't work, and took it apart to fully understand the mechanism (had to see how the battery contacts touched the inside of the system to see it)\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://cmdcolinphotos.s3.amazonaws.com/IMG_20220717_204303427_HDR.resized.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"pork belly\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://cmdcolinphotos.s3.amazonaws.com/IMG_20220717_210017665.resized.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"bibimbap with pork belly\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://cmdcolinphotos.s3.amazonaws.com/IMG_20220718_174420132_HDR.resized.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"some little tomatos. these were eaten by catepillars shortly after taking these. battling these little critters has been a learning experience\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://cmdcolinphotos.s3.amazonaws.com/IMG_20220719_173156813.resized.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"chicken thighs\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://cmdcolinphotos.s3.amazonaws.com/IMG_20220719_173426354.resized.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"jamaican jerk style sauce\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://cmdcolinphotos.s3.amazonaws.com/IMG_20220719_181601967_HDR.resized.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"using a meat thermometer+grill...been a real level-up\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://cmdcolinphotos.s3.amazonaws.com/IMG_20220719_184903147.resized.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"cooked, perhaps overly so, but quite juicy still due to brining\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://cmdcolinphotos.s3.amazonaws.com/IMG_20220720_174949541_HDR.resized.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"my funny backyard setup, the bowl makes little sounds when it rains (sound recording \", _jsx(_components.a, {\n        href: \"https://cmdcolinphotos.s3.amazonaws.com/out.mp3\",\n        children: \"https://cmdcolinphotos.s3.amazonaws.com/out.mp3\"\n      }), \")\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://cmdcolinphotos.s3.amazonaws.com/IMG_20220722_201326050_HDR.resized.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"synthesizering\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://cmdcolinphotos.s3.amazonaws.com/IMG_20220724_104240569.resized.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"cooked down some strawberries that my neighbor gave me, she's awesome\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://cmdcolinphotos.s3.amazonaws.com/IMG_20220725_095848819_HDR.resized.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"beezle in his tree\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://cmdcolinphotos.s3.amazonaws.com/IMG_20220725_111117447.resized.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"my brother came to visit me, synthesizering around the breakfast table\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://cmdcolinphotos.s3.amazonaws.com/IMG_20220725_111129150.resized.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"beezle playing the synth\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://cmdcolinphotos.s3.amazonaws.com/IMG_20220725_164816159.resized.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"making some kimchi and saurkraut. these got quite bubbly and active, quite fun to make. should get some airlock jars\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://cmdcolinphotos.s3.amazonaws.com/IMG_20220726_162730132_HDR.resized.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"my brother and I visiting the dry river bed of the rio grande in south albuquerque\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://cmdcolinphotos.s3.amazonaws.com/IMG_20220726_163019069_HDR.resized.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"more dry rio grande. note that many the irrigation ditches around the rio are flowing full...\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://cmdcolinphotos.s3.amazonaws.com/IMG_20220728_170257266_HDR.resized.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"the rio grande north of albuquerque is still flowing\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://cmdcolinphotos.s3.amazonaws.com/IMG_20220728_174207531_HDR.resized.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"very tiny purple flowers\"\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{}}},{"title":"Watch out for your pinky finger","date":"2022-07-08","slug":"2022-07-08-pinky","mdxSource":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    h3: \"h3\",\n    ul: \"ul\",\n    li: \"li\",\n    h2: \"h2\",\n    a: \"a\",\n    img: \"img\"\n  }, _provideComponents(), props.components);\n  return _jsxs(_Fragment, {\n    children: [_jsx(_components.p, {\n      children: \"I have, for several months, suffered a twinge in my left pinky finger from\\nexcessive strain due to hand contortions largely caused by keyboard use.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Particularly brutal in my opinion has been the use of the left-ctrl key for\\nkeyboard shortcuts\"\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Programs that are particularly troublesome for the left pinky\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"many programs: ctrl+c, ctrl+v, ctrl+x, ctrl+f\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"terminal: shift+ctrl+v to paste\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"tmux: default ctrl+somekey as leader\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"chrome: ctrl+w to close tab, ctrl+t for new tab, ctrl+r for refresh,\\nshift+ctrl+r for cache-cleared refresh\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"vim: using esc key on the far left, custom configurations using ctrl key e.g.\\nctrl+p (I also had ctrl+g, ctrl+f for custom file finders for awhile but no\\nlonger)\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"In order to make these movements, particularly if you use the left hand to do\\nit, you have to contort your hand pretty drastically. Chrome is particularly\\nbad because it is not possible(?) to reconfigure their keyboard shortcuts.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Unfortunately, I did not really listen to warning signs from my hand, and now\\nthere is a mild pain from almost any keyboard usage\"\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"General approaches to help out\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"Take time out of my day e.g. pomodoro to take rests\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Taking a vacation\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Do hand exercises and stretches when idle\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Massages to the muscles\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Using touch typing, making my hands float above the keyboard when typing\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Avoiding curling up the pinky while typing (this may just be me suffering at this point)\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Use both hands to execute shortcuts instead of contorting left hand\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Technical approaches and key remappings\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"Remap caps lock to left+ctrl. This is a common one you hear recommended and\\nit may help, and it has less contortion, particularly for chrome with one\\nhand use. So you can say capslock+w, capslock+t, but it is still using pinky\\nand can be stressful if not careful (capslock+w fine, capslock+t still\\ncontortion if done with one hand)\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"More use of the right-hand-only shortcuts or at least avoiding using the left\\npinky for shortcuts. I don't have many of these but will look into retraining\\nmyself for some of these. I am testing out right ctrl+] for leader in tmux,\\nand - and = for split window horizontal and vertical\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Conclusion\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"It is not great to get to this point. My hand posture and body posture at the\\nkeyboard has been bad for years, and it has caught up to me. I recommend people\\nbe aware of contorting their hand too much, and use good keyboard etiquette\\nlest they suffer the same!\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Any more ideas?\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Let me know of ways you take care of your hands (hardware, software, or\\notherwise)\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Other resources\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"See this post by Matt Might for some more resources\\n\", _jsx(_components.a, {\n        href: \"https://matt.might.net/articles/preventing-and-managing-rsi/\",\n        children: \"https://matt.might.net/articles/preventing-and-managing-rsi/\"\n      })]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Extenuating circumstances\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"I am not sure if it really affects my typing, but I was bitten by a dog several\\nyears ago. The dog clamped down on both my hands one after the other and got my\\nleft especially bad, which required stitches. One fairly deep puncture was on\\nthe left side of my left hand, which could plausibly affect my pinky. Photo\\nbelow\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/photos/pinky.jpg\",\n        alt: \"\"\n      })\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{}}},{"title":"You may not need a bundler for your NPM library","date":"2022-05-27","slug":"2022-05-27-youmaynotneedabundler","mdxSource":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    ul: \"ul\",\n    li: \"li\",\n    a: \"a\",\n    code: \"code\",\n    h2: \"h2\",\n    em: \"em\",\n    h3: \"h3\",\n    pre: \"pre\",\n    h4: \"h4\",\n    strong: \"strong\"\n  }, _provideComponents(), props.components);\n  return _jsxs(_Fragment, {\n    children: [_jsx(_components.p, {\n      children: \"I have seen a couple threads on twitter where people complain about the\\ndifficulty with publishing NPM libraries or ask what starter kit they should\\nuse (or, people recommended starter packs anyways)\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Example threads\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: _jsx(_components.a, {\n          href: \"https://twitter.com/cramforce/status/1513903035197526017\",\n          children: \"https://twitter.com/cramforce/status/1513903035197526017\"\n        })\n      }), \"\\n\", _jsx(_components.li, {\n        children: _jsx(_components.a, {\n          href: \"https://twitter.com/oleg008/status/1510006191296061441\",\n          children: \"https://twitter.com/oleg008/status/1510006191296061441\"\n        })\n      }), \"\\n\", _jsx(_components.li, {\n        children: _jsx(_components.a, {\n          href: \"https://twitter.com/iansu/status/1524860613943382017\",\n          children: \"https://twitter.com/iansu/status/1524860613943382017\"\n        })\n      }), \"\\n\", _jsx(_components.li, {\n        children: _jsx(_components.a, {\n          href: \"https://twitter.com/mpocock1/status/1525075901905522691\",\n          children: \"https://twitter.com/mpocock1/status/1525075901905522691\"\n        })\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"One thing that is notable to me in these threads is that people often recommend\\nthat you use a bundler (a program that combines multiple src files into a\\nsingle or fewer output files) when developing a library\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Examples of starter packs suggested in these threads that use bundlers\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          children: \"microbundle\"\n        }), \" - \", _jsx(_components.a, {\n          href: \"https://github.com/developit/microbundle\",\n          children: \"https://github.com/developit/microbundle\"\n        }), \" - uses rollup\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          children: \"esno\"\n        }), \" - \", _jsx(_components.a, {\n          href: \"https://www.npmjs.com/package/esno\",\n          children: \"https://www.npmjs.com/package/esno\"\n        }), \" - uses esbuild\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          children: \"unbuild\"\n        }), \" - \", _jsx(_components.a, {\n          href: \"https://github.com/unjs/unbuild\",\n          children: \"https://github.com/unjs/unbuild\"\n        }), \" - uses rollup\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          children: \"preconstruct\"\n        }), \" - \", _jsx(_components.a, {\n          href: \"https://github.com/preconstruct/preconstruct\",\n          children: \"https://github.com/preconstruct/preconstruct\"\n        }), \" - uses rollup\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          children: \"tsup\"\n        }), \" - \", _jsx(_components.a, {\n          href: \"https://github.com/egoist/tsup\",\n          children: \"https://github.com/egoist/tsup\"\n        }), \" - uses esbuild\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          children: \"tsdx\"\n        }), \" - \", _jsx(_components.a, {\n          href: \"https://github.com/jaredpalmer/tsdx\",\n          children: \"https://github.com/jaredpalmer/tsdx\"\n        }), \" - uses rollup\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          children: \"vite library mode\"\n        }), \" - \", _jsx(_components.a, {\n          href: \"https://vitejs.dev/guide/build.html#library-mode\",\n          children: \"https://vitejs.dev/guide/build.html#library-mode\"\n        }), \" - uses rollup\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          children: \"packemon\"\n        }), \" - \", _jsx(_components.a, {\n          href: \"https://github.com/milesj/packemon\",\n          children: \"https://github.com/milesj/packemon\"\n        }), \" - uses rollup\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          children: \"ts-library-template\"\n        }), \" - \", _jsx(_components.a, {\n          href: \"https://github.com/shortercode/ts-library-template\",\n          children: \"https://github.com/shortercode/ts-library-template\"\n        }), \" - uses rollup\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          children: \"parcel\"\n        }), \" - \", _jsx(_components.a, {\n          href: \"https://twitter.com/devongovett/status/1524944991402999810\",\n          children: \"https://twitter.com/devongovett/status/1524944991402999810\"\n        }), \" - uses parcel\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          children: \"dts\"\n        }), \" - \", _jsx(_components.a, {\n          href: \"https://weiran-zsd.github.io/dts-cli/\",\n          children: \"https://weiran-zsd.github.io/dts-cli/\"\n        }), \" - uses rollup\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          children: \"pkgroll\"\n        }), \" - \", _jsx(_components.a, {\n          href: \"https://github.com/privatenumber/pkgroll\",\n          children: \"https://github.com/privatenumber/pkgroll\"\n        }), \" - uses rollup\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          children: \"mkdist\"\n        }), \" - \", _jsx(_components.a, {\n          href: \"https://github.com/unjs/mkdist\",\n          children: \"https://github.com/unjs/mkdist\"\n        }), \" - referenced by \", _jsx(_components.code, {\n          children: \"unbuild\"\n        }), \", uses esbuild\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Not using bundlers\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          children: \"gts\"\n        }), \" - \", _jsx(_components.a, {\n          href: \"https://github.com/google/gts\",\n          children: \"https://github.com/google/gts\"\n        })]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          children: \"ts-react-toolbox\"\n        }), \" - \", _jsx(_components.a, {\n          href: \"https://github.com/zzarcon/ts-react-toolbox/\",\n          children: \"https://github.com/zzarcon/ts-react-toolbox/\"\n        })]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"In summary 2/15 do not use a bundler, 13/15 do use a bundler. Sidenote: webpack notably absent\"\n    }), \"\\n\", _jsxs(_components.h2, {\n      children: [\"Why would you \", _jsx(_components.em, {\n        children: \"NOT\"\n      }), \" want a bundler for your library?\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"My main argument is that the consumer of your library is the one that should\\nuse a bundler if it is relevant to them. If the library uses a bundler:\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"in the best case, it has no impact on the consumer\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"in the worst case, it affects the complexity of your library and makes\\npossible limitations for your consumers also.\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"An example where it can actually create limitations, you might consider code\\nsplitting with async \", _jsx(_components.code, {\n        children: \"import()\"\n      }), \". If you create a single file bundle, then the\\nconsumer of your library may not be able to do code splitting properly via\\nasync \", _jsx(_components.code, {\n        children: \"import()\"\n      })]\n    }), \"\\n\", _jsxs(_components.h2, {\n      children: [\"Why would you \", _jsx(_components.em, {\n        children: \"MAYBE\"\n      }), \" want a bundler for your library\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"If you really care about producing a \", _jsx(_components.code, {\n        children: \"UMD\"\n      }), \" bundle that can be used in a script\\ntag, maybe you want a bundler, but the future does not seem to be in \", _jsx(_components.code, {\n        children: \"UMD\"\n      }), \".\\nOne other possible bundle type is maybe you like the idea of a single file\\n\", _jsx(_components.code, {\n        children: \"ESM\"\n      }), \" module. It is similar where you could maybe reference this from a script\\ntag with type module, but this seems like a niche usage. For example, you\\nwould still have to consider:\"]\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"If you are not bundling dependencies, then what is the benefit of using a\\nbundler?\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"If you are bundling dependencies, you are not allowing people to get updates\\nto your sub-dependencies with semver!\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Add-on: Another concern brought up by users in discussion thread: There is a\\ncost to having many small files, e.g. in app startup cost on serverless or any\\nnodejs application to loading many small files off disk. To me, this is an app\\nlevel concern, similar to bundling for the browser though.\"\n    }), \"\\n\", _jsxs(_components.h2, {\n      children: [\"My suggestion: no bundler, no starter pack, just \", _jsx(_components.code, {\n        children: \"tsc\"\n      })]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"I'd recommend just compiling your code with \", _jsx(_components.code, {\n        children: \"tsc\"\n      }), \", no bundler involved. This\\nway, you can develop with typescript, it will output \", _jsx(_components.code, {\n        children: \"js\"\n      }), \" files, and you can\\ndirectly deploy a \", _jsx(_components.code, {\n        children: \"dist\"\n      }), \" folder of \", _jsx(_components.code, {\n        children: \"js\"\n      }), \" files to NPM.\"]\n    }), \"\\n\", _jsxs(_components.h3, {\n      children: [\"Example \", _jsx(_components.code, {\n        children: \"package.json\"\n      })]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-json\",\n        children: \"{\\n  \\\"name\\\": \\\"yourlib\\\",\\n  \\\"version\\\": \\\"1.0.0\\\",\\n  \\\"main\\\": \\\"dist/index.js\\\",\\n  \\\"scripts\\\": {\\n    \\\"clean\\\": \\\"rimraf dist\\\",\\n    \\\"prebuild\\\": \\\"npm run clean\\\",\\n    \\\"build\\\": \\\"tsc\\\",\\n    \\\"preversion\\\": \\\"npm run build\\\",\\n    \\\"postversion\\\": \\\"git push --follow-tags\\\"\\n  },\\n  \\\"files\\\": [\\\"dist\\\", \\\"src\\\"],\\n  \\\"devDependencies\\\": {\\n    \\\"rimraf\\\": \\\"^3.0.2\\\",\\n    \\\"typescript\\\": \\\"^4.6.2\\\"\\n  }\\n}\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.h4, {\n      children: [\"Features of the above \", _jsx(_components.code, {\n        children: \"package.json\"\n      })]\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [\"We can use a single command, \", _jsx(_components.code, {\n          children: \"yarn publish\"\n        }), \" to publish to npm\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"The single \", _jsx(_components.code, {\n          children: \"yarn publish\"\n        }), \" automatically runs \", _jsx(_components.code, {\n          children: \"clean\"\n        }), \" and \", _jsx(_components.code, {\n          children: \"build\"\n        }), \" via\\n\", _jsx(_components.code, {\n          children: \"preversion\"\n        }), \", then \", _jsx(_components.code, {\n          children: \"postversion\"\n        }), \", which pushes the tag to the remote repo\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"The \", _jsx(_components.code, {\n          children: \"\\\"files\\\": [\\\"dist\\\", \\\"src\\\"]\"\n        }), \" refers to publishing the \", _jsx(_components.code, {\n          children: \"dist\"\n        }), \" and \", _jsx(_components.code, {\n          children: \"src\"\n        }), \"\\ndirectories, and src is used for the \", _jsx(_components.code, {\n          children: \"sourceMap\"\n        })]\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.h3, {\n      children: [\"Example\", _jsx(_components.code, {\n        children: \" tsconfig.json\"\n      })]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-json\",\n        children: \"{\\n  \\\"include\\\": [\\\"src\\\"],\\n  \\\"compilerOptions\\\": {\\n    \\\"target\\\": \\\"es2018\\\",\\n    \\\"outDir\\\": \\\"dist\\\",\\n    \\\"lib\\\": [\\\"dom\\\", \\\"esnext\\\"],\\n    \\\"declaration\\\": true,\\n    \\\"moduleResolution\\\": \\\"node\\\",\\n    \\\"sourceMap\\\": true,\\n    \\\"strict\\\": true,\\n    \\\"esModuleInterop\\\": true\\n  }\\n}\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.h4, {\n      children: [\"Features of the above \", _jsx(_components.code, {\n        children: \"tsconfig.json\"\n      })]\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [\"Uses \", _jsx(_components.code, {\n          children: \"\\\"moduleResolution\\\": \\\"node\\\"\"\n        }), \" - this is not pure-ESM because pure-ESM\\nexpects you to import filenames with their file extension, while node module\\nresolution can import extensionless paths, but node module resolution\\ngenerally works well with consumers that use bundlers themselves\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"Uses \", _jsx(_components.code, {\n          children: \"\\\"target\\\": \\\"es2018\\\"\"\n        }), \" - This is does a small amount of transpilation of\\nsuper modern features, but would generally not require your users to\\nbabel-ify their \", _jsx(_components.code, {\n          children: \"node_modules\"\n        }), \" if they consume your library\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"What about testing?\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Adding testing is not immediately solved by the above, but bundling doesn't\\nreally help testing anyways. It's just a starter pack feature we can add on.\\nSome options you have include\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [\"Use \", _jsx(_components.code, {\n          children: \"ts-jest\"\n        })]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"Use \", _jsx(_components.code, {\n          children: \"jest\"\n        }), \" on it's own, plus a \", _jsx(_components.code, {\n          children: \"babel\"\n        }), \" config with \", _jsx(_components.code, {\n          children: \"@babel/preset-typescript\"\n        })]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"Use \", _jsx(_components.code, {\n          children: \"jest\"\n        }), \" on it's own, run over the compiled output without a \", _jsx(_components.code, {\n          children: \"babel\"\n        }), \" config\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"Use \", _jsx(_components.code, {\n          children: \"vitest\"\n        })]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"Possibly something else? Node now has a built-in test runner. It will be a\\nslow road to adoption but might become more popular over time\\n\", _jsx(_components.a, {\n          href: \"https://fusebit.io/blog/node-testing-comes-to-core/\",\n          children: \"https://fusebit.io/blog/node-testing-comes-to-core/\"\n        })]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Conclusion\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"It is tempting to have nice zero-config solutions and starter kits, but to me,\\nit is not really beneficial to use the bundler aspect of many of these for\\npublishing to NPM. Am I wrong? Let me know if I am.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Also, these starter kits may not be maintained for perpetuity. Our team used\\n\", _jsx(_components.code, {\n        children: \"tsdx\"\n      }), \" for some time, but it was not maintained well, and used old typescript\\nversion 3.x, and it ended up being hard to remove from our codebase. Learning\\nthe basic tools like \", _jsx(_components.code, {\n        children: \"tsc\"\n      }), \" will help\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Footnote 1: Shipping \\\"pure-ESM\\\"\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Do you want to make a pure-ESM package? Then you do not want to use\\n\", _jsx(_components.code, {\n        children: \"\\\"moduleResolution\\\": \\\"node\\\"\"\n      }), \" in \", _jsx(_components.code, {\n        children: \"tsconfig.json\"\n      }), \", and you will want to set\\n\", _jsx(_components.code, {\n        children: \"\\\"type\\\": \\\"module\\\"\"\n      }), \" in \", _jsx(_components.code, {\n        children: \"package.json\"\n      }), \". You may also need to explicitly import\\nwith \", _jsx(_components.code, {\n        children: \".js\"\n      }), \" extensions in your source code, even if you write \", _jsx(_components.code, {\n        children: \".ts\"\n      }), \". This is\\nawkward, and something the community is still grappling with.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"If you have ever stumbled on this topic, you will probably want to see this\\nlink\\n\", _jsx(_components.a, {\n        href: \"https://gist.github.com/sindresorhus/a39789f98801d908bbc7ff3ecc99d99c\",\n        children: \"https://gist.github.com/sindresorhus/a39789f98801d908bbc7ff3ecc99d99c\"\n      })]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Footnote 2: Shipping ESM and CommonJS side by side without going \\\"pure-ESM\\\"\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"It can be tricky to go pure-ESM, but you can go most of the way there by using\\nboth the \\\"main\\\" and \\\"module\\\" fields in package.json\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"Compile with tsc with `tsc --module commonjs --outDir dist\"\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"Compile with tsc again with \", _jsx(_components.code, {\n          children: \"tsc --module esnext --outDir esm\"\n        })]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"Then set \\\"main\\\":\\\"dist/index.js\\\" for node and \", _jsx(_components.code, {\n          children: \"\\\"module\\\":\\\"esm/index.js\\\"\"\n        }), \" for\\nbundlers\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The \\\"module\\\" field is a field only bundlers recognizes\\n\", _jsx(_components.a, {\n        href: \"https://stackoverflow.com/questions/42708484/what-is-the-module-package-json-field-for\",\n        children: \"https://stackoverflow.com/questions/42708484/what-is-the-module-package-json-field-for\"\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Note: This is different from the \\\"type\\\":\\\"module\\\" which marks your module as\\npure-ESM!\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"I have found this technique can go a long ways towards keeping your package\\ncompatible with nodeJS and bundlers and it does not require \\\"export maps\\\" or\\nanything which I have found to be difficult to configure\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Footnote 3: Learning your tools\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Several people on the\\n\", _jsx(_components.a, {\n        href: \"https://cmdcolin.github.io/posts/2022-05-04-findseddangerous\",\n        children: \"my recent post\"\n      }), \"\\npost suggested that I did not understand my tools, and that I should just learn\\nthe tools correctly and I wouldn't have the problem I had.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Indeed, what I am now telling people to do in this post is similar: I am saying\\n\\\"just use \", _jsx(_components.code, {\n        children: \"tsc\"\n      }), \" by itself! Understand you tools! You may have to do more\\nresearch and create more boilerplate, but it's \", _jsx(_components.strong, {\n        children: \"better\"\n      }), \"\\\".\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Ultimately though, it's up to you to choose your tools and starter packs and\\nwhatnot.\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Footnote 4: What does it look like when you compile with tsc?\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"When I refer to compiling with tsc above, I compile a \", _jsx(_components.code, {\n        children: \"src\"\n      }), \" directory into a\\n\", _jsx(_components.code, {\n        children: \"dist\"\n      }), \" directory\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"So if I have:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        children: \"src/index.ts\\nsrc/util.ts\\nsrc/components/Button.ts\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Running \", _jsx(_components.code, {\n        children: \"tsc\"\n      }), \" will output:\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        children: \"dist/index.js\\ndist/index.d.ts\\ndist/index.js.map\\ndist/util.js\\ndist/util.d.ts\\ndist/util.js.map\\ndist/components/Button.js\\ndist/components/Button.d.ts\\ndist/components/Button.js.map\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Then, the \", _jsx(_components.code, {\n        children: \"dist\"\n      }), \" and \", _jsx(_components.code, {\n        children: \"src\"\n      }), \" directories are published to npm which enables the\\n\", _jsx(_components.code, {\n        children: \"sourceMaps\"\n      }), \" to work.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Note: We do not need to explicitly say where the typescript types are with\\n\\\"types\\\" in \", _jsx(_components.code, {\n        children: \"package.json\"\n      }), \", many starter packs do this but it is unneeded for\\nthis package as the d.ts files are automatically found.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"See\\n\", _jsx(_components.a, {\n        href: \"https://cmdcolin.github.io/posts/2021-12-31-npm-package\",\n        children: \"https://cmdcolin.github.io/posts/2021-12-31-npm-package\"\n      }), \"\\nfor my article on creating a typescript package for npm\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Footnote 5: Other things people recommend\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Other things people recommend in the starter pack threads\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          children: \"deno\"\n        }), \" - not clear to me how this helps when deploying to npm, but I still gotta try deno\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          children: \"ts-node \"\n        }), \" - not clear to me how this helps when deploying to npm\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          children: \"nx\"\n        }), \" - heavy monorepo-based solution\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          children: \"elm\"\n        }), \" - that's just a different thing\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          children: \"Typescript-Node-Starter\"\n        }), \" - \", _jsx(_components.a, {\n          href: \"https://github.com/microsoft/TypeScript-Node-Starter\",\n          children: \"https://github.com/microsoft/TypeScript-Node-Starter\"\n        }), \" - not a library, full stack framework\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          children: \"joystick\"\n        }), \" - \", _jsx(_components.a, {\n          href: \"https://github.com/CheatCode/joystick\",\n          children: \"https://github.com/CheatCode/joystick\"\n        }), \" - not a library, full stack framework\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Footnote 6:\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Similar things happen if you take on dependencies of starter kits like\\n\", _jsx(_components.code, {\n        children: \"create-react-app\"\n      }), \". You become very committed to their particular way of doing\\nthings, and can only modify their config with things like \", _jsx(_components.code, {\n        children: \"rescripts\"\n      }), \", \", _jsx(_components.code, {\n        children: \"craco\"\n      }), \"\\nor \", _jsx(_components.code, {\n        children: \"rewired\"\n      }), \". If you crafted your setup with just \", _jsx(_components.code, {\n        children: \"webpack\"\n      }), \", you may not be so\\ntied down. But, I still use things like \", _jsx(_components.code, {\n        children: \"create-react-app\"\n      }), \" because they do seem\\nto help me significantly. Now though, the tide seems to be turning other\\ndirections like next.js which can do static site generation at a basic level\\nand extend to multiple pages more easily.\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Footnote 7:\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"You may not even need \", _jsx(_components.code, {\n        children: \"tsc\"\n      }), \" to compile your dist folder. You can literally\\npublish your source \", _jsx(_components.code, {\n        children: \".js\"\n      }), \" files as-is to NPM. This suggestion comes from\\n@trevmanz \", _jsx(_components.a, {\n        href: \"https://twitter.com/trevmanz/status/1534962190008172545\",\n        children: \"1\"\n      }), \"\\n\", _jsx(_components.a, {\n        href: \"https://twitter.com/trevmanz/status/1534962940348092417\",\n        children: \"2\"\n      }), \". I don't\\npersonally use this technique yet but there are many users with this workflow\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"An interesting thing is you can write in \", _jsx(_components.code, {\n        children: \".js\"\n      }), \" but still get \", _jsx(_components.code, {\n        children: \"typescript\"\n      }), \" to\\nget type checking using \", _jsx(_components.code, {\n        children: \"jsdoc\"\n      }), \", just use \", _jsx(_components.code, {\n        children: \"allowJs\"\n      }), \"/\", _jsx(_components.code, {\n        children: \"checkJs\"\n      }), \" flags in\\n\", _jsx(_components.code, {\n        children: \"tsconfig.json\"\n      })]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Footnote 8:\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"What about React? Bundlers not needed, and not even babel is needed: you can\\ncode your library as in \", _jsx(_components.code, {\n        children: \"jsx\"\n      }), \" or \", _jsx(_components.code, {\n        children: \"tsx\"\n      }), \" files and use \", _jsx(_components.code, {\n        children: \"tsc\"\n      }), \" to compile it to\\nReact.createElement statements or other jsx transforms.\"]\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{}}},{"title":"Notes on performance profiling JS applications","date":"2022-05-10","slug":"2022-05-10-performanceprofiling","mdxSource":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    ul: \"ul\",\n    li: \"li\",\n    h2: \"h2\",\n    a: \"a\",\n    code: \"code\"\n  }, _provideComponents(), props.components);\n  return _jsxs(_Fragment, {\n    children: [_jsx(_components.p, {\n      children: \"Keeping your program fast is important for\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"user satisfaction in everyday apps\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"making certain things tractable\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"In our application, we visualize some large-ish datasets using the browser and\\njavascript\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"The Chrome profiler\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"I use the Chrome DevTools \\\"Performance\\\" profiler, which is a\\nstatistical/sampling profiler\\n\", _jsx(_components.a, {\n        href: \"https://en.wikipedia.org/wiki/Profiling_(computer_programming)#Statistical_profilers\",\n        children: \"https://en.wikipedia.org/wiki/Profiling_(computer_programming)#Statistical_profilers\"\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"This means it samples at some rate and see's where in the callstack the program\\nis executing.\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"If you see large rectangles in the profiler, you may have a long running\\nfunction\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"If you see many small rectangles, your small function may be called many\\ntimes\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Note: sometimes your function may be so fast, it is rarely or never encountered\\nby the sampling. It is a good thing (TM) to be this fast, but I mention it to\\nnote that the sampling profiler does not give us a complete log of all function\\ncalls.\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Creating a flamegraph from the Chrome profiler results\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Note: sometimes, it is also useful to see the results as a \\\"flamegraph\\\" (see\\n\", _jsx(_components.a, {\n        href: \"https://www.brendangregg.com/flamegraphs.html\",\n        children: \"https://www.brendangregg.com/flamegraphs.html)\"\n      }), \")\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The website \", _jsx(_components.a, {\n        href: \"https://www.speedscope.app/\",\n        children: \"https://www.speedscope.app/\"\n      }), \" can\\ncreate \\\"flamegraph\\\" style figures for Chrome profiling results\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Stacking up many small optimizations\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Working with large datasets, sometimes your program will take a long time to\\ncomplete. Especially if you work with javascript in the browser, it is a\\nchallenge to make things go fast. But you can use micro optimizations to help\\nimprove performance over time.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"For example, say a program takes 30 seconds to run on a certain dataset\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"If you do profiling and find a couple microoptimizations that give you a 15%,\\n10% and 5% performance improvement, then you program now takes 20 seconds to\\nrun. That is still not instantaneous, but it is saving users a good 10 seconds.\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Examples of micro optimizations\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [\"Using \", _jsx(_components.code, {\n          children: \"Map\"\n        }), \" instead of \", _jsx(_components.code, {\n          children: \"Object\"\n        }), \" can often get small performance boosts\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"Comparing value against \", _jsx(_components.code, {\n          children: \"undefined\"\n        }), \" e.g. \", _jsx(_components.code, {\n          children: \"if(val===undefined)\"\n        }), \" vs just\\ncomparing against falsy e.g. \", _jsx(_components.code, {\n          children: \"if(!val)\"\n        })]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"Using \", _jsx(_components.code, {\n          children: \"TypedArray\"\n        }), \"/\", _jsx(_components.code, {\n          children: \"Uint8Array\"\n        }), \" natively instead of \", _jsx(_components.code, {\n          children: \"Buffer\"\n        }), \" polyfill. This\\none is a kicker for me because we relied on \", _jsx(_components.code, {\n          children: \"Buffer\"\n        }), \" polyfill, and webpack 5\\nstopped bundling polyfills by default which made us wake up to this\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"When converting \", _jsx(_components.code, {\n          children: \"Uint8Array\"\n        }), \" to string, use \", _jsx(_components.code, {\n          children: \"TextDecoder\"\n        }), \" for large strings, and\\njust small string concatenations of \", _jsx(_components.code, {\n          children: \"String.fromCharCode\"\n        }), \" for small ones.\\nThere is an inflection point for string size where one is faster\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"Use \", _jsx(_components.code, {\n          children: \"for\"\n        }), \" loops instead of \", _jsx(_components.code, {\n          children: \"Array.prototype.forEach\"\n        }), \"/\", _jsx(_components.code, {\n          children: \"Array.prototype.map\"\n        }), \". I\\nthink similar to above, there is an inflection point (not where it gets\\nfaster in the \", _jsx(_components.code, {\n          children: \"forEach\"\n        }), \"/\", _jsx(_components.code, {\n          children: \"map\"\n        }), \" case, but where you can choose to care whether\\nthe small performance diff matters) based on number of elements in your array\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"Pre-allocate an array with \", _jsx(_components.code, {\n          children: \"new Array(N)\"\n        }), \" instead of just \", _jsx(_components.code, {\n          children: \"[]\"\n        }), \" if possible\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"I have tried to keep track of more microoptimizations here, but they are pretty\\nspecific to small examples and may not generalize across browsers or browser\\nversions \", _jsx(_components.a, {\n        href: \"https://gist.github.com/cmdcolin/ef57d2783e47b16aa07a03967fd870d8\",\n        children: \"https://gist.github.com/cmdcolin/ef57d2783e47b16aa07a03967fd870d8\"\n      })]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Examples of macro optimizations\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Oftentimes, large scale re-workings of your code or \\\"macro\\\" optimizations are\\nthe way to make progress.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"A macro optimization may be revealed if you are looking at your performance\\nprofiling result and you think: this entire section of the program could be\\nreworked to remove this overhead\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"In this case, it is hard to advise on because most of these will be very\\nspecific to your particular app.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Just as a specific example of a macro optimization I undertook:\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"We use web workers, and had to serialize a lot of data from the web worker to\\nthe main thread. I did a large re-working of the codebase to allow, in\\nparticular examples, the main thread to request smaller snippets of data from\\nthe web worker thread on-demand (the web worker is kept alive indefinitely)\\ninstead of serializing all the web worker data and sending to the main thread.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"This change especially pays off with large datasets, where all that\\nserialization/data duplication is computationally and memory expensive. Fun\\nfact: I remember sitting at a table at a conference in Jan 2020 talking with my\\nteam at the Plant and Animal Genome conference, thinking that we should make\\nthis change -- finally did it, just took 2 years. [1]\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"End-to-end optimization testing\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"In order to comprehensively measure whether micro or macro optimizations are\\nactually improving your real world performance, it can be useful to create an\\nend-to-end test\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"For our app, I created a \", _jsx(_components.code, {\n        children: \"puppeteer\"\n      }), \" based test where I loaded the website and\\nwaited for a \\\"DONE\\\" condition. I created a variety of different tests which\\nallowed me to see e.g. some optimizations may only affect certain conditions.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Developing the end-to-end test suite tool awhile to develop (read: weeks to\\nmature, though some earlier result were available), but it let me compare the\\ncurrent release vs experimental branches, and over time, the experimental\\nbranches were merged and things got faster. [2]\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Note that memory usage can be very important to your programs performance.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Excessive allocations will increase \\\"GC pressure\\\" (the garbage collector will\\ninvoke more Minor and Major GC, which you will see in your performance\\nprofiling reuslts as yellow boxes)\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Conclusion\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"It is really important to look at the profiling to see what your program\\nactually is spending time on. You can make hypothetical optimizations all day\\nand dream of rewriting in rust but you may just have a slow hot path in your JS\\ncode that, if optimized, can get big speedups.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Let me know about your favorite optimizations in the comments!\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Footnotes\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"[1] Note that things like SharedArrayBuffer also offer a means to share data\\nbetween worker and main thread, but these come with many security limitations\\nfrom the browser (and was even removed for a time while these security\\nimplications were sussed out, due to Spectre/Meltdown vulnerabilities)\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"[2] I still have not found a good way to get automated memory usage profiling\\nvia puppeteer. You can access window.process.memory in puppeteer, but this\\nvariable does not provide info about webworker memory usage\\n\", _jsx(_components.a, {\n        href: \"https://github.com/puppeteer/puppeteer/issues/8258\",\n        children: \"https://github.com/puppeteer/puppeteer/issues/8258\"\n      })]\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{}}},{"title":"Using find . -exec sed is dangerous in a git repo","date":"2022-05-04","slug":"2022-05-04-findseddangerous","mdxSource":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    a: \"a\",\n    pre: \"pre\",\n    code: \"code\",\n    h2: \"h2\"\n  }, _provideComponents(), props.components);\n  return _jsxs(_Fragment, {\n    children: [_jsx(_components.p, {\n      children: \"You want to find and replace all instances of a string in your repo, so you\\ngoogle \\\"find replace directory linux command\\\". You end up here\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.a, {\n        href: \"https://stackoverflow.com/a/6759339/2129219\",\n        children: \"https://stackoverflow.com/a/6759339/2129219\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"They tell us\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-sh\",\n        children: \"find ./ -type f -exec sed -i -e 's/apple/orange/g' {} \\\\;\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Ignoring the fact that this syntax is very long and hard to type, this command\\nis dangerous to use in a git repository. Specifically, this can corrupt your\\n.git contents.\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Why?\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"This command is dangerous because, find . will enumerate dotfiles, including\\nthe .git directory, and then of course will run the find and replace inside\\nthem. We can see this in the following session\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-sh\",\n        children: \"> mkdir corruptme\\n> cd corruptme\\n> git init\\n> echo \\\"# README\\\" > README.md\\n> git add README.md\\n> git commit -m \\\"Initial commit\\\"\\n> echo \\\"Hello world, it is a beautiful day. I sure hope someone doesn't corrupt this git repository\\\" >> README.md\\n> git commit -am \\\"Update README.md\\\"\\n> find .\\n.\\n./README.md\\n./.git\\n./.git/branches\\n./.git/config\\n./.git/COMMIT_EDITMSG\\n...more stuff...good indication the next command might be dangerous....\\n> find ./ -type f -exec sed -i -e \\\"s/README/CORRUPTME/g\\\" {} \\\\;\\n> git status\\nerror: index uses md extension, which we do not understand\\nfatal: index file corrupt\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"In this case, you may be able to recover it e.g. with\\nhttps://stackoverflow.com/questions/1115854/how-to-resolve-error-bad-index-fatal-index-file-corrupt-when-using-git\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"If you happened to replace some random text that is actually in an object file though e.g. .git/objects\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-sh\",\n        children: \"> find ./ -type f -exec sed -i -e \\\"s/VHTHJM/OOOOOO/g\\\" {} \\\\;\\n> git status\\nerror: inflate: data stream error (incorrect data check)\\nerror: corrupt loose object '26cfc5964dfa5355a1747eb6eec6250aab5212d5'\\nfatal: unable to read 26cfc5964dfa5355a1747eb6eec6250aab5212d5\\n\"\n      })\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"What is better?\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"My take: Use ruplacer \", _jsx(_components.a, {\n        href: \"https://github.com/dmerejkowsky/ruplacer\",\n        children: \"https://github.com/dmerejkowsky/ruplacer\"\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"This tool won't try to replace stuff in your .git directory. It will also skip\\nanything in .gitignore including e.g. node_modules. I was delighted to discover\\nthis tool so, just spreading the word\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Addendum: Reddit /u/Snarwin also recommended using git ls-files instead of find\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        children: \"git ls-files | xargs sed -i -e 's/apple/orange/g'\\n\"\n      })\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{}}},{"title":"Cognitive reframing","date":"2022-03-03","slug":"2022-03-02-dont-let-it-get-to-you","mdxSource":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    h2: \"h2\",\n    ul: \"ul\",\n    li: \"li\"\n  }, _provideComponents(), props.components);\n  return _jsxs(_Fragment, {\n    children: [_jsx(_components.p, {\n      children: \"A big part of my recent career has not been technical but emotional learning\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"This has been very hard, but the benefits are worth it\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"A lot of it is mental reframing\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Meetings\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"Make a mental note of things you are grateful for, can do this before a\\nmeeting to make sure you go in with a positive attitude\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Deep breathing, especially if you feel anxious\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Try not to drop bombs of negativity during a meeting, and at least consider\\nyour tone when saying things\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Don't try to complain about things that are broken too much. It is\\nmean and cruel and demoralizes everyone\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"In your off time\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"Try not to dwell on the things that are broken. You are smart. You will fix\\nthem in time. It doesn't help to put your anxiety levels so high\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Remote work anxieties/feeling appreciated\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"If someone isn't getting back to your issues, don't take it personally. Try\\nreviewing their code, or check in with them\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"If you don't feel appreciated, also try not to take it personally. Instead,\\ntry to exude positivity in your own life\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Try not to be a hero programmer https://incident.io/blog/no-capes\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"This cognitive reframing is extremely important and you can apply it to\\nmany areas of your life. You tell your own personal story, and what goes on\\nin your head makes it to the real world through your behavior.\"\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{}}},{"title":"Memoizing async functions so that you don't cache errors","date":"2022-02-26","slug":"2022-02-26-memoize-async","mdxSource":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    a: \"a\",\n    pre: \"pre\",\n    code: \"code\",\n    h2: \"h2\"\n  }, _provideComponents(), props.components);\n  return _jsxs(_Fragment, {\n    children: [_jsxs(_components.p, {\n      children: [\"There are two hard problems in computer science: \", _jsx(_components.a, {\n        href: \"https://martinfowler.com/bliki/TwoHardThings.html\",\n        children: \"Cache invalidation and naming\\nthings\"\n      }), \". In this post we'll\\nshow how memoize an async function, and how to invalidate the memoization when\\nthe promise throws an error.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"This helps us with being able to re-try because since the error is not cached,\\ncalling it again after an error retries automatically.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Example async function: fetch from the pokemon API\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-javascript\",\n        children: \"async function getPokemon() {\\n  const id = Math.floor(Math.random() * 150)\\n  const url = 'https://pokeapi.co/api/v2/pokemon/' + id\\n  const ret = await fetch(url)\\n  if (!ret.ok) {\\n    throw new Error(\\n      `Failed to fetch ${url} HTTP ${ret.status} ${ret.statusText}`,\\n    )\\n  }\\n  return ret.json()\\n}\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Here is a technique that can be used to memoize this function\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-javascript\",\n        children: \"function getPokemonMemoized() {\\n  if (!this.promise) {\\n    this.promise = getPokemon().catch(e => {\\n      this.promise = undefined\\n      throw e\\n    })\\n  }\\n  return this.promise\\n}\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The promise is held in this.promise, and the important part of this function is\\nthat when I get an error, I clear this.promise and re-throw the error. The caller\\nof the function, on error, will receive the error message, but caching will not\\ntake place, allowing retries to take place later on.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"See https://cmdcolin.github.io/pokemon.html for demo\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Footnote 0: Arguments to function\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"If your function takes arguments, then you can use a hashmap associating the\\nargument with the promise. You may also consider using an LRU cache so that\\nyour hashmap doesn't grow infinitely in size\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Generally you need a way to stringify or otherwise make them able to be stored\\nin a Map or Object to do this.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"See https://github.com/nodeca/promise-memoize for example\"\n    }), \"\\n\", _jsxs(_components.h2, {\n      children: [\"Footnote 1: Error handling of \", _jsx(_components.code, {\n        children: \"fetch\"\n      })]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"This demo also demonstrates some basic fetch error handling, and uses\\n\", _jsx(_components.code, {\n        children: \"statusText\"\n      }), \" \", _jsx(_components.a, {\n        href: \"https://developer.mozilla.org/en-US/docs/Web/API/Response/statusText\",\n        children: \"which happens to not exist in\\nHTTP/2\"\n      }), \".\\nIf you want a semblence of status message text in HTTP/2 you can try to use\\nawait ret.json() (if the API returns json error messages) or await ret.text()\\ninside the catch clause, but note that it could cause yet another error to be\\nthrown\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Footnote 2: Global cache\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"You could also keep a cache in a global variable, or as a property on a class,\\nor other methods. I have also found it useful to have a specific function for\\nclearing the cache, so you can get a clean slate each time a test runs in unit\\ntesting or similar\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-javascript\",\n        children: \"let promise\\nasync function getPokemonMemoized() {\\n  if (!promise) {\\n    promise = getPokemon().catch(e => {\\n      promise = undefined\\n      throw e\\n    })\\n  }\\n  return promise\\n}\\nfunction clearCache() {\\n  promise = undefined\\n}\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"You can also make a general purpose utility to memoize any promise function\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-javascript\",\n        children: \"function memoize(fn) {\\n  let promise\\n  return () => {\\n    if (!promise) {\\n      promise = fn().catch(e => {\\n        promise = undefined\\n        throw e\\n      })\\n    }\\n  }\\n}\\n\"\n      })\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Footnote 3 - Aborting\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"If you want to handle aborting, it is a bit trickier. Aborting in javascript is\\nhandled by\\n\", _jsx(_components.a, {\n        href: \"https://developer.mozilla.org/en-US/docs/Web/API/AbortController/AbortController\",\n        children: \"AbortController\"\n      }), \".\\nThis is an object that gives you an\\n\", _jsx(_components.a, {\n        href: \"https://developer.mozilla.org/en-US/docs/Web/API/AbortSignal\",\n        children: \"AbortSignal\"\n      }), \"\\nthat can be passed to fetch calls and the like to stop a big download from\\nhappening.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"In our above example, if we passed an abort signal to the first call to fetch,\\nand then aborted it, it would abort the fetch, \", _jsx(_components.a, {\n        href: \"https://developer.mozilla.org/en-US/docs/Web/API/AbortController/abort\",\n        children: \"which throws a DOMException\\ncalled\\n\\\"AbortError\\\"\"\n      }), \".\\nYou can detect that it is an AbortError like this, and may choose not to\\ndisplay or re-throw the abort exception\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-javascript\",\n        children: \"function isAbortException(e) {\\n  return e instanceof Error && exception.name === 'AbortError'\\n}\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Now, what if 5 functions call getPokemonMemoized(), all passing different abort\\nsignals. What if the first one aborts? Then all the rest will get aborted also.\\nBut what if we only want to abort the cached call if literally all of them\\naborted? Then we may have to synthesize an abortcontroller inside our function\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-javascript\",\n        children: \"let promise\\nlet abortcontroller\\nlet listeners = 0\\nasync function getPokemonMemoized(signal) {\\n  if (!promise) {\\n    abortcontroller = new AbortController()\\n\\n    // synthesize a new signal instead of using the passed in signal\\n    promise = getPokemon(abortcontroller.signal).catch(e => {\\n      promise = undefined\\n      throw e\\n    })\\n  }\\n  if (signal) {\\n    listeners++\\n    // add listener to the passed in signal\\n    signal.addEventListener('abort', () => {\\n      listeners--\\n      if (listeners === 0) {\\n        abortcontroller.abort()\\n      }\\n    })\\n  }\\n  return promise\\n}\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"A library my team created,\\n\", _jsx(_components.a, {\n        href: \"https://github.com/GMOD/abortable-promise-cache\",\n        children: \"abortable-promise-cache\"\n      }), \",\\ntries to help with this scenario with a cleaner abstraction.\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Footnote 4\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"I have been playing through Pokemon Yellow and find it really amusing hence the\\npokemon theme\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Fun stuff: The cutting room floor wiki with unused moves, sounds, and sprites\\nin Pokemon Yellow https://tcrf.net/Pok%C3%A9mon_Yellow\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Footnote 5\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"This blog post mentioned in a comment thread https://zansh.in/memoizer.html has\\ngreat interactive examples and shows the \\\"invalidate on .catch()\\\" behavior!\"\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{}}},{"title":"Ukraine","date":"2022-02-24","slug":"2022-02-24-ukraine","mdxSource":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\"\n  }, _provideComponents(), props.components);\n  return _jsxs(_Fragment, {\n    children: [_jsx(_components.p, {\n      children: \"As Russia is actively invading Ukraine my heart goes out to them.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Even if I had no personal connection with Ukraine, I would find this abhorrent,\\nbut I do have personal connections to Ukraine in various ways that makes me\\nthink of them more fondly\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"My first, and so far only, consulting job was with a company in Ukraine, around 2012. I helped them configure JBrowse, and prepared an official looking word\\ndocument with recommendations and hours (a total of like...2 hours) and they\\nwere very nice.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Stand strong Ukraine\"\n    }), \"\\n\", _jsx(\"img\", {\n      src: \"https://upload.wikimedia.org/wikipedia/commons/thumb/9/95/Lesser_Coat_of_Arms_of_Ukraine.svg/172px-Lesser_Coat_of_Arms_of_Ukraine.svg.png\"\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{}}}]},"__N_SSG":true}