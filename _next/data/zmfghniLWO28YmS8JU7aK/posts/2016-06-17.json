{"pageProps":{"post":{"title":"Querying InterMine databases using R","date":"2016-06-17","slug":"2016-06-17","html":"<p>In the past, I had found some ways to do simple queries on InterMine web\nservices using basic HTTP commands with R (see\n<a href=\"https://gist.github.com/cmdcolin/4758167bdd89e6c9c055\">https://gist.github.com/cmdcolin/4758167bdd89e6c9c055</a>)</p>\n<p>However, the InterMineR (<a href=\"https://github.com/intermine/intermineR\">https://github.com/intermine/intermineR</a>)\npackage automates some of these features and makes it easier to load the\ndata in R.</p>\n<h2 id=\"installation\"><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#installation\"><a href=\"#installation\" style=\"margin-right: 10px\">#</a></a>Installation</h2>\n<p>One way to install InterMineR is to install from github with\nhadley/devtools</p>\n<pre class=\"shiki\" style=\"background-color: #1b1e28\"><code><span class=\"line\"><span style=\"color: #A6ACCD\">install.packages(</span><span style=\"color: #A6ACCD\">\"</span><span style=\"color: #5DE4C7\">devtools</span><span style=\"color: #A6ACCD\">\"</span><span style=\"color: #A6ACCD\">)</span></span>\n<span class=\"line\"><span style=\"color: #A6ACCD\">devtools</span><span style=\"color: #5DE4C7\">::</span><span style=\"color: #E4F0FBD0\">install_github</span><span style=\"color: #A6ACCD\">(</span><span style=\"color: #A6ACCD\">\"</span><span style=\"color: #5DE4C7\">hadley/devtools</span><span style=\"color: #A6ACCD\">\"</span><span style=\"color: #A6ACCD\">)</span></span>\n<span class=\"line\"><span style=\"color: #A6ACCD\">devtools</span><span style=\"color: #5DE4C7\">::</span><span style=\"color: #E4F0FBD0\">install_github</span><span style=\"color: #A6ACCD\">(</span><span style=\"color: #A6ACCD\">\"</span><span style=\"color: #5DE4C7\">intermine/intermineR</span><span style=\"color: #A6ACCD\">\"</span><span style=\"color: #A6ACCD\">)</span></span></code></pre>\n<h2 id=\"usage\"><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#usage\"><a href=\"#usage\" style=\"margin-right: 10px\">#</a></a>Usage</h2>\n<p>Basic usage includes loading theÂ \"intermine URL\" using the initInterMine\nfunction. Then various functions can be called on this result.</p>\n<pre class=\"shiki\" style=\"background-color: #1b1e28\"><code><span class=\"line\"><span style=\"color: #A6ACCD\">library(</span><span style=\"color: #E4F0FB\">InterMineR</span><span style=\"color: #A6ACCD\">)</span></span>\n<span class=\"line\"><span style=\"color: #E4F0FB\">mine</span><span style=\"color: #91B4D5\">=</span><span style=\"color: #E4F0FBD0\">initInterMine</span><span style=\"color: #A6ACCD\">(</span><span style=\"color: #A6ACCD\">\"</span><span style=\"color: #5DE4C7\">http://bovinegenome.org/bovinemine/</span><span style=\"color: #A6ACCD\">\"</span><span style=\"color: #A6ACCD\">)</span></span>\n<span class=\"line\"><span style=\"color: #E4F0FBD0\">getVersion</span><span style=\"color: #A6ACCD\">(</span><span style=\"color: #E4F0FB\">mine</span><span style=\"color: #A6ACCD\">) </span><span style=\"color: #767C9DB0\">#18, intermine API version</span></span>\n<span class=\"line\"><span style=\"color: #E4F0FBD0\">getRelease</span><span style=\"color: #A6ACCD\">(</span><span style=\"color: #E4F0FB\">mine</span><span style=\"color: #A6ACCD\">) </span><span style=\"color: #767C9DB0\">#1.0, our data release version</span></span>\n<span class=\"line\"><span style=\"color: #E4F0FBD0\">getTemplates</span><span style=\"color: #A6ACCD\">(</span><span style=\"color: #E4F0FB\">mine</span><span style=\"color: #A6ACCD\">) </span><span style=\"color: #767C9DB0\"># lists all templates on interminer</span></span></code></pre>\n<h2 id=\"run-a-template-query\"><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#run-a-template-query\"><a href=\"#run-a-template-query\" style=\"margin-right: 10px\">#</a></a>Run a template query</h2>\n<p>From the getTemplates function, if you see a template query that you\nwant to run, you can use the getTemplateQuery function with it's name,\nand run it with the runQuery function</p>\n<pre class=\"shiki\" style=\"background-color: #1b1e28\"><code><span class=\"line\"><span style=\"color: #E4F0FBD0\">getTemplateQuery</span><span style=\"color: #A6ACCD\">(</span><span style=\"color: #E4F0FB\">mine</span><span style=\"color: #A6ACCD\">,</span><span style=\"color: #A6ACCD\">\"</span><span style=\"color: #5DE4C7\">TQ_protein_to_gene</span><span style=\"color: #A6ACCD\">\"</span><span style=\"color: #A6ACCD\">) </span><span style=\"color: #767C9DB0\"># see what template looks like</span></span>\n<span class=\"line\"><span style=\"color: #E4F0FB\">template</span><span style=\"color: #91B4D5\">=</span><span style=\"color: #E4F0FBD0\">getTemplateQuery</span><span style=\"color: #A6ACCD\">(</span><span style=\"color: #E4F0FB\">mine</span><span style=\"color: #A6ACCD\">,</span><span style=\"color: #A6ACCD\">\"</span><span style=\"color: #5DE4C7\">TQ_protein_to_gene</span><span style=\"color: #A6ACCD\">\"</span><span style=\"color: #A6ACCD\">) </span><span style=\"color: #767C9DB0\"># save template</span></span>\n<span class=\"line\"><span style=\"color: #E4F0FBD0\">runQuery</span><span style=\"color: #A6ACCD\">(</span><span style=\"color: #E4F0FB\">mine</span><span style=\"color: #A6ACCD\">,</span><span style=\"color: #E4F0FB\">template</span><span style=\"color: #A6ACCD\">) </span><span style=\"color: #767C9DB0\"># run the template query with default params, receive data.frame</span></span></code></pre>\n<p>This method is good, but some improvement could be added to change\ndefault parameters in the template query, etc.</p>\n<h2 id=\"run-query-xml\"><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#run-query-xml\"><a href=\"#run-query-xml\" style=\"margin-right: 10px\">#</a></a>Run query XML</h2>\n<p>Another option for running queries is to use the query XML that you can\ndownload from the InterMine query result pages.</p>\n<pre class=\"shiki\" style=\"background-color: #1b1e28\"><code><span class=\"line\"><span style=\"color: #767C9DB0\"># get all Ensembl genes on chr28 from bovinemine</span></span>\n<span class=\"line\"><span style=\"color: #E4F0FB\">query</span><span style=\"color: #91B4D5\">=</span><span style=\"color: #A6ACCD\">'</span><span style=\"color: #5DE4C7\">&#x3C;query model=\"genomic\" view=\"Gene.primaryIdentifier</span></span>\n<span class=\"line\"><span style=\"color: #5DE4C7\">Gene.secondaryIdentifier Gene.symbol Gene.name Gene.source</span></span>\n<span class=\"line\"><span style=\"color: #5DE4C7\">Gene.organism.shortName Gene.chromosome.primaryIdentifier\"</span></span>\n<span class=\"line\"><span style=\"color: #5DE4C7\">sortOrder=\"Gene.primaryIdentifier ASC\" >&#x3C;constraint</span></span>\n<span class=\"line\"><span style=\"color: #5DE4C7\">path=\"Gene.organism.shortName\" op=\"=\" value=\"B. taurus\"</span></span>\n<span class=\"line\"><span style=\"color: #5DE4C7\">/>&#x3C;constraint path=\"Gene.chromosome.primaryIdentifier\" op=\"=\"</span></span>\n<span class=\"line\"><span style=\"color: #5DE4C7\">value=\"GK000028.2\" />&#x3C;/query></span><span style=\"color: #A6ACCD\">'</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #E4F0FB\">results</span><span style=\"color: #91B4D5\">=</span><span style=\"color: #E4F0FBD0\">runQuery</span><span style=\"color: #A6ACCD\">(</span><span style=\"color: #E4F0FB\">mine</span><span style=\"color: #A6ACCD\">, </span><span style=\"color: #E4F0FB\">query</span><span style=\"color: #A6ACCD\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #A6ACCD\">head(</span><span style=\"color: #E4F0FB\">results</span><span style=\"color: #A6ACCD\">)</span></span></code></pre>\n<h2 id=\"conclusion\"><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#conclusion\"><a href=\"#conclusion\" style=\"margin-right: 10px\">#</a></a>Conclusion</h2>\n<p>The InterMineR package has a couple of nice features for getting\nInterMine data with a couple of functions for looking at templates. For\nmany use cases, copying the Query XML from a InterMine webpage and\npasting that into the runQuery function is sufficient and produces a\ndata frame that can be analyzed.</p>\n<p>PS it is not easy to post XML on tumblr after editing the post in\nmarkdown mode. You have to add the lt and gt shortcuts and even after\nthat it gets filtered?!</p>"}},"__N_SSG":true}