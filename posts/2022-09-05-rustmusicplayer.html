<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Creating a music player using Rust/GTK4 - fml9000</title><meta name="next-head-count" content="3"/><link rel="shortcut icon" href="favicon.ico"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><meta name="description" content="Blogging for the future"/><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/prism.min.js" integrity="sha512-hpZ5pDCF2bRCweL5WoA0/N1elet1KYL5mx3LP555Eg/0ZguaHawxNvEjF6O3rufAChs16HVNhEc6blF/rZoowQ==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="preload" href="/_next/static/css/50853c3f2e0364c3.css" as="style"/><link rel="stylesheet" href="/_next/static/css/50853c3f2e0364c3.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-93aa87d657ed1852.js" defer=""></script><script src="/_next/static/chunks/framework-c0d8f0fd2eea5ac1.js" defer=""></script><script src="/_next/static/chunks/main-b12cd062888056b2.js" defer=""></script><script src="/_next/static/chunks/pages/_app-d9139de5c3de3b6b.js" defer=""></script><script src="/_next/static/chunks/996-3d2a4318c0ac6f1a.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-b6f09b4db8bfc341.js" defer=""></script><script src="/_next/static/2SiwlKChu3RA5ggdxc2F4/_buildManifest.js" defer=""></script><script src="/_next/static/2SiwlKChu3RA5ggdxc2F4/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div><main><div><div style="margin-bottom:100px"><a href="/">Misc scribbles</a></div><article><div><h1>Creating a music player using Rust/GTK4 - fml9000</h1><h4>2022-09-05</h4></div><div><p>I have started endeavoring to learn Rust. I did the rustlings exercises but I
knew the concepts would fade rapidly from my brain without some practice. I
have now started making a music player using Rust+GTK4.</p>
<p>I chose GTK4 is to have a linux native GUI to scratch the itch that I've had in
lacking foobar2000 on linux. I have a particular foobar2000 setup that uses
default UI with four quadrants. I have used foobar2000 under wine and it's not
terrible, but it has background CPU consumption of about 14% idle and is just a
little "off". I have also used a variety of other GUI (quodlibet) and CLI
(cmus) apps on linux, but they didn't really feel quite right.</p>
<p>My first hurdle was getting started with GTK and Rust. I started by attempting
with Relm4, which I may return to at some point, but trying to juggle learning
Relm4-style widgets, GTK, and rust all at once was a bit much. I stepped to
using gtk4-rs directly.</p>
<p>Then, I wanted to create a data grid showing to display e.g. a table with
artist, track, album, etc. I chose to use the
<a href="https://docs.gtk.org/gtk4/class.ColumnView.html">Gtk::ColumnView</a> to drive
this. There was no example code for this so I stuggled with this (for a couple
days) before realizing that the ListView example in the gtk4-rs codebase has
similar concepts (factory to create grid cells, etc). I created a PR
(<a href="https://github.com/gtk-rs/gtk4-rs/pull/1111">https://github.com/gtk-rs/gtk4-rs/pull/1111</a>) to demonstrate simple ColumnView
usage.</p>
<p>After this hurdle was crossed, I felt much more comfortable in the GTK mindset.
I would just search for various components and they often already existed which
was great. There was even one called Gtk::MediaFile which should to be able to
play e.g. mp3s, making my job of making a media player much simpler, but it
produced an error <a href="https://www.google.com/search?q=%22GTK+could+not+find+a+media+module.+Check+your+installation.%22&#x26;oq=%22GTK+could+not+find+a+media+module.+Check+your+installation.%22&#x26;aqs=chrome..69i57.267j0j7&#x26;sourceid=chrome&#x26;ie=UTF-8">"GTK could not find a media module. Check your
installation."</a>
which had very few references on the internet. So, I am trying out symphonia
(<a href="https://github.com/pdeljanov/Symphonia/">https://github.com/pdeljanov/Symphonia/</a>), with the hope being that it is
easier to package these for consumers of the app.</p>
<p>The current work is at <a href="https://github.com/cmdcolin/fml9000">https://github.com/cmdcolin/fml9000</a></p>
<p><img src="/media/fml9000_1.png" alt=""></p>
<p>Some stuff in the screenshot is mocked and not fully functional, but it has
been a great adventure</p></div><div style="margin-top:200px"></div></article></div></main></div><footer style="margin-top:100px"><a href="/">Home</a> <a href="/archive">Blog archive</a> <a href="https://github.com/cmdcolin/">Github</a> <a href="https://twitter.com/cmdcolin">Twitter</a> <a href="/projects">Projects</a> <a href="/photos">Photos</a> <a href="/rss.xml">RSS</a><a href="/about">About</a> </footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Creating a music player using Rust/GTK4 - fml9000","date":"2022-09-05","slug":"2022-09-05-rustmusicplayer","html":"\u003cp\u003eI have started endeavoring to learn Rust. I did the rustlings exercises but I\nknew the concepts would fade rapidly from my brain without some practice. I\nhave now started making a music player using Rust+GTK4.\u003c/p\u003e\n\u003cp\u003eI chose GTK4 is to have a linux native GUI to scratch the itch that I've had in\nlacking foobar2000 on linux. I have a particular foobar2000 setup that uses\ndefault UI with four quadrants. I have used foobar2000 under wine and it's not\nterrible, but it has background CPU consumption of about 14% idle and is just a\nlittle \"off\". I have also used a variety of other GUI (quodlibet) and CLI\n(cmus) apps on linux, but they didn't really feel quite right.\u003c/p\u003e\n\u003cp\u003eMy first hurdle was getting started with GTK and Rust. I started by attempting\nwith Relm4, which I may return to at some point, but trying to juggle learning\nRelm4-style widgets, GTK, and rust all at once was a bit much. I stepped to\nusing gtk4-rs directly.\u003c/p\u003e\n\u003cp\u003eThen, I wanted to create a data grid showing to display e.g. a table with\nartist, track, album, etc. I chose to use the\n\u003ca href=\"https://docs.gtk.org/gtk4/class.ColumnView.html\"\u003eGtk::ColumnView\u003c/a\u003e to drive\nthis. There was no example code for this so I stuggled with this (for a couple\ndays) before realizing that the ListView example in the gtk4-rs codebase has\nsimilar concepts (factory to create grid cells, etc). I created a PR\n(\u003ca href=\"https://github.com/gtk-rs/gtk4-rs/pull/1111\"\u003ehttps://github.com/gtk-rs/gtk4-rs/pull/1111\u003c/a\u003e) to demonstrate simple ColumnView\nusage.\u003c/p\u003e\n\u003cp\u003eAfter this hurdle was crossed, I felt much more comfortable in the GTK mindset.\nI would just search for various components and they often already existed which\nwas great. There was even one called Gtk::MediaFile which should to be able to\nplay e.g. mp3s, making my job of making a media player much simpler, but it\nproduced an error \u003ca href=\"https://www.google.com/search?q=%22GTK+could+not+find+a+media+module.+Check+your+installation.%22\u0026#x26;oq=%22GTK+could+not+find+a+media+module.+Check+your+installation.%22\u0026#x26;aqs=chrome..69i57.267j0j7\u0026#x26;sourceid=chrome\u0026#x26;ie=UTF-8\"\u003e\"GTK could not find a media module. Check your\ninstallation.\"\u003c/a\u003e\nwhich had very few references on the internet. So, I am trying out symphonia\n(\u003ca href=\"https://github.com/pdeljanov/Symphonia/\"\u003ehttps://github.com/pdeljanov/Symphonia/\u003c/a\u003e), with the hope being that it is\neasier to package these for consumers of the app.\u003c/p\u003e\n\u003cp\u003eThe current work is at \u003ca href=\"https://github.com/cmdcolin/fml9000\"\u003ehttps://github.com/cmdcolin/fml9000\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/media/fml9000_1.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eSome stuff in the screenshot is mocked and not fully functional, but it has\nbeen a great adventure\u003c/p\u003e"}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"2022-09-05-rustmusicplayer"},"buildId":"2SiwlKChu3RA5ggdxc2F4","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>