<!DOCTYPE html><html lang="en"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Weekend project - graphing tumblr reblogs using cytoscape.js</title><meta name="next-head-count" content="3"/><link rel="shortcut icon" href="favicon.ico"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><meta name="description" content="Blogging for the future"/><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/prism.min.js" integrity="sha512-hpZ5pDCF2bRCweL5WoA0/N1elet1KYL5mx3LP555Eg/0ZguaHawxNvEjF6O3rufAChs16HVNhEc6blF/rZoowQ==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="preload" href="/_next/static/css/9d066bf523979bbf.css" as="style"/><link rel="stylesheet" href="/_next/static/css/9d066bf523979bbf.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-4c70eeb4cef5b69f.js" defer=""></script><script src="/_next/static/chunks/framework-c0d8f0fd2eea5ac1.js" defer=""></script><script src="/_next/static/chunks/main-33a474ca00e371b8.js" defer=""></script><script src="/_next/static/chunks/pages/_app-13ca9a07b898f6f6.js" defer=""></script><script src="/_next/static/chunks/996-9c91d1eae613ddeb.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-a9b8dd170d83e486.js" defer=""></script><script src="/_next/static/v2Z5IzW65dT5vJR8Nk1V7/_buildManifest.js" defer=""></script><script src="/_next/static/v2Z5IzW65dT5vJR8Nk1V7/_ssgManifest.js" defer=""></script><script src="/_next/static/v2Z5IzW65dT5vJR8Nk1V7/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><div><main><div><div style="margin-bottom:100px"><a href="/">Misc scribbles</a></div><article><div><h1>Weekend project - graphing tumblr reblogs using cytoscape.js</h1><h4>2015-08-30</h4></div><p>In the past, I made an app that used RStudio&#x27;s Shiny platform to plot
network graphs with RGraphviz. This worked, and gave some nice results,
but when I found out about cytoscape.js, I really wanted to try that
out.</p>
<p>The app is designed to plot tumblr reblogs, so it has a tree structure,
but simply plotting things as a tree is not very space efficient (as in,
the visualization takes up too much space). Therefore, using different
types of layouts can really help.</p>
<p>In my first app with graphviz
https://colindiesh.shinyapps.io/tumblrgraph, there are several
built-in graph layouts including &quot;neato&quot; &quot;twopi&quot;, &quot;circo&quot;, and &quot;dot&quot;</p>
<p>I made all of these available for users to try in the Shiny app. The
names of the layouts don&#x27;t lend much to their behavior, but they are
built-in functions in Graphviz. There are both &quot;tree&quot; and
&quot;force-directed&quot; style graph views. As I mentioned, the &quot;tree&quot; style
view make a lot of sense for the tumblr reblogs, but the force directed
graphs are also a lot more compact, so offering both styles is useful.</p>
<p><img src="../../media/128000908903_0.png" alt=""/></p>
<p>Figure 1. My default example graph from graphviz using the twopi layout.</p>
<p>I wanted to replicate all the features that I had in the Graphviz app in
Cytoscape.js. Here is the breakdown of the basic components that needed
replicating:</p>
<ol>
<li>
<p>Build the &quot;graph&quot; representation of reblogs in memory</p>
</li>
<li>
<p>Add user forms and configurability</p>
</li>
<li>
<p>Add color for distance from root using a breadth first search</p>
</li>
<li>
<p>Draw the graph</p>
</li>
</ol>
<p>As I went along, I was happy to learn that the concepts mapped very
easily to javascript and cytoscape.js. The implementations are a little
different, but it worked out very nicely.</p>
<p><img src="../../media/128000908903_1.png" alt=""/></p>
<p>Figure 2. Same data plotted in Cytoscape.js with the springy layout.</p>
<p>In the new app, we enabled several different layouts similar to the
Graphviz app too. In cytoscape.js, the layouts that are offered
include &quot;arbor&quot;, &quot;springy&quot;, &quot;cola&quot;, &quot;cose&quot;, and &quot;dagre&quot;. I like &quot;cola&quot;
because it really looks like bubbles moving around in a soda. Others are
worth experimenting with too.</p>
<p><img src="../../media/128000908903_2.png" alt=""/></p>
<p>Figure 3. A Cytoscape.js springy layout for a larger tumblr reblog graph</p>
<p>The new cytoscape.js app also has a nice animation feature. The old
graphviz app offered animation too (using Yihui&#x27;s animation library for
R) but the new version can automatically encode HTML5 video on the
client side from individual picture frames in the browser using
<a href="https://github.com/antimatter15/whammy">&quot;Whammy&quot;</a>! This quite
impressive!</p>
<p>So to animate the graph, what is done is</p>
<ol>
<li>
<p>Add nodes/edges and layout the graph (the simulation time is
configurable, because allowing the user to interact with the graph while
the simulation is running is useful)</p>
</li>
<li>
<p>Once layout is complete, the user can save the graph as an
animation, which first hides all nodes by adding visibility: hidden to
the CSS.</p>
</li>
<li>
<p>Then the nodes are re-shown one-by-one, preserving the layout, and a
frame is saved by the renderer at each step (takes a snapshot of the
canvas).</p>
</li>
</ol>
<p>This strategy for the animation is actually better than the original
graphviz version that I had because the layout is only done once, which
is time saving and it is also more consistent (the layout changes a lot
if you re run it on different sets of nodes).</p>
<p>Check out the app here http://cmdcolin.github.io/tumblrgraph2/</p>
<p>Future goals:</p>
<ul>
<li>Test out super large graphs (I have tested up to about 500 reblogs
but after this, around 1000 reblogs, it slows down a lot and produces
bad layouts. Needs fixing)</li>
<li>Test out ability to place importance on certain nodes by increasing
node size based on it&#x27;s degree</li>
</ul>
<p>Check out an example of the HTML5 video here</p><div style="margin-top:200px"></div></article></div></main></div><footer style="margin-top:100px"><a href="/">Home</a> <a href="/archive">Blog archive</a> <a href="https://github.com/cmdcolin/">Github</a> <a href="https://twitter.com/cmdcolin">Twitter</a> <a href="/projects">Projects</a> <a href="/photos">Photos</a> <a href="/rss.xml">RSS</a><a href="/about">About</a> </footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Weekend project - graphing tumblr reblogs using cytoscape.js","date":"2015-08-30","slug":"2015-08-30","mdxSource":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, {})\n  })) : _createMdxContent();\n  function _createMdxContent() {\n    const _components = Object.assign({\n      p: \"p\",\n      img: \"img\",\n      ol: \"ol\",\n      li: \"li\",\n      a: \"a\",\n      ul: \"ul\"\n    }, _provideComponents(), props.components);\n    return _jsxs(_Fragment, {\n      children: [_jsx(_components.p, {\n        children: \"In the past, I made an app that used RStudio's Shiny platform to plot\\nnetwork graphs with RGraphviz. This worked, and gave some nice results,\\nbut when I found out about cytoscape.js, I really wanted to try that\\nout.\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"The app is designed to plot tumblr reblogs, so it has a tree structure,\\nbut simply plotting things as a tree is not very space efficient (as in,\\nthe visualization takes up too much space). Therefore, using different\\ntypes of layouts can really help.\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"In my first app with graphviz\\nhttps://colindiesh.shinyapps.io/tumblrgraph, there are several\\nbuilt-in graph layouts including \\\"neato\\\" \\\"twopi\\\", \\\"circo\\\", and \\\"dot\\\"\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"I made all of these available for users to try in the Shiny app. The\\nnames of the layouts don't lend much to their behavior, but they are\\nbuilt-in functions in Graphviz. There are both \\\"tree\\\" and\\n\\\"force-directed\\\" style graph views. As I mentioned, the \\\"tree\\\" style\\nview make a lot of sense for the tumblr reblogs, but the force directed\\ngraphs are also a lot more compact, so offering both styles is useful.\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: _jsx(_components.img, {\n          src: \"../../media/128000908903_0.png\",\n          alt: \"\"\n        })\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"Figure 1. My default example graph from graphviz using the twopi layout.\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"I wanted to replicate all the features that I had in the Graphviz app in\\nCytoscape.js. Here is the breakdown of the basic components that needed\\nreplicating:\"\n      }), \"\\n\", _jsxs(_components.ol, {\n        children: [\"\\n\", _jsxs(_components.li, {\n          children: [\"\\n\", _jsx(_components.p, {\n            children: \"Build the \\\"graph\\\" representation of reblogs in memory\"\n          }), \"\\n\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [\"\\n\", _jsx(_components.p, {\n            children: \"Add user forms and configurability\"\n          }), \"\\n\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [\"\\n\", _jsx(_components.p, {\n            children: \"Add color for distance from root using a breadth first search\"\n          }), \"\\n\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [\"\\n\", _jsx(_components.p, {\n            children: \"Draw the graph\"\n          }), \"\\n\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"As I went along, I was happy to learn that the concepts mapped very\\neasily to javascript and cytoscape.js. The implementations are a little\\ndifferent, but it worked out very nicely.\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: _jsx(_components.img, {\n          src: \"../../media/128000908903_1.png\",\n          alt: \"\"\n        })\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"Figure 2. Same data plotted in Cytoscape.js with the springy layout.\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"In the new app, we enabled several different layouts similar to the\\nGraphviz app too. In cytoscape.js, the layouts that are offered\\ninclude \\\"arbor\\\", \\\"springy\\\", \\\"cola\\\", \\\"cose\\\", and \\\"dagre\\\". I like \\\"cola\\\"\\nbecause it really looks like bubbles moving around in a soda. Others are\\nworth experimenting with too.\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: _jsx(_components.img, {\n          src: \"../../media/128000908903_2.png\",\n          alt: \"\"\n        })\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"Figure 3. A Cytoscape.js springy layout for a larger tumblr reblog graph\"\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"The new cytoscape.js app also has a nice animation feature. The old\\ngraphviz app offered animation too (using Yihui's animation library for\\nR) but the new version can automatically encode HTML5 video on the\\nclient side from individual picture frames in the browser using\\n\", _jsx(_components.a, {\n          href: \"https://github.com/antimatter15/whammy\",\n          children: \"\\\"Whammy\\\"\"\n        }), \"! This quite\\nimpressive!\"]\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"So to animate the graph, what is done is\"\n      }), \"\\n\", _jsxs(_components.ol, {\n        children: [\"\\n\", _jsxs(_components.li, {\n          children: [\"\\n\", _jsx(_components.p, {\n            children: \"Add nodes/edges and layout the graph (the simulation time is\\nconfigurable, because allowing the user to interact with the graph while\\nthe simulation is running is useful)\"\n          }), \"\\n\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [\"\\n\", _jsx(_components.p, {\n            children: \"Once layout is complete, the user can save the graph as an\\nanimation, which first hides all nodes by adding visibility: hidden to\\nthe CSS.\"\n          }), \"\\n\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [\"\\n\", _jsx(_components.p, {\n            children: \"Then the nodes are re-shown one-by-one, preserving the layout, and a\\nframe is saved by the renderer at each step (takes a snapshot of the\\ncanvas).\"\n          }), \"\\n\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"This strategy for the animation is actually better than the original\\ngraphviz version that I had because the layout is only done once, which\\nis time saving and it is also more consistent (the layout changes a lot\\nif you re run it on different sets of nodes).\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"Check out the app here http://cmdcolin.github.io/tumblrgraph2/\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"Future goals:\"\n      }), \"\\n\", _jsxs(_components.ul, {\n        children: [\"\\n\", _jsx(_components.li, {\n          children: \"Test out super large graphs (I have tested up to about 500 reblogs\\nbut after this, around 1000 reblogs, it slows down a lot and produces\\nbad layouts. Needs fixing)\"\n        }), \"\\n\", _jsx(_components.li, {\n          children: \"Test out ability to place importance on certain nodes by increasing\\nnode size based on it's degree\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"Check out an example of the HTML5 video here\"\n      })]\n    });\n  }\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{}}}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"2015-08-30"},"buildId":"v2Z5IzW65dT5vJR8Nk1V7","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>