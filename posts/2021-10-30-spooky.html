<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><link rel="stylesheet" href="/_next/static/css/97dc5fe527f5d592.css" data-precedence="next"/><title>A spooky error when you have a string bigger than 512MB in Chrome</title><meta name="description" content="A blog"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="any"/><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" noModule=""></script></head><body><div style="margin-bottom:100px"><a href="/">Misc scribbles</a></div><article><div><h1>A spooky error when you have a string bigger than 512MB in Chrome</h1><h4>2021-10-30</h4></div><div><p>Now gather round for a spooky story</p>
<p>Late one night... in the haunted office/castle the midnight candles were burning
bright and we entered data for a user file....</p>
<p>(hindenbugs cackling in the background, dusty technical books line the dark
shelves)</p>
<p>A simple 52MB gzipped datafile that we want to process in the browser. We unzip
it, decode it, and ... we see an error!!! <strong>LIGHTNING CRACKS</strong></p>
<p><img src="/media/pumpkin-dark.jpg" alt=""></p>
<p>But... our code is so simple (we of course abide by the religion of writing
"simple code" you know)...what could be happening?</p>
<p>The code looks like this</p>
<pre class="shiki poimandres" style="background-color: #1b1e28" tabindex="0"><code><span class="line"><span style="color: #91B4D5">const</span><span style="color: #A6ACCD"> </span><span style="color: #E4F0FB">buf</span><span style="color: #A6ACCD"> </span><span style="color: #91B4D5">=</span><span style="color: #A6ACCD"> </span><span style="color: #E4F0FBD0">unzip</span><span style="color: #A6ACCD">(</span><span style="color: #E4F0FB">file</span><span style="color: #A6ACCD">)</span></span>
<span class="line"><span style="color: #91B4D5">const</span><span style="color: #A6ACCD"> </span><span style="color: #E4F0FB">str</span><span style="color: #A6ACCD"> </span><span style="color: #91B4D5">=</span><span style="color: #A6ACCD"> </span><span style="color: #5DE4C7">new</span><span style="color: #A6ACCD"> </span><span style="color: #E4F0FBD0">TextDecoder</span><span style="color: #A6ACCD">().</span><span style="color: #E4F0FBD0">decode</span><span style="color: #A6ACCD">(</span><span style="color: #E4F0FB">buf</span><span style="color: #A6ACCD">)</span></span></code></pre>
<p>We trace it back and run a <code>console.log(str)</code></p>
<p>It looks empty. We try running <code>console.log(str.length)</code> ... it prints out 0</p>
<p>But if we look at <code>console.log(buffer.length)</code> we get 546,483,710 bytes...</p>
<p>What could be happening?</p>
<p>We see in the <code>TextDecoder</code> documentation that it has a note called "fatal". We
try</p>
<pre class="shiki poimandres" style="background-color: #1b1e28" tabindex="0"><code><span class="line"><span style="color: #91B4D5">const</span><span style="color: #A6ACCD"> </span><span style="color: #E4F0FB">buf</span><span style="color: #A6ACCD"> </span><span style="color: #91B4D5">=</span><span style="color: #A6ACCD"> </span><span style="color: #E4F0FBD0">unzip</span><span style="color: #A6ACCD">(</span><span style="color: #E4F0FB">file</span><span style="color: #A6ACCD">)</span></span>
<span class="line"><span style="color: #91B4D5">const</span><span style="color: #A6ACCD"> </span><span style="color: #E4F0FB">str</span><span style="color: #A6ACCD"> </span><span style="color: #91B4D5">=</span><span style="color: #A6ACCD"> </span><span style="color: #5DE4C7">new</span><span style="color: #A6ACCD"> </span><span style="color: #E4F0FBD0">TextDecoder</span><span style="color: #A6ACCD">(</span><span style="color: #A6ACCD">'</span><span style="color: #5DE4C7">utf8</span><span style="color: #A6ACCD">'</span><span style="color: #A6ACCD">, {</span><span style="color: #E4F0FB"> </span><span style="color: #ADD7FF">fatal</span><span style="color: #A6ACCD">:</span><span style="color: #ADD7FF"> </span><span style="color: #5DE4C7">true</span><span style="color: #ADD7FF"> </span><span style="color: #A6ACCD">}).</span><span style="color: #E4F0FBD0">decode</span><span style="color: #A6ACCD">(</span><span style="color: #E4F0FB">buf</span><span style="color: #A6ACCD">)</span></span></code></pre>
<p>This doesn't change the results though</p>
<p>Then it dawns on us while the lightning hits and the thunderclap booms and the
wind blows through the rattly windows</p>
<p>We have hit...the maximum string length in Chrome</p>
<p>BWAHAHAHAHA</p>
<p>The maximum string length!!! Nooooooo</p>
<p>It is 512MB on the dot... 536,870,888 bytes. We test this to be sure</p>
<pre class="shiki poimandres" style="background-color: #1b1e28" tabindex="0"><code><span class="line"><span style="color: #91B4D5">const</span><span style="color: #A6ACCD"> </span><span style="color: #E4F0FB">len</span><span style="color: #A6ACCD"> </span><span style="color: #91B4D5">=</span><span style="color: #A6ACCD"> </span><span style="color: #5DE4C7">536_870_888</span></span>
<span class="line"><span style="color: #91B4D5">const</span><span style="color: #A6ACCD"> </span><span style="color: #E4F0FB">buf</span><span style="color: #A6ACCD"> </span><span style="color: #91B4D5">=</span><span style="color: #A6ACCD"> </span><span style="color: #5DE4C7">new</span><span style="color: #A6ACCD"> </span><span style="color: #E4F0FBD0">Uint8Array</span><span style="color: #A6ACCD">(</span><span style="color: #E4F0FB">len</span><span style="color: #A6ACCD">)</span></span>
<span class="line"><span style="color: #A6ACCD">for (</span><span style="color: #91B4D5">let</span><span style="color: #A6ACCD"> </span><span style="color: #E4F0FB">i</span><span style="color: #A6ACCD"> </span><span style="color: #91B4D5">=</span><span style="color: #A6ACCD"> </span><span style="color: #5DE4C7">0</span><span style="color: #A6ACCD">; </span><span style="color: #E4F0FB">i</span><span style="color: #A6ACCD"> </span><span style="color: #91B4D5">&#x3C;</span><span style="color: #A6ACCD"> </span><span style="color: #E4F0FB">len</span><span style="color: #A6ACCD">; </span><span style="color: #E4F0FB">i</span><span style="color: #91B4D5">++</span><span style="color: #A6ACCD">) {</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #E4F0FB">buf</span><span style="color: #A6ACCD">[</span><span style="color: #E4F0FB">i</span><span style="color: #A6ACCD">] </span><span style="color: #91B4D5">=</span><span style="color: #A6ACCD"> </span><span style="color: #A6ACCD">'</span><span style="color: #5DE4C7">a</span><span style="color: #A6ACCD">'</span><span style="color: #A6ACCD">.</span><span style="color: #E4F0FBD0">charCodeAt</span><span style="color: #A6ACCD">(</span><span style="color: #5DE4C7">0</span><span style="color: #A6ACCD">)</span></span>
<span class="line"><span style="color: #A6ACCD">}</span></span>
<span class="line"><span style="color: #91B4D5">const</span><span style="color: #A6ACCD"> </span><span style="color: #E4F0FB">str</span><span style="color: #A6ACCD"> </span><span style="color: #91B4D5">=</span><span style="color: #A6ACCD"> </span><span style="color: #5DE4C7">new</span><span style="color: #A6ACCD"> </span><span style="color: #E4F0FBD0">TextDecoder</span><span style="color: #A6ACCD">().</span><span style="color: #E4F0FBD0">decode</span><span style="color: #A6ACCD">(</span><span style="color: #E4F0FB">buf</span><span style="color: #A6ACCD">)</span></span>
<span class="line"><span style="color: #E4F0FB">console</span><span style="color: #A6ACCD">.</span><span style="color: #E4F0FBD0">log</span><span style="color: #A6ACCD">(</span><span style="color: #E4F0FB">str</span><span style="color: #A6ACCD">.</span><span style="color: #E4F0FB">length</span><span style="color: #A6ACCD">)</span></span></code></pre>
<p>This is correct, outputs 536,870,888</p>
<p>With anything, even one byte more, it fails and outputs 0</p>
<p>happy halloween!!</p>
<p>pumpkin photo source:
<a href="http://mountainbikerak.blogspot.com/2010/11/google-chrome-pumpkin.html">http://mountainbikerak.blogspot.com/2010/11/google-chrome-pumpkin.html</a></p>
<ul>
<li>
<p>chrome 95 tested</p>
</li>
<li>
<p>nodejs 15 - at 512MB+1 bytes it prints an error message
<code>Error: Cannot create a string longer than 0x1fffffe8 characters</code> for
significantly greater than 512MB e.g. 600MB it actually prints a different
error
<code>TypeError [ERR_ENCODING_INVALID_ENCODED_DATA]: The encoded data was not valid for encoding utf-8</code>)</p>
</li>
<li>
<p>firefox 93 - goes up to ~1GB but then gives Exception
<code>{ name: "NS_ERROR_OUT_OF_MEMORY", message: "", result: 2147942414 }</code></p>
</li>
<li>
<p>midori 6 (safari-alike/webkit) - goes up to ~2GB fine! will have to test more</p>
</li>
</ul></div><div style="margin-top:200px"></div></article><footer style="margin-top:100px"><a href="/">Home</a> <a href="/archive">Blog archive</a> <a href="https://github.com/cmdcolin/">Github</a> <a href="https://twitter.com/cmdcolin">Twitter</a> <a href="/projects">Projects</a> <a href="/photos">Photos</a> <a href="/about">About</a></footer><script src="/_next/static/chunks/webpack-3224743bbfce757e.js" async=""></script><script src="/_next/static/chunks/2443530c-b193ff79fd6a1567.js" async=""></script><script src="/_next/static/chunks/139-a55d005ec0ce8e4f.js" async=""></script><script src="/_next/static/chunks/main-app-a6dbbaaf1ec67e34.js" async=""></script></body></html><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/97dc5fe527f5d592.css\",{\"as\":\"style\"}]\n0:\"$L2\"\n"])</script><script>self.__next_f.push([1,"3:I{\"id\":\"7858\",\"chunks\":[\"272:static/chunks/webpack-3224743bbfce757e.js\",\"667:static/chunks/2443530c-b193ff79fd6a1567.js\",\"139:static/chunks/139-a55d005ec0ce8e4f.js\"],\"name\":\"\",\"async\":false}\n5:I{\"id\":\"3055\",\"chunks\":[\"272:static/chunks/webpack-3224743bbfce757e.js\",\"667:static/chunks/2443530c-b193ff79fd6a1567.js\",\"139:static/chunks/139-a55d005ec0ce8e4f.js\"],\"name\":\"\",\"async\":false}\n6:I{\"id\":\"414\",\"chunks\":[\"414:static/chunks/414-6d6e10881f5d1a2e.js\",\"467:static/chunks/app/archive/page-b9afc96c23d1c7f9.js\"]"])</script><script>self.__next_f.push([1,",\"name\":\"\",\"async\":false}\n7:I{\"id\":\"9544\",\"chunks\":[\"272:static/chunks/webpack-3224743bbfce757e.js\",\"667:static/chunks/2443530c-b193ff79fd6a1567.js\",\"139:static/chunks/139-a55d005ec0ce8e4f.js\"],\"name\":\"\",\"async\":false}\n8:I{\"id\":\"99\",\"chunks\":[\"272:static/chunks/webpack-3224743bbfce757e.js\",\"667:static/chunks/2443530c-b193ff79fd6a1567.js\",\"139:static/chunks/139-a55d005ec0ce8e4f.js\"],\"name\":\"\",\"async\":false}\n"])</script><script>self.__next_f.push([1,"2:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/97dc5fe527f5d592.css\",\"precedence\":\"next\"}]],[\"$\",\"$L3\",null,{\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/posts/2021-10-30-spooky\",\"initialTree\":[\"\",{\"children\":[\"posts\",{\"children\":[[\"id\",\"2021-10-30-spooky\",\"d\"],{\"children\":[\"__PAGE__?{\\\"id\\\":\\\"2021-10-30-spooky\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialHead\":[\"$L4\",null],\"globalErrorComponent\":\"$5\",\"notFound\":[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"children\":[[\"$\",\"div\",null,{\"style\":{\"marginBottom\":100},\"children\":[\"$\",\"$L6\",null,{\"href\":\"/\",\"children\":\"Misc scribbles\"}]}],[\"$undefined\",[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]]],[\"$\",\"footer\",null,{\"style\":{\"marginTop\":100},\"children\":[[\"$\",\"$L6\",null,{\"href\":\"/\",\"children\":\"Home\"}],\" \",[\"$\",\"$L6\",null,{\"href\":\"/archive\",\"children\":\"Blog archive\"}],\" \",[\"$\",\"$L6\",null,{\"href\":\"https://github.com/cmdcolin/\",\"children\":\"Github\"}],\" \",[\"$\",\"$L6\",null,{\"href\":\"https://twitter.com/cmdcolin\",\"children\":\"Twitter\"}],\" \",[\"$\",\"$L6\",null,{\"href\":\"/projects\",\"children\":\"Projects\"}],\" \",[\"$\",\"$L6\",null,{\"href\":\"/photos\",\"children\":\"Photos\"}],\" \",[\"$\",\"$L6\",null,{\"href\":\"/about\",\"children\":\"About\"}]]}]]}]}],\"asNotFound\":false,\"children\":[[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"children\":[[\"$\",\"div\",null,{\"style\":{\"marginBottom\":100},\"children\":[\"$\",\"$L6\",null,{\"href\":\"/\",\"children\":\"Misc scribbles\"}]}],[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"asNotFound\":false,\"childProp\":{\"current\":[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"asNotFound\":false,\"childProp\":{\"current\":[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\",[\"id\",\"2021-10-30-spooky\",\"d\"],\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"asNotFound\":false,\"childProp\":{\"current\":[\"$L9\",null],\"segment\":\"__PAGE__?{\\\"id\\\":\\\"2021-10-30-spooky\\\"}\"},\"styles\":[]}],\"segment\":[\"id\",\"2021-10-30-spooky\",\"d\"]},\"styles\":[]}],\"segment\":\"posts\"},\"styles\":[]}],[\"$\",\"footer\",null,{\"style\":{\"marginTop\":100},\"children\":[[\"$\",\"$L6\",null,{\"href\":\"/\",\"children\":\"Home\"}],\" \",[\"$\",\"$L6\",null,{\"href\":\"/archive\",\"children\":\"Blog archive\"}],\" \",[\"$\",\"$L6\",null,{\"href\":\"https://github.com/cmdcolin/\",\"children\":\"Github\"}],\" \",[\"$\",\"$L6\",null,{\"href\":\"https://twitter.com/cmdcolin\",\"children\":\"Twitter\"}],\" \",[\"$\",\"$L6\",null,{\"href\":\"/projects\",\"children\":\"Projects\"}],\" \",[\"$\",\"$L6\",null,{\"href\":\"/photos\",\"children\":\"Photos\"}],\" \",[\"$\",\"$L6\",null,{\"href\":\"/about\",\"children\":\"About\"}]]}]]}]}],null]}]]\n"])</script><script>self.__next_f.push([1,"a:I{\"id\":\"6677\",\"chunks\":[\"722:static/chunks/app/posts/[id]/page-29425205b46f5335.js\"],\"name\":\"\",\"async\":false}\n"])</script><script>self.__next_f.push([1,"9:[\"$\",\"article\",null,{\"children\":[[\"$\",\"div\",null,{\"children\":[[\"$\",\"h1\",null,{\"children\":\"A spooky error when you have a string bigger than 512MB in Chrome\"}],[\"$\",\"h4\",null,{\"children\":\"2021-10-30\"}]]}],[\"$\",\"div\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cp\u003eNow gather round for a spooky story\u003c/p\u003e\\n\u003cp\u003eLate one night... in the haunted office/castle the midnight candles were burning\\nbright and we entered data for a user file....\u003c/p\u003e\\n\u003cp\u003e(hindenbugs cackling in the background, dusty technical books line the dark\\nshelves)\u003c/p\u003e\\n\u003cp\u003eA simple 52MB gzipped datafile that we want to process in the browser. We unzip\\nit, decode it, and ... we see an error!!! \u003cstrong\u003eLIGHTNING CRACKS\u003c/strong\u003e\u003c/p\u003e\\n\u003cp\u003e\u003cimg src=\\\"/media/pumpkin-dark.jpg\\\" alt=\\\"\\\"\u003e\u003c/p\u003e\\n\u003cp\u003eBut... our code is so simple (we of course abide by the religion of writing\\n\\\"simple code\\\" you know)...what could be happening?\u003c/p\u003e\\n\u003cp\u003eThe code looks like this\u003c/p\u003e\\n\u003cpre class=\\\"shiki poimandres\\\" style=\\\"background-color: #1b1e28\\\" tabindex=\\\"0\\\"\u003e\u003ccode\u003e\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #91B4D5\\\"\u003econst\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #E4F0FB\\\"\u003ebuf\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #91B4D5\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #E4F0FBD0\\\"\u003eunzip\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color: #E4F0FB\\\"\u003efile\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e)\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #91B4D5\\\"\u003econst\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #E4F0FB\\\"\u003estr\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #91B4D5\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #5DE4C7\\\"\u003enew\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #E4F0FBD0\\\"\u003eTextDecoder\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e().\u003c/span\u003e\u003cspan style=\\\"color: #E4F0FBD0\\\"\u003edecode\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color: #E4F0FB\\\"\u003ebuf\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\\n\u003cp\u003eWe trace it back and run a \u003ccode\u003econsole.log(str)\u003c/code\u003e\u003c/p\u003e\\n\u003cp\u003eIt looks empty. We try running \u003ccode\u003econsole.log(str.length)\u003c/code\u003e ... it prints out 0\u003c/p\u003e\\n\u003cp\u003eBut if we look at \u003ccode\u003econsole.log(buffer.length)\u003c/code\u003e we get 546,483,710 bytes...\u003c/p\u003e\\n\u003cp\u003eWhat could be happening?\u003c/p\u003e\\n\u003cp\u003eWe see in the \u003ccode\u003eTextDecoder\u003c/code\u003e documentation that it has a note called \\\"fatal\\\". We\\ntry\u003c/p\u003e\\n\u003cpre class=\\\"shiki poimandres\\\" style=\\\"background-color: #1b1e28\\\" tabindex=\\\"0\\\"\u003e\u003ccode\u003e\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #91B4D5\\\"\u003econst\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #E4F0FB\\\"\u003ebuf\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #91B4D5\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #E4F0FBD0\\\"\u003eunzip\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color: #E4F0FB\\\"\u003efile\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e)\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #91B4D5\\\"\u003econst\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #E4F0FB\\\"\u003estr\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #91B4D5\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #5DE4C7\\\"\u003enew\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #E4F0FBD0\\\"\u003eTextDecoder\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e'\u003c/span\u003e\u003cspan style=\\\"color: #5DE4C7\\\"\u003eutf8\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e'\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e, {\u003c/span\u003e\u003cspan style=\\\"color: #E4F0FB\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #ADD7FF\\\"\u003efatal\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color: #ADD7FF\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #5DE4C7\\\"\u003etrue\u003c/span\u003e\u003cspan style=\\\"color: #ADD7FF\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e}).\u003c/span\u003e\u003cspan style=\\\"color: #E4F0FBD0\\\"\u003edecode\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color: #E4F0FB\\\"\u003ebuf\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\\n\u003cp\u003eThis doesn't change the results though\u003c/p\u003e\\n\u003cp\u003eThen it dawns on us while the lightning hits and the thunderclap booms and the\\nwind blows through the rattly windows\u003c/p\u003e\\n\u003cp\u003eWe have hit...the maximum string length in Chrome\u003c/p\u003e\\n\u003cp\u003eBWAHAHAHAHA\u003c/p\u003e\\n\u003cp\u003eThe maximum string length!!! Nooooooo\u003c/p\u003e\\n\u003cp\u003eIt is 512MB on the dot... 536,870,888 bytes. We test this to be sure\u003c/p\u003e\\n\u003cpre class=\\\"shiki poimandres\\\" style=\\\"background-color: #1b1e28\\\" tabindex=\\\"0\\\"\u003e\u003ccode\u003e\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #91B4D5\\\"\u003econst\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #E4F0FB\\\"\u003elen\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #91B4D5\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #5DE4C7\\\"\u003e536_870_888\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #91B4D5\\\"\u003econst\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #E4F0FB\\\"\u003ebuf\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #91B4D5\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #5DE4C7\\\"\u003enew\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #E4F0FBD0\\\"\u003eUint8Array\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color: #E4F0FB\\\"\u003elen\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e)\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003efor (\u003c/span\u003e\u003cspan style=\\\"color: #91B4D5\\\"\u003elet\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #E4F0FB\\\"\u003ei\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #91B4D5\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #5DE4C7\\\"\u003e0\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e; \u003c/span\u003e\u003cspan style=\\\"color: #E4F0FB\\\"\u003ei\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #91B4D5\\\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #E4F0FB\\\"\u003elen\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e; \u003c/span\u003e\u003cspan style=\\\"color: #E4F0FB\\\"\u003ei\u003c/span\u003e\u003cspan style=\\\"color: #91B4D5\\\"\u003e++\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e) {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e  \u003c/span\u003e\u003cspan style=\\\"color: #E4F0FB\\\"\u003ebuf\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e[\u003c/span\u003e\u003cspan style=\\\"color: #E4F0FB\\\"\u003ei\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e] \u003c/span\u003e\u003cspan style=\\\"color: #91B4D5\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e'\u003c/span\u003e\u003cspan style=\\\"color: #5DE4C7\\\"\u003ea\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e'\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e.\u003c/span\u003e\u003cspan style=\\\"color: #E4F0FBD0\\\"\u003echarCodeAt\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color: #5DE4C7\\\"\u003e0\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e)\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e}\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #91B4D5\\\"\u003econst\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #E4F0FB\\\"\u003estr\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #91B4D5\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #5DE4C7\\\"\u003enew\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #E4F0FBD0\\\"\u003eTextDecoder\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e().\u003c/span\u003e\u003cspan style=\\\"color: #E4F0FBD0\\\"\u003edecode\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color: #E4F0FB\\\"\u003ebuf\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e)\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #E4F0FB\\\"\u003econsole\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e.\u003c/span\u003e\u003cspan style=\\\"color: #E4F0FBD0\\\"\u003elog\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color: #E4F0FB\\\"\u003estr\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e.\u003c/span\u003e\u003cspan style=\\\"color: #E4F0FB\\\"\u003elength\u003c/span\u003e\u003cspan style=\\\"color: #A6ACCD\\\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\\n\u003cp\u003eThis is correct, outputs 536,870,888\u003c/p\u003e\\n\u003cp\u003eWith anything, even one byte more, it fails and outputs 0\u003c/p\u003e\\n\u003cp\u003ehappy halloween!!\u003c/p\u003e\\n\u003cp\u003epumpkin photo source:\\n\u003ca href=\\\"http://mountainbikerak.blogspot.com/2010/11/google-chrome-pumpkin.html\\\"\u003ehttp://mountainbikerak.blogspot.com/2010/11/google-chrome-pumpkin.html\u003c/a\u003e\u003c/p\u003e\\n\u003cul\u003e\\n\u003cli\u003e\\n\u003cp\u003echrome 95 tested\u003c/p\u003e\\n\u003c/li\u003e\\n\u003cli\u003e\\n\u003cp\u003enodejs 15 - at 512MB+1 bytes it prints an error message\\n\u003ccode\u003eError: Cannot create a string longer than 0x1fffffe8 characters\u003c/code\u003e for\\nsignificantly greater than 512MB e.g. 600MB it actually prints a different\\nerror\\n\u003ccode\u003eTypeError [ERR_ENCODING_INVALID_ENCODED_DATA]: The encoded data was not valid for encoding utf-8\u003c/code\u003e)\u003c/p\u003e\\n\u003c/li\u003e\\n\u003cli\u003e\\n\u003cp\u003efirefox 93 - goes up to ~1GB but then gives Exception\\n\u003ccode\u003e{ name: \\\"NS_ERROR_OUT_OF_MEMORY\\\", message: \\\"\\\", result: 2147942414 }\u003c/code\u003e\u003c/p\u003e\\n\u003c/li\u003e\\n\u003cli\u003e\\n\u003cp\u003emidori 6 (safari-alike/webkit) - goes up to ~2GB fine! will have to test more\u003c/p\u003e\\n\u003c/li\u003e\\n\u003c/ul\u003e\"}}],[\"$\",\"$La\",null,{}]]}]\n"])</script><script>self.__next_f.push([1,"4:[[[\"$\",\"meta\",null,{\"charSet\":\"utf-8\"}],[\"$\",\"title\",null,{\"children\":\"A spooky error when you have a string bigger than 512MB in Chrome\"}],[\"$\",\"meta\",null,{\"name\":\"description\",\"content\":\"A blog\"}],null,null,null,null,null,null,null,null,[\"$\",\"meta\",null,{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],null,null,null,null,null,null,null,null,null,null,[]],[null,null,null,null],null,null,[null,null,null,null,null],null,null,null,null,[null,[[\"$\",\"link\",null,{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"any\"}]],[],null]]\n"])</script>