<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/css/d19cfa26cd1ef694.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-dea5254e1907c5df.js"/><script src="/_next/static/chunks/4bd1b696-7cc559629682b47d.js" async=""></script><script src="/_next/static/chunks/215-0c2c111511fa65fd.js" async=""></script><script src="/_next/static/chunks/main-app-d92e72a2e865503d.js" async=""></script><script src="/_next/static/chunks/231-fc74e6e791c0837d.js" async=""></script><script src="/_next/static/chunks/app/page-95d4a906a5a795f0.js" async=""></script><script src="/_next/static/chunks/app/posts/%5Bid%5D/page-e50cd2f34f19f050.js" async=""></script><title>My next.js static blog setup</title><meta name="description" content="A blog"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body><div class="mb-8"><a href="/">Misc scribbles</a></div><div class="lg:w-1/2"><div><h1>My next.js static blog setup</h1><h4>2021-12-26</h4></div><div><p>TL;DR src here <a href="https://github.com/cmdcolin/cmdcolin.github.io">https://github.com/cmdcolin/cmdcolin.github.io</a></p>
<p>Update 2023: converted to app directory mode, see
<a href="https://cmdcolin.github.io/posts/2023-04-08-nextjs-appdir-blog">https://cmdcolin.github.io/posts/2023-04-08-nextjs-appdir-blog</a></p>
<p>My personal homepage originally used statocles, a perl-based static site
generator (<a href="http://preaction.me/statocles/">http://preaction.me/statocles/</a>). I didn't really blog using it, just
a homepage for myself plus some links to my tumblr blog. But, if I linked people
to the tumblr blog directly, it would give people terrible popup ads and
trackers. So, I switched to github pages+next.js this year. I considered a
number of alternative static site systems, but next.js seemed to hit some nice
goals</p>
<ul>
<li>Flexible</li>
<li>React-based (as opposed to template-based like jekyll, eleventy, etc.)</li>
<li>Markdown driven, and can use MDX (edit 2022: I removed MDX, I disliked the
complicated that it brought. Now all posts are plain markdown, parsed with
<code>remark-gfm</code> for github flavored markdown, and all pages are <code>tsx</code>)</li>
<li>RSS feed (bonus)</li>
<li>Active community</li>
</ul>
<p>Other systems almost worked and were attempted but aborted</p>
<h3 id="first-and-second-iterations"><a aria-hidden="true" tabindex="-1" href="#first-and-second-iterations"><a href="#first-and-second-iterations" style="margin-right: 10px">#</a></a>First and second iterations</h3>
<p>The first iteration of my next.js blog</p>
<ul>
<li>I put every blog post in the "pages" folder. This worked ok but I had to
manually edit the index.mdx file to have long lists of stuff like this
<code>![link to new blogpost](manually_inserted_link_here)</code></li>
</ul>
<p>The second iteration, I wanted to automatically generate a list of recent
blogposts from files on disk</p>
<ul>
<li>
<p>I used the next.js "blog-template-typescript" example folder from their
<a href="https://github.com/vercel/next.js/tree/canary/examples/blog-starter-typescript">monorepo</a>.</p>
</li>
<li>
<p>The new blog posts are generated from markdown files in the <code>_posts</code> folder,
and get rendered by the file <code>pages/posts/[slug].tsx</code> (yes, the filename
includes square brackets).</p>
</li>
<li>
<p>getAllPosts in
<a href="https://github.com/cmdcolin/cmdcolin.github.io/blob/master/lib/api.ts"><code>lib/api.ts</code></a>
gets a listing of the files in _posts folder, which I can call from the
<code>getStaticProps</code> method on next.js pages</p>
</li>
</ul>
<h3 id="stripping-off-unnecessary-stuff-from-blog-starter-typescript"><a aria-hidden="true" tabindex="-1" href="#stripping-off-unnecessary-stuff-from-blog-starter-typescript"><a href="#stripping-off-unnecessary-stuff-from-blog-starter-typescript" style="margin-right: 10px">#</a></a>Stripping off unnecessary stuff from blog-starter-typescript</h3>
<p>The <code>blog-starter-typescript</code> template has many tiny components, I removed some
of them to make it easier for me to orient myself</p>
<ul>
<li><a href="https://github.com/vercel/next.js/tree/canary/examples/blog-starter/components">theirs</a></li>
<li><a href="https://github.com/cmdcolin/cmdcolin.github.io/tree/master/components">mine</a></li>
</ul>
<h3 id="removing-tailwind-css"><a aria-hidden="true" tabindex="-1" href="#removing-tailwind-css"><a href="#removing-tailwind-css" style="margin-right: 10px">#</a></a>Removing tailwind CSS</h3>
<p>The <code>blog-starter-typescript</code> template uses tailwind CSS and uses "modern web
design" (aka: gigantic "tiles" instead of links, images that are way too large,
etc <a href="https://next-blog-starter.vercel.app/">https://next-blog-starter.vercel.app/</a>)</p>
<p>I started making a more basic design. I tried to roll with the tailwind CSS for
a bit, but ended up removing it entirely.</p>
<p>Tailwind CSS is sort of like a CSS-in-JS system, except every CSS attribute is
encoded in a CSS classname. For example, here are some tailwind CSS snippets</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#282c34;color:#abb2bf" tabindex="0" data-language="html" data-theme="one-dark-pro"><code data-language="html" data-theme="one-dark-pro" style="display: grid;"><span data-line=""><span style="color:#ABB2BF">&#x3C;</span><span style="color:#E06C75">div</span><span style="color:#D19A66"> className</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"container mx-auto px-5"</span><span style="color:#ABB2BF">>&#x3C;/</span><span style="color:#E06C75">div</span><span style="color:#ABB2BF">></span></span>
<span data-line=""><span style="color:#ABB2BF">&#x3C;</span><span style="color:#E06C75">footer</span><span style="color:#D19A66"> className</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"bg-accent-1 border-t border-accent-2"</span><span style="color:#ABB2BF">>&#x3C;/</span><span style="color:#E06C75">footer</span><span style="color:#ABB2BF">></span></span>
<span data-line=""><span style="color:#ABB2BF">&#x3C;</span><span style="color:#E06C75">div</span><span style="color:#D19A66"> className</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"max-w-1xl mx-auto"</span><span style="color:#ABB2BF">>&#x3C;/</span><span style="color:#E06C75">div</span><span style="color:#ABB2BF">></span></span>
<span data-line=""><span style="color:#ABB2BF">&#x3C;</span><span style="color:#E06C75">div</span><span style="color:#D19A66"> className</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"min-h-screen"</span><span style="color:#ABB2BF">>&#x3C;/</span><span style="color:#E06C75">div</span><span style="color:#ABB2BF">></span></span>
<span data-line=""><span style="color:#ABB2BF">&#x3C;</span><span style="color:#E06C75">a</span><span style="color:#D19A66"> className</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"hover:underline"</span><span style="color:#ABB2BF">>&#x3C;/</span><span style="color:#E06C75">a</span><span style="color:#ABB2BF">></span></span>
<span data-line=""><span style="color:#ABB2BF">&#x3C;</span><span style="color:#E06C75">h1</span></span>
<span data-line=""><span style="color:#D19A66">  className</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"text-2xl md:text-2xl lg:text-2xl font-bold tracking-tighter leading-tight md:leading-none mb-12 text-center md:text-left"</span></span>
<span data-line=""><span style="color:#ABB2BF">>&#x3C;/</span><span style="color:#E06C75">h1</span><span style="color:#ABB2BF">></span></span></code></pre></figure>
<p>They claim this is better than using external CSS (see comparison here
<a href="https://tailwindcss.com/docs/utility-first">https://tailwindcss.com/docs/utility-first</a>) but it is yet another language to
learn, and kind of tricky.</p>
<p>But, the reason I gave up with tailwind is actually because tailwind CSS resets
a lot of HTML styles so things like <code>&#x3C;h1></code>, <code>&#x3C;h2></code>, <code>&#x3C;ul></code>, <code>&#x3C;li></code>, <code>&#x3C;a></code> have
no styling at all. This is done by <code>tailwind preflight</code>
<a href="https://tailwindcss.com/docs/preflight">https://tailwindcss.com/docs/preflight</a> (which you can disable, but it is enabled
by default)</p>
<p>Stackoverflow has some ways to help restore styling and keep preflight, but it
still struck me as odd. Examples</p>
<ul>
<li>
<p><a href="https://stackoverflow.com/a/68853223/2129219">Example: you have to manually restore underlines on <code>&#x3C;a></code> elements if using tailwind XSS</a></p>
</li>
<li>
<p><a href="https://stackoverflow.com/questions/69264976/cant-display-markdown-on-nextjs">Another example: "It looks like you're using TailwindCSS, the default styles for elements are reset, that's why the h1 text will look like any other text."</a></p>
</li>
<li>
<p><a href="https://raw.githubusercontent.com/vercel/next.js/canary/examples/blog-starter-typescript/components/markdown-styles.module.css">Another example <code>blog-template-typescript</code> uses this file to try to style the markdown using some general styles</a></p>
</li>
</ul>
<p>To me it was surprising the extend that tailwind goes to unstyle the default
browser styles, removing "idiomatic HTML" styles, so I removed tailwind for now.
Perhaps I'll return to it another time</p>
<h2 id="using-mdx-for-blogposts-in-nextjs"><a aria-hidden="true" tabindex="-1" href="#using-mdx-for-blogposts-in-nextjs"><a href="#using-mdx-for-blogposts-in-nextjs" style="margin-right: 10px">#</a></a>Using MDX for blogposts in next.js</h2>
<p>(UPDATE 2022) I no longer use MDX in my blog, my blogposts are all plain
markdown and pages tsx, but leave this here for reference</p>
<p>In the template from next.js team, the <code>blog-template-typescript</code>, it uses a
fairly simple <code>lib/markdownToHtml.ts</code> function right in the
<code>pages/posts/[slug].tsx</code> file (the markdown is statically pre-rendered in the
true static blog sense, using the getStaticProps function). This is,
unfortunately, over-simplified for the MDX case, because MDX properly needs to
hydrate the components using react on the client side also</p>
<p>To fix, the module <a href="https://github.com/hashicorp/next-mdx-remote">https://github.com/hashicorp/next-mdx-remote</a> offers a way to
load actual MDX files.</p>
<h2 id="adding-syntax-highlighting-the-nextjs-code-snippets"><a aria-hidden="true" tabindex="-1" href="#adding-syntax-highlighting-the-nextjs-code-snippets"><a href="#adding-syntax-highlighting-the-nextjs-code-snippets" style="margin-right: 10px">#</a></a>Adding syntax highlighting the next.js code snippets</h2>
<p>(UPDATE 2022) I changed to using plain remark with
<a href="https://github.com/wooorm/starry-night">https://github.com/wooorm/starry-night</a> (UPDATE 2022 v2) I changed from
starry-night to rehype-highlight. starry-night did not have good typescript/tsx
support</p>
<p>There are a couple results from google about how to add syntax highlighting to
next.js but I still found it difficult.</p>
<p>My method ended up a bit different where I manually included the prism JS and
CSS from a CDN essentially and it worked</p>
<p><a href="https://github.com/cmdcolin/cmdcolin.github.io/blob/aa080193f45cb3e3d11ca1ead2bbd5eb2ae09633/styles/index.css#L14-L15">https://github.com/cmdcolin/cmdcolin.github.io/blob/aa080193f45cb3e3d11ca1ead2bbd5eb2ae09633/styles/index.css#L14-L15</a></p>
<p><a href="https://github.com/cmdcolin/cmdcolin.github.io/blob/aa080193f45cb3e3d11ca1ead2bbd5eb2ae09633/pages/_document.tsx#L12-L17">https://github.com/cmdcolin/cmdcolin.github.io/blob/aa080193f45cb3e3d11ca1ead2bbd5eb2ae09633/pages/_document.tsx#L12-L17</a></p>
<p>Other methods e.g. adding react-prism in next.config.js (like
<a href="https://github.com/mikeesto/next-mdx-prism-example">https://github.com/mikeesto/next-mdx-prism-example</a> does) I think clashed with
MDXRemote perhaps, or maybe I was tussling with tailwind CSS too much to make a
clear thought out of it, but syntax blocks on my blogposts should now be
properly highlighted</p>
<h2 id="rss-feed"><a aria-hidden="true" tabindex="-1" href="#rss-feed"><a href="#rss-feed" style="margin-right: 10px">#</a></a>RSS feed</h2>
<p>I also followed this great guide to add a RSS file for next.js
<a href="https://ashleemboyer.com/how-i-added-an-rss-feed-to-my-nextjs-site">https://ashleemboyer.com/how-i-added-an-rss-feed-to-my-nextjs-site</a></p>
<p>Link here, for your feed readers <a href="https://cmdcolin.github.io/rss.xml">https://cmdcolin.github.io/rss.xml</a></p>
<p>Not many people may use RSS much anymore, but I do use it (via feedly), and I
love music blogs that keep posting on blogspot year after year, and the
occasional programming post is nice too</p></div><div class="mt-5"></div></div><footer class="mt-16"><a class="m-2" href="/">Home</a><a class="m-2" href="/archive">Blog archive</a><a class="m-2" href="https://github.com/cmdcolin/">Github</a><a class="m-2" href="/projects">Projects</a><a class="m-2" href="/photos">Photos</a><a class="m-2" href="/books">Books</a><a class="m-2" href="/about">About</a></footer><script src="/_next/static/chunks/webpack-dea5254e1907c5df.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"2:\"$Sreact.fragment\"\n3:I[231,[\"231\",\"static/chunks/231-fc74e6e791c0837d.js\",\"931\",\"static/chunks/app/page-95d4a906a5a795f0.js\"],\"\"]\n4:I[9275,[],\"\"]\n5:I[1343,[],\"\"]\n7:I[3120,[],\"OutletBoundary\"]\n9:I[3120,[],\"MetadataBoundary\"]\nb:I[3120,[],\"ViewportBoundary\"]\nd:I[6130,[],\"\"]\n1:HL[\"/_next/static/css/d19cfa26cd1ef694.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"H8zRZr_eaA6W0Inm0GAij\",\"p\":\"\",\"c\":[\"\",\"posts\",\"2021-12-26-nextjs\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"posts\",{\"children\":[[\"id\",\"2021-12-26-nextjs\",\"d\"],{\"children\":[\"__PAGE__?{\\\"id\\\":\\\"2021-12-26-nextjs\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$2\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/d19cfa26cd1ef694.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"children\":[[\"$\",\"div\",null,{\"className\":\"mb-8\",\"children\":[\"$\",\"$L3\",null,{\"href\":\"/\",\"children\":\"Misc scribbles\"}]}],[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[]}],[\"$\",\"footer\",null,{\"className\":\"mt-16\",\"children\":[[\"$\",\"$L3\",null,{\"className\":\"m-2\",\"href\":\"/\",\"children\":\"Home\"}],[\"$\",\"$L3\",null,{\"className\":\"m-2\",\"href\":\"/archive\",\"children\":\"Blog archive\"}],[\"$\",\"$L3\",null,{\"className\":\"m-2\",\"href\":\"https://github.com/cmdcolin/\",\"children\":\"Github\"}],[\"$\",\"$L3\",null,{\"className\":\"m-2\",\"href\":\"/projects\",\"children\":\"Projects\"}],[\"$\",\"$L3\",null,{\"className\":\"m-2\",\"href\":\"/photos\",\"children\":\"Photos\"}],[\"$\",\"$L3\",null,{\"className\":\"m-2\",\"href\":\"/books\",\"children\":\"Books\"}],[\"$\",\"$L3\",null,{\"className\":\"m-2\",\"href\":\"/about\",\"children\":\"About\"}]]}]]}]}]]}],{\"children\":[\"posts\",[\"$\",\"$2\",\"c\",{\"children\":[null,[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]]}],{\"children\":[[\"id\",\"2021-12-26-nextjs\",\"d\"],[\"$\",\"$2\",\"c\",{\"children\":[null,[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\",\"$0:f:0:1:2:children:2:children:0\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$2\",\"c\",{\"children\":[\"$L6\",null,[\"$\",\"$L7\",null,{\"children\":\"$L8\"}]]}],{},null]},null]},null]},null],[\"$\",\"$2\",\"h\",{\"children\":[null,[\"$\",\"$2\",\"TIReEd7zwiFvFIuqQCdOj\",{\"children\":[[\"$\",\"$L9\",null,{\"children\":\"$La\"}],[\"$\",\"$Lb\",null,{\"children\":\"$Lc\"}],null]}]]}]]],\"m\":\"$undefined\",\"G\":[\"$d\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"c:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"f:I[1458,[\"722\",\"static/chunks/app/posts/%5Bid%5D/page-e50cd2f34f19f050.js\"],\"default\"]\ne:T2e4c,"])</script><script>self.__next_f.push([1,"\u003cp\u003eTL;DR src here \u003ca href=\"https://github.com/cmdcolin/cmdcolin.github.io\"\u003ehttps://github.com/cmdcolin/cmdcolin.github.io\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eUpdate 2023: converted to app directory mode, see\n\u003ca href=\"https://cmdcolin.github.io/posts/2023-04-08-nextjs-appdir-blog\"\u003ehttps://cmdcolin.github.io/posts/2023-04-08-nextjs-appdir-blog\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eMy personal homepage originally used statocles, a perl-based static site\ngenerator (\u003ca href=\"http://preaction.me/statocles/\"\u003ehttp://preaction.me/statocles/\u003c/a\u003e). I didn't really blog using it, just\na homepage for myself plus some links to my tumblr blog. But, if I linked people\nto the tumblr blog directly, it would give people terrible popup ads and\ntrackers. So, I switched to github pages+next.js this year. I considered a\nnumber of alternative static site systems, but next.js seemed to hit some nice\ngoals\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eFlexible\u003c/li\u003e\n\u003cli\u003eReact-based (as opposed to template-based like jekyll, eleventy, etc.)\u003c/li\u003e\n\u003cli\u003eMarkdown driven, and can use MDX (edit 2022: I removed MDX, I disliked the\ncomplicated that it brought. Now all posts are plain markdown, parsed with\n\u003ccode\u003eremark-gfm\u003c/code\u003e for github flavored markdown, and all pages are \u003ccode\u003etsx\u003c/code\u003e)\u003c/li\u003e\n\u003cli\u003eRSS feed (bonus)\u003c/li\u003e\n\u003cli\u003eActive community\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eOther systems almost worked and were attempted but aborted\u003c/p\u003e\n\u003ch3 id=\"first-and-second-iterations\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#first-and-second-iterations\"\u003e\u003ca href=\"#first-and-second-iterations\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eFirst and second iterations\u003c/h3\u003e\n\u003cp\u003eThe first iteration of my next.js blog\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eI put every blog post in the \"pages\" folder. This worked ok but I had to\nmanually edit the index.mdx file to have long lists of stuff like this\n\u003ccode\u003e![link to new blogpost](manually_inserted_link_here)\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThe second iteration, I wanted to automatically generate a list of recent\nblogposts from files on disk\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eI used the next.js \"blog-template-typescript\" example folder from their\n\u003ca href=\"https://github.com/vercel/next.js/tree/canary/examples/blog-starter-typescript\"\u003emonorepo\u003c/a\u003e.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eThe new blog posts are generated from markdown files in the \u003ccode\u003e_posts\u003c/code\u003e folder,\nand get rendered by the file \u003ccode\u003epages/posts/[slug].tsx\u003c/code\u003e (yes, the filename\nincludes square brackets).\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003egetAllPosts in\n\u003ca href=\"https://github.com/cmdcolin/cmdcolin.github.io/blob/master/lib/api.ts\"\u003e\u003ccode\u003elib/api.ts\u003c/code\u003e\u003c/a\u003e\ngets a listing of the files in _posts folder, which I can call from the\n\u003ccode\u003egetStaticProps\u003c/code\u003e method on next.js pages\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"stripping-off-unnecessary-stuff-from-blog-starter-typescript\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#stripping-off-unnecessary-stuff-from-blog-starter-typescript\"\u003e\u003ca href=\"#stripping-off-unnecessary-stuff-from-blog-starter-typescript\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eStripping off unnecessary stuff from blog-starter-typescript\u003c/h3\u003e\n\u003cp\u003eThe \u003ccode\u003eblog-starter-typescript\u003c/code\u003e template has many tiny components, I removed some\nof them to make it easier for me to orient myself\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/vercel/next.js/tree/canary/examples/blog-starter/components\"\u003etheirs\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/cmdcolin/cmdcolin.github.io/tree/master/components\"\u003emine\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"removing-tailwind-css\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#removing-tailwind-css\"\u003e\u003ca href=\"#removing-tailwind-css\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eRemoving tailwind CSS\u003c/h3\u003e\n\u003cp\u003eThe \u003ccode\u003eblog-starter-typescript\u003c/code\u003e template uses tailwind CSS and uses \"modern web\ndesign\" (aka: gigantic \"tiles\" instead of links, images that are way too large,\netc \u003ca href=\"https://next-blog-starter.vercel.app/\"\u003ehttps://next-blog-starter.vercel.app/\u003c/a\u003e)\u003c/p\u003e\n\u003cp\u003eI started making a more basic design. I tried to roll with the tailwind CSS for\na bit, but ended up removing it entirely.\u003c/p\u003e\n\u003cp\u003eTailwind CSS is sort of like a CSS-in-JS system, except every CSS attribute is\nencoded in a CSS classname. For example, here are some tailwind CSS snippets\u003c/p\u003e\n\u003cfigure data-rehype-pretty-code-figure=\"\"\u003e\u003cpre style=\"background-color:#282c34;color:#abb2bf\" tabindex=\"0\" data-language=\"html\" data-theme=\"one-dark-pro\"\u003e\u003ccode data-language=\"html\" data-theme=\"one-dark-pro\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#ABB2BF\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan style=\"color:#E06C75\"\u003ediv\u003c/span\u003e\u003cspan style=\"color:#D19A66\"\u003e className\u003c/span\u003e\u003cspan style=\"color:#ABB2BF\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#98C379\"\u003e\"container mx-auto px-5\"\u003c/span\u003e\u003cspan style=\"color:#ABB2BF\"\u003e\u003e\u0026#x3C;/\u003c/span\u003e\u003cspan style=\"color:#E06C75\"\u003ediv\u003c/span\u003e\u003cspan style=\"color:#ABB2BF\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#ABB2BF\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan style=\"color:#E06C75\"\u003efooter\u003c/span\u003e\u003cspan style=\"color:#D19A66\"\u003e className\u003c/span\u003e\u003cspan style=\"color:#ABB2BF\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#98C379\"\u003e\"bg-accent-1 border-t border-accent-2\"\u003c/span\u003e\u003cspan style=\"color:#ABB2BF\"\u003e\u003e\u0026#x3C;/\u003c/span\u003e\u003cspan style=\"color:#E06C75\"\u003efooter\u003c/span\u003e\u003cspan style=\"color:#ABB2BF\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#ABB2BF\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan style=\"color:#E06C75\"\u003ediv\u003c/span\u003e\u003cspan style=\"color:#D19A66\"\u003e className\u003c/span\u003e\u003cspan style=\"color:#ABB2BF\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#98C379\"\u003e\"max-w-1xl mx-auto\"\u003c/span\u003e\u003cspan style=\"color:#ABB2BF\"\u003e\u003e\u0026#x3C;/\u003c/span\u003e\u003cspan style=\"color:#E06C75\"\u003ediv\u003c/span\u003e\u003cspan style=\"color:#ABB2BF\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#ABB2BF\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan style=\"color:#E06C75\"\u003ediv\u003c/span\u003e\u003cspan style=\"color:#D19A66\"\u003e className\u003c/span\u003e\u003cspan style=\"color:#ABB2BF\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#98C379\"\u003e\"min-h-screen\"\u003c/span\u003e\u003cspan style=\"color:#ABB2BF\"\u003e\u003e\u0026#x3C;/\u003c/span\u003e\u003cspan style=\"color:#E06C75\"\u003ediv\u003c/span\u003e\u003cspan style=\"color:#ABB2BF\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#ABB2BF\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan style=\"color:#E06C75\"\u003ea\u003c/span\u003e\u003cspan style=\"color:#D19A66\"\u003e className\u003c/span\u003e\u003cspan style=\"color:#ABB2BF\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#98C379\"\u003e\"hover:underline\"\u003c/span\u003e\u003cspan style=\"color:#ABB2BF\"\u003e\u003e\u0026#x3C;/\u003c/span\u003e\u003cspan style=\"color:#E06C75\"\u003ea\u003c/span\u003e\u003cspan style=\"color:#ABB2BF\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#ABB2BF\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan style=\"color:#E06C75\"\u003eh1\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#D19A66\"\u003e  className\u003c/span\u003e\u003cspan style=\"color:#ABB2BF\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#98C379\"\u003e\"text-2xl md:text-2xl lg:text-2xl font-bold tracking-tighter leading-tight md:leading-none mb-12 text-center md:text-left\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#ABB2BF\"\u003e\u003e\u0026#x3C;/\u003c/span\u003e\u003cspan style=\"color:#E06C75\"\u003eh1\u003c/span\u003e\u003cspan style=\"color:#ABB2BF\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/figure\u003e\n\u003cp\u003eThey claim this is better than using external CSS (see comparison here\n\u003ca href=\"https://tailwindcss.com/docs/utility-first\"\u003ehttps://tailwindcss.com/docs/utility-first\u003c/a\u003e) but it is yet another language to\nlearn, and kind of tricky.\u003c/p\u003e\n\u003cp\u003eBut, the reason I gave up with tailwind is actually because tailwind CSS resets\na lot of HTML styles so things like \u003ccode\u003e\u0026#x3C;h1\u003e\u003c/code\u003e, \u003ccode\u003e\u0026#x3C;h2\u003e\u003c/code\u003e, \u003ccode\u003e\u0026#x3C;ul\u003e\u003c/code\u003e, \u003ccode\u003e\u0026#x3C;li\u003e\u003c/code\u003e, \u003ccode\u003e\u0026#x3C;a\u003e\u003c/code\u003e have\nno styling at all. This is done by \u003ccode\u003etailwind preflight\u003c/code\u003e\n\u003ca href=\"https://tailwindcss.com/docs/preflight\"\u003ehttps://tailwindcss.com/docs/preflight\u003c/a\u003e (which you can disable, but it is enabled\nby default)\u003c/p\u003e\n\u003cp\u003eStackoverflow has some ways to help restore styling and keep preflight, but it\nstill struck me as odd. Examples\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://stackoverflow.com/a/68853223/2129219\"\u003eExample: you have to manually restore underlines on \u003ccode\u003e\u0026#x3C;a\u003e\u003c/code\u003e elements if using tailwind XSS\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://stackoverflow.com/questions/69264976/cant-display-markdown-on-nextjs\"\u003eAnother example: \"It looks like you're using TailwindCSS, the default styles for elements are reset, that's why the h1 text will look like any other text.\"\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://raw.githubusercontent.com/vercel/next.js/canary/examples/blog-starter-typescript/components/markdown-styles.module.css\"\u003eAnother example \u003ccode\u003eblog-template-typescript\u003c/code\u003e uses this file to try to style the markdown using some general styles\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eTo me it was surprising the extend that tailwind goes to unstyle the default\nbrowser styles, removing \"idiomatic HTML\" styles, so I removed tailwind for now.\nPerhaps I'll return to it another time\u003c/p\u003e\n\u003ch2 id=\"using-mdx-for-blogposts-in-nextjs\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#using-mdx-for-blogposts-in-nextjs\"\u003e\u003ca href=\"#using-mdx-for-blogposts-in-nextjs\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eUsing MDX for blogposts in next.js\u003c/h2\u003e\n\u003cp\u003e(UPDATE 2022) I no longer use MDX in my blog, my blogposts are all plain\nmarkdown and pages tsx, but leave this here for reference\u003c/p\u003e\n\u003cp\u003eIn the template from next.js team, the \u003ccode\u003eblog-template-typescript\u003c/code\u003e, it uses a\nfairly simple \u003ccode\u003elib/markdownToHtml.ts\u003c/code\u003e function right in the\n\u003ccode\u003epages/posts/[slug].tsx\u003c/code\u003e file (the markdown is statically pre-rendered in the\ntrue static blog sense, using the getStaticProps function). This is,\nunfortunately, over-simplified for the MDX case, because MDX properly needs to\nhydrate the components using react on the client side also\u003c/p\u003e\n\u003cp\u003eTo fix, the module \u003ca href=\"https://github.com/hashicorp/next-mdx-remote\"\u003ehttps://github.com/hashicorp/next-mdx-remote\u003c/a\u003e offers a way to\nload actual MDX files.\u003c/p\u003e\n\u003ch2 id=\"adding-syntax-highlighting-the-nextjs-code-snippets\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#adding-syntax-highlighting-the-nextjs-code-snippets\"\u003e\u003ca href=\"#adding-syntax-highlighting-the-nextjs-code-snippets\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eAdding syntax highlighting the next.js code snippets\u003c/h2\u003e\n\u003cp\u003e(UPDATE 2022) I changed to using plain remark with\n\u003ca href=\"https://github.com/wooorm/starry-night\"\u003ehttps://github.com/wooorm/starry-night\u003c/a\u003e (UPDATE 2022 v2) I changed from\nstarry-night to rehype-highlight. starry-night did not have good typescript/tsx\nsupport\u003c/p\u003e\n\u003cp\u003eThere are a couple results from google about how to add syntax highlighting to\nnext.js but I still found it difficult.\u003c/p\u003e\n\u003cp\u003eMy method ended up a bit different where I manually included the prism JS and\nCSS from a CDN essentially and it worked\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/cmdcolin/cmdcolin.github.io/blob/aa080193f45cb3e3d11ca1ead2bbd5eb2ae09633/styles/index.css#L14-L15\"\u003ehttps://github.com/cmdcolin/cmdcolin.github.io/blob/aa080193f45cb3e3d11ca1ead2bbd5eb2ae09633/styles/index.css#L14-L15\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/cmdcolin/cmdcolin.github.io/blob/aa080193f45cb3e3d11ca1ead2bbd5eb2ae09633/pages/_document.tsx#L12-L17\"\u003ehttps://github.com/cmdcolin/cmdcolin.github.io/blob/aa080193f45cb3e3d11ca1ead2bbd5eb2ae09633/pages/_document.tsx#L12-L17\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eOther methods e.g. adding react-prism in next.config.js (like\n\u003ca href=\"https://github.com/mikeesto/next-mdx-prism-example\"\u003ehttps://github.com/mikeesto/next-mdx-prism-example\u003c/a\u003e does) I think clashed with\nMDXRemote perhaps, or maybe I was tussling with tailwind CSS too much to make a\nclear thought out of it, but syntax blocks on my blogposts should now be\nproperly highlighted\u003c/p\u003e\n\u003ch2 id=\"rss-feed\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#rss-feed\"\u003e\u003ca href=\"#rss-feed\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eRSS feed\u003c/h2\u003e\n\u003cp\u003eI also followed this great guide to add a RSS file for next.js\n\u003ca href=\"https://ashleemboyer.com/how-i-added-an-rss-feed-to-my-nextjs-site\"\u003ehttps://ashleemboyer.com/how-i-added-an-rss-feed-to-my-nextjs-site\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eLink here, for your feed readers \u003ca href=\"https://cmdcolin.github.io/rss.xml\"\u003ehttps://cmdcolin.github.io/rss.xml\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eNot many people may use RSS much anymore, but I do use it (via feedly), and I\nlove music blogs that keep posting on blogspot year after year, and the\noccasional programming post is nice too\u003c/p\u003e"])</script><script>self.__next_f.push([1,"6:[\"$\",\"div\",null,{\"className\":\"lg:w-1/2\",\"children\":[[\"$\",\"div\",null,{\"children\":[[\"$\",\"h1\",null,{\"children\":\"My next.js static blog setup\"}],[\"$\",\"h4\",null,{\"children\":\"2021-12-26\"}]]}],[\"$\",\"div\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$e\"}}],[\"$\",\"$Lf\",null,{}]]}]\na:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"My next.js static blog setup\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"A blog\"}]]\n8:null\n"])</script></body></html>