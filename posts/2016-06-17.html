<!DOCTYPE html><html lang="en"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="shortcut icon" href="favicon.ico"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><meta name="description" content="Blogging for the future"/><title>Querying InterMine databases using R</title><meta name="next-head-count" content="6"/><link rel="preload" href="/_next/static/css/895e0128ed383e47.css" as="style"/><link rel="stylesheet" href="/_next/static/css/895e0128ed383e47.css" data-n-g=""/><link rel="preload" href="/_next/static/css/e1f6961df2961232.css" as="style"/><link rel="stylesheet" href="/_next/static/css/e1f6961df2961232.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-514908bffb652963.js" defer=""></script><script src="/_next/static/chunks/framework-91d7f78b5b4003c8.js" defer=""></script><script src="/_next/static/chunks/main-7c3bf82eed00c281.js" defer=""></script><script src="/_next/static/chunks/pages/_app-76cd57bf65f05d70.js" defer=""></script><script src="/_next/static/chunks/162-45f0e6507a8fad45.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-2c663bbcac870718.js" defer=""></script><script src="/_next/static/wXV4IisXQEWiI80ioaUyx/_buildManifest.js" defer=""></script><script src="/_next/static/wXV4IisXQEWiI80ioaUyx/_ssgManifest.js" defer=""></script><script src="/_next/static/wXV4IisXQEWiI80ioaUyx/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><div class="min-h-screen"><main><div class="container mx-auto px-5"><div class="text-2xl md:text-4xl font-bold py-14 border-b border-accent-2 flex flex-col lg:flex-row items-center"><a class="hover:underline" href="/">Misc scribbles</a></div><article class="mb-32"><h1 class="text-2xl md:text-2xl lg:text-2xl font-bold tracking-tighter leading-tight md:leading-none mb-12 text-center md:text-left">Querying InterMine databases using R<!-- --> - <!-- -->2016-06-17</h1><div class="max-w-1xl mx-auto"><div class="markdown-styles_markdown__h_8de"><p>In the past, I had found some ways to do simple queries on InterMine web
services using basic HTTP commands with R (see
<a href="https://gist.github.com/cmdcolin/4758167bdd89e6c9c055">https://gist.github.com/cmdcolin/4758167bdd89e6c9c055</a>)</p>
<p>However, the InterMineR (<a href="https://github.com/intermine/intermineR">https://github.com/intermine/intermineR</a>)
package automates some of these features and makes it easier to load the
data in R.</p>
<p><strong>Installation</strong></p>
<p>One way to install InterMineR is to install from github with
hadley/devtools</p>
<pre><code>install.packages("devtools")
devtools::install_github("hadley/devtools")
devtools::install_github("intermine/intermineR")
</code></pre>
<p><strong>Usage</strong></p>
<p>Basic usage includes loading the "intermine URL" using the initInterMine
function. Then various functions can be called on this result.</p>
<pre><code>library(InterMineR)
mine=initInterMine("http://bovinegenome.org/bovinemine/")
getVersion(mine) #18, intermine API version
getRelease(mine) #1.0, our data release version
getTemplates(mine) # lists all templates on interminer
</code></pre>
<p><strong>Run a template query</strong></p>
<p>From the getTemplates function, if you see a template query that you
want to run, you can use the getTemplateQuery function with it's name,
and run it with the runQuery function</p>
<pre><code>getTemplateQuery(mine,"TQ_protein_to_gene") # see what template looks like
template=getTemplateQuery(mine,"TQ_protein_to_gene") # save template
runQuery(mine,template) # run the template query with default params, receive data.frame
</code></pre>
<p>This method is good, but some improvement could be added to change
default parameters in the template query, etc.</p>
<p><strong>Run query XML</strong></p>
<p>Another option for running queries is to use the query XML that you can
download from the InterMine query result pages.</p>
<pre><code> # get all Ensembl genes on chr28 from bovinemine
 query='&#x3C;query model="genomic" view="Gene.primaryIdentifier
 Gene.secondaryIdentifier Gene.symbol Gene.name Gene.source
 Gene.organism.shortName Gene.chromosome.primaryIdentifier"
 sortOrder="Gene.primaryIdentifier ASC" >&#x3C;constraint
 path="Gene.organism.shortName" op="=" value="B. taurus"
 />&#x3C;constraint path="Gene.chromosome.primaryIdentifier" op="="
 value="GK000028.2" />&#x3C;/query>'

 results=runQuery(mine, query)

 head(results)
</code></pre>
<p><strong>Conclusion</strong></p>
<p>The InterMineR package has a couple of nice features for getting
InterMine data with a couple of functions for looking at templates. For
many use cases, copying the Query XML from a InterMine webpage and
pasting that into the runQuery function is sufficient and produces a
data frame that can be analyzed.</p>
<p>PS it is not easy to post XML on tumblr after editing the post in
markdown mode. You have to add the lt and gt shortcuts and even after
that it gets filtered?!</p>
</div></div></article></div></main></div><footer class="bg-accent-1 border-t border-accent-2"><div class="container mx-auto px-5"><div class="py-14 flex flex-col lg:flex-row items-center"><div class="m-4"><a class="hover:underline" href="/">Home</a></div><div class="m-4"><a class="hover:underline" href="https://github.com/cmdcolin">Github</a></div><div class="m-4"><a class="hover:underline" href="https://twitter.com/cmdcolin">Twitter</a></div><div class="m-4"><a class="hover:underline" href="/projects">Projects</a></div><div class="m-4"><a class="hover:underline" href="/photos">Photos</a></div><div class="m-4"><a class="hover:underline" href="/rss.xml">RSS</a></div></div></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Querying InterMine databases using R","date":"2016-06-17","slug":"2016-06-17","content":"\u003cp\u003eIn the past, I had found some ways to do simple queries on InterMine web\nservices using basic HTTP commands with R (see\n\u003ca href=\"https://gist.github.com/cmdcolin/4758167bdd89e6c9c055\"\u003ehttps://gist.github.com/cmdcolin/4758167bdd89e6c9c055\u003c/a\u003e)\u003c/p\u003e\n\u003cp\u003eHowever, the InterMineR (\u003ca href=\"https://github.com/intermine/intermineR\"\u003ehttps://github.com/intermine/intermineR\u003c/a\u003e)\npackage automates some of these features and makes it easier to load the\ndata in R.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eInstallation\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eOne way to install InterMineR is to install from github with\nhadley/devtools\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003einstall.packages(\"devtools\")\ndevtools::install_github(\"hadley/devtools\")\ndevtools::install_github(\"intermine/intermineR\")\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003eUsage\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eBasic usage includes loading the \"intermine URL\" using the initInterMine\nfunction. Then various functions can be called on this result.\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003elibrary(InterMineR)\nmine=initInterMine(\"http://bovinegenome.org/bovinemine/\")\ngetVersion(mine) #18, intermine API version\ngetRelease(mine) #1.0, our data release version\ngetTemplates(mine) # lists all templates on interminer\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003eRun a template query\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eFrom the getTemplates function, if you see a template query that you\nwant to run, you can use the getTemplateQuery function with it's name,\nand run it with the runQuery function\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003egetTemplateQuery(mine,\"TQ_protein_to_gene\") # see what template looks like\ntemplate=getTemplateQuery(mine,\"TQ_protein_to_gene\") # save template\nrunQuery(mine,template) # run the template query with default params, receive data.frame\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThis method is good, but some improvement could be added to change\ndefault parameters in the template query, etc.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eRun query XML\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eAnother option for running queries is to use the query XML that you can\ndownload from the InterMine query result pages.\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e # get all Ensembl genes on chr28 from bovinemine\n query='\u0026#x3C;query model=\"genomic\" view=\"Gene.primaryIdentifier\n Gene.secondaryIdentifier Gene.symbol Gene.name Gene.source\n Gene.organism.shortName Gene.chromosome.primaryIdentifier\"\n sortOrder=\"Gene.primaryIdentifier ASC\" \u003e\u0026#x3C;constraint\n path=\"Gene.organism.shortName\" op=\"=\" value=\"B. taurus\"\n /\u003e\u0026#x3C;constraint path=\"Gene.chromosome.primaryIdentifier\" op=\"=\"\n value=\"GK000028.2\" /\u003e\u0026#x3C;/query\u003e'\n\n results=runQuery(mine, query)\n\n head(results)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003eConclusion\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eThe InterMineR package has a couple of nice features for getting\nInterMine data with a couple of functions for looking at templates. For\nmany use cases, copying the Query XML from a InterMine webpage and\npasting that into the runQuery function is sufficient and produces a\ndata frame that can be analyzed.\u003c/p\u003e\n\u003cp\u003ePS it is not easy to post XML on tumblr after editing the post in\nmarkdown mode. You have to add the lt and gt shortcuts and even after\nthat it gets filtered?!\u003c/p\u003e\n"}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"2016-06-17"},"buildId":"wXV4IisXQEWiI80ioaUyx","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>