<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Querying InterMine databases using R</title><meta name="next-head-count" content="3"/><link rel="shortcut icon" href="favicon.ico"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><meta name="description" content="Blogging for the future"/><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/prism.min.js" integrity="sha512-hpZ5pDCF2bRCweL5WoA0/N1elet1KYL5mx3LP555Eg/0ZguaHawxNvEjF6O3rufAChs16HVNhEc6blF/rZoowQ==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="preload" href="/_next/static/css/50853c3f2e0364c3.css" as="style"/><link rel="stylesheet" href="/_next/static/css/50853c3f2e0364c3.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-93aa87d657ed1852.js" defer=""></script><script src="/_next/static/chunks/framework-c0d8f0fd2eea5ac1.js" defer=""></script><script src="/_next/static/chunks/main-b12cd062888056b2.js" defer=""></script><script src="/_next/static/chunks/pages/_app-d9139de5c3de3b6b.js" defer=""></script><script src="/_next/static/chunks/996-3d2a4318c0ac6f1a.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-b6f09b4db8bfc341.js" defer=""></script><script src="/_next/static/Yjari4YcqZldNSQarwsr7/_buildManifest.js" defer=""></script><script src="/_next/static/Yjari4YcqZldNSQarwsr7/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div><main><div><div style="margin-bottom:100px"><a href="/">Misc scribbles</a></div><article><div><h1>Querying InterMine databases using R</h1><h4>2016-06-17</h4></div><div><p>In the past, I had found some ways to do simple queries on InterMine web
services using basic HTTP commands with R (see
<a href="https://gist.github.com/cmdcolin/4758167bdd89e6c9c055">https://gist.github.com/cmdcolin/4758167bdd89e6c9c055</a>)</p>
<p>However, the InterMineR (<a href="https://github.com/intermine/intermineR">https://github.com/intermine/intermineR</a>)
package automates some of these features and makes it easier to load the
data in R.</p>
<h2 id="installation"><a aria-hidden="true" tabindex="-1" href="#installation"><a href="#installation" style="margin-right: 10px">#</a></a>Installation</h2>
<p>One way to install InterMineR is to install from github with
hadley/devtools</p>
<div class="highlight highlight-r"><pre>install.packages(<span class="pl-s"><span class="pl-pds">"</span>devtools<span class="pl-pds">"</span></span>)
<span class="pl-e">devtools</span><span class="pl-k">::</span>install_github(<span class="pl-s"><span class="pl-pds">"</span>hadley/devtools<span class="pl-pds">"</span></span>)
<span class="pl-e">devtools</span><span class="pl-k">::</span>install_github(<span class="pl-s"><span class="pl-pds">"</span>intermine/intermineR<span class="pl-pds">"</span></span>)
</pre></div>
<h2 id="usage"><a aria-hidden="true" tabindex="-1" href="#usage"><a href="#usage" style="margin-right: 10px">#</a></a>Usage</h2>
<p>Basic usage includes loading the "intermine URL" using the initInterMine
function. Then various functions can be called on this result.</p>
<div class="highlight highlight-r"><pre>library(<span class="pl-smi">InterMineR</span>)
<span class="pl-v">mine</span><span class="pl-k">=</span>initInterMine(<span class="pl-s"><span class="pl-pds">"</span>http://bovinegenome.org/bovinemine/<span class="pl-pds">"</span></span>)
getVersion(<span class="pl-smi">mine</span>) <span class="pl-c">#18, intermine API version</span>
getRelease(<span class="pl-smi">mine</span>) <span class="pl-c">#1.0, our data release version</span>
getTemplates(<span class="pl-smi">mine</span>) <span class="pl-c"># lists all templates on interminer</span>
</pre></div>
<h2 id="run-a-template-query"><a aria-hidden="true" tabindex="-1" href="#run-a-template-query"><a href="#run-a-template-query" style="margin-right: 10px">#</a></a>Run a template query</h2>
<p>From the getTemplates function, if you see a template query that you
want to run, you can use the getTemplateQuery function with it's name,
and run it with the runQuery function</p>
<div class="highlight highlight-r"><pre>getTemplateQuery(<span class="pl-smi">mine</span>,<span class="pl-s"><span class="pl-pds">"</span>TQ_protein_to_gene<span class="pl-pds">"</span></span>) <span class="pl-c"># see what template looks like</span>
<span class="pl-v">template</span><span class="pl-k">=</span>getTemplateQuery(<span class="pl-smi">mine</span>,<span class="pl-s"><span class="pl-pds">"</span>TQ_protein_to_gene<span class="pl-pds">"</span></span>) <span class="pl-c"># save template</span>
runQuery(<span class="pl-smi">mine</span>,<span class="pl-smi">template</span>) <span class="pl-c"># run the template query with default params, receive data.frame</span>
</pre></div>
<p>This method is good, but some improvement could be added to change
default parameters in the template query, etc.</p>
<h2 id="run-query-xml"><a aria-hidden="true" tabindex="-1" href="#run-query-xml"><a href="#run-query-xml" style="margin-right: 10px">#</a></a>Run query XML</h2>
<p>Another option for running queries is to use the query XML that you can
download from the InterMine query result pages.</p>
<div class="highlight highlight-r"><pre><span class="pl-c"># get all Ensembl genes on chr28 from bovinemine</span>
<span class="pl-v">query</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>&#x3C;query model="genomic" view="Gene.primaryIdentifier</span>
<span class="pl-s">Gene.secondaryIdentifier Gene.symbol Gene.name Gene.source</span>
<span class="pl-s">Gene.organism.shortName Gene.chromosome.primaryIdentifier"</span>
<span class="pl-s">sortOrder="Gene.primaryIdentifier ASC" >&#x3C;constraint</span>
<span class="pl-s">path="Gene.organism.shortName" op="=" value="B. taurus"</span>
<span class="pl-s">/>&#x3C;constraint path="Gene.chromosome.primaryIdentifier" op="="</span>
<span class="pl-s">value="GK000028.2" />&#x3C;/query><span class="pl-pds">'</span></span>

<span class="pl-v">results</span><span class="pl-k">=</span>runQuery(<span class="pl-smi">mine</span>, <span class="pl-smi">query</span>)

head(<span class="pl-smi">results</span>)
</pre></div>
<h2 id="conclusion"><a aria-hidden="true" tabindex="-1" href="#conclusion"><a href="#conclusion" style="margin-right: 10px">#</a></a>Conclusion</h2>
<p>The InterMineR package has a couple of nice features for getting
InterMine data with a couple of functions for looking at templates. For
many use cases, copying the Query XML from a InterMine webpage and
pasting that into the runQuery function is sufficient and produces a
data frame that can be analyzed.</p>
<p>PS it is not easy to post XML on tumblr after editing the post in
markdown mode. You have to add the lt and gt shortcuts and even after
that it gets filtered?!</p></div><div style="margin-top:200px"></div></article></div></main></div><footer style="margin-top:100px"><a href="/">Home</a> <a href="/archive">Blog archive</a> <a href="https://github.com/cmdcolin/">Github</a> <a href="https://twitter.com/cmdcolin">Twitter</a> <a href="/projects">Projects</a> <a href="/photos">Photos</a> <a href="/rss.xml">RSS</a><a href="/about">About</a> </footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Querying InterMine databases using R","date":"2016-06-17","slug":"2016-06-17","html":"\u003cp\u003eIn the past, I had found some ways to do simple queries on InterMine web\nservices using basic HTTP commands with R (see\n\u003ca href=\"https://gist.github.com/cmdcolin/4758167bdd89e6c9c055\"\u003ehttps://gist.github.com/cmdcolin/4758167bdd89e6c9c055\u003c/a\u003e)\u003c/p\u003e\n\u003cp\u003eHowever, the InterMineR (\u003ca href=\"https://github.com/intermine/intermineR\"\u003ehttps://github.com/intermine/intermineR\u003c/a\u003e)\npackage automates some of these features and makes it easier to load the\ndata in R.\u003c/p\u003e\n\u003ch2 id=\"installation\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#installation\"\u003e\u003ca href=\"#installation\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eInstallation\u003c/h2\u003e\n\u003cp\u003eOne way to install InterMineR is to install from github with\nhadley/devtools\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-r\"\u003e\u003cpre\u003einstall.packages(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003edevtools\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e)\n\u003cspan class=\"pl-e\"\u003edevtools\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e::\u003c/span\u003einstall_github(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ehadley/devtools\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e)\n\u003cspan class=\"pl-e\"\u003edevtools\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e::\u003c/span\u003einstall_github(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eintermine/intermineR\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e)\n\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"usage\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#usage\"\u003e\u003ca href=\"#usage\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eUsage\u003c/h2\u003e\n\u003cp\u003eBasic usage includes loading the \"intermine URL\" using the initInterMine\nfunction. Then various functions can be called on this result.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-r\"\u003e\u003cpre\u003elibrary(\u003cspan class=\"pl-smi\"\u003eInterMineR\u003c/span\u003e)\n\u003cspan class=\"pl-v\"\u003emine\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003einitInterMine(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ehttp://bovinegenome.org/bovinemine/\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e)\ngetVersion(\u003cspan class=\"pl-smi\"\u003emine\u003c/span\u003e) \u003cspan class=\"pl-c\"\u003e#18, intermine API version\u003c/span\u003e\ngetRelease(\u003cspan class=\"pl-smi\"\u003emine\u003c/span\u003e) \u003cspan class=\"pl-c\"\u003e#1.0, our data release version\u003c/span\u003e\ngetTemplates(\u003cspan class=\"pl-smi\"\u003emine\u003c/span\u003e) \u003cspan class=\"pl-c\"\u003e# lists all templates on interminer\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"run-a-template-query\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#run-a-template-query\"\u003e\u003ca href=\"#run-a-template-query\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eRun a template query\u003c/h2\u003e\n\u003cp\u003eFrom the getTemplates function, if you see a template query that you\nwant to run, you can use the getTemplateQuery function with it's name,\nand run it with the runQuery function\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-r\"\u003e\u003cpre\u003egetTemplateQuery(\u003cspan class=\"pl-smi\"\u003emine\u003c/span\u003e,\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eTQ_protein_to_gene\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e) \u003cspan class=\"pl-c\"\u003e# see what template looks like\u003c/span\u003e\n\u003cspan class=\"pl-v\"\u003etemplate\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003egetTemplateQuery(\u003cspan class=\"pl-smi\"\u003emine\u003c/span\u003e,\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eTQ_protein_to_gene\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e) \u003cspan class=\"pl-c\"\u003e# save template\u003c/span\u003e\nrunQuery(\u003cspan class=\"pl-smi\"\u003emine\u003c/span\u003e,\u003cspan class=\"pl-smi\"\u003etemplate\u003c/span\u003e) \u003cspan class=\"pl-c\"\u003e# run the template query with default params, receive data.frame\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis method is good, but some improvement could be added to change\ndefault parameters in the template query, etc.\u003c/p\u003e\n\u003ch2 id=\"run-query-xml\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#run-query-xml\"\u003e\u003ca href=\"#run-query-xml\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eRun query XML\u003c/h2\u003e\n\u003cp\u003eAnother option for running queries is to use the query XML that you can\ndownload from the InterMine query result pages.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-r\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e# get all Ensembl genes on chr28 from bovinemine\u003c/span\u003e\n\u003cspan class=\"pl-v\"\u003equery\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u0026#x3C;query model=\"genomic\" view=\"Gene.primaryIdentifier\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003eGene.secondaryIdentifier Gene.symbol Gene.name Gene.source\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003eGene.organism.shortName Gene.chromosome.primaryIdentifier\"\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003esortOrder=\"Gene.primaryIdentifier ASC\" \u003e\u0026#x3C;constraint\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003epath=\"Gene.organism.shortName\" op=\"=\" value=\"B. taurus\"\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e/\u003e\u0026#x3C;constraint path=\"Gene.chromosome.primaryIdentifier\" op=\"=\"\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003evalue=\"GK000028.2\" /\u003e\u0026#x3C;/query\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-v\"\u003eresults\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003erunQuery(\u003cspan class=\"pl-smi\"\u003emine\u003c/span\u003e, \u003cspan class=\"pl-smi\"\u003equery\u003c/span\u003e)\n\nhead(\u003cspan class=\"pl-smi\"\u003eresults\u003c/span\u003e)\n\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"conclusion\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#conclusion\"\u003e\u003ca href=\"#conclusion\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eConclusion\u003c/h2\u003e\n\u003cp\u003eThe InterMineR package has a couple of nice features for getting\nInterMine data with a couple of functions for looking at templates. For\nmany use cases, copying the Query XML from a InterMine webpage and\npasting that into the runQuery function is sufficient and produces a\ndata frame that can be analyzed.\u003c/p\u003e\n\u003cp\u003ePS it is not easy to post XML on tumblr after editing the post in\nmarkdown mode. You have to add the lt and gt shortcuts and even after\nthat it gets filtered?!\u003c/p\u003e"}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"2016-06-17"},"buildId":"Yjari4YcqZldNSQarwsr7","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>