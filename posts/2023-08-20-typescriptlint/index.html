<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="description" content="Astro description"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/x-icon" href="/favicon.ico"><meta name="generator" content="Astro v6.0.0-beta.1"><title>~7 eslint rules that will tumble the lint right off your lil sockies</title><style>.container[data-astro-cid-4oxc2zqz]{max-width:800px;margin:0 auto;padding:0 1rem}article[data-astro-cid-lvjzyg5v]{max-width:100%}.post-content[data-astro-cid-lvjzyg5v]{margin:2rem 0;line-height:1.6}
</style>
<link rel="stylesheet" href="/_astro/Layout.Ca4IH_rv.css"></head> <body> <div class="mb-8"> <a href="/">Misc scribbles</a> </div>  <div class="container" data-astro-cid-4oxc2zqz>  <article data-astro-cid-lvjzyg5v> <div data-astro-cid-lvjzyg5v> <h1 data-astro-cid-lvjzyg5v>~7 eslint rules that will tumble the lint right off your lil sockies</h1> <h4 data-astro-cid-lvjzyg5v>2023-08-20</h4> </div> <div class="post-content" data-astro-cid-lvjzyg5v> <p>Do you think of your linter as a piece of crap that makes annoying suggestions
that are best ignored?</p>
<p>Well, after you enable some of these amazing new rules you’ll probably continue
to do so with renewed gusto, but maybe thank it just a lil bit</p>
<p><img src="/cat.jpg" alt=""></p>
<p>Figure 1. Your project manager looks on as you clean up the dust bunnies from
the codebase</p>
<h3 id="typescript-eslintno-unsafe-">@typescript-eslint/no-unsafe-*</h3>
<p>You think your codebase is safe? You got <code>noImplicitAny</code> and you feel cozy in
bed at night?</p>
<p>Then you better wake up! The rumble and tumble of the linter starts off with the
<code>@typescript-eslint/no-unsafe-*</code> rule pack*. These rules will absolutely crush
the usage of type <code>any</code> out of your codebase in a way that no tsconfig.json
setting can.</p>
<p>But what does <code>noImplicitAny</code> even do if not check for usage of any?</p>
<p>Well, the <code>noImplicitAny</code> tsconfig is very limited in scope… it is not
catching all “implied uses of type <code>any</code> in your codebase”; it’s just catching
narrow usages where e.g. you don’t specify the type of a function parameter in
your function definition. Example:</p>
<pre><code class="language-typescript"><a-k>function</a-k> <a-f>foo</a-f><a-p>(</a-p><a-v>param</a-v><a-p>)</a-p> <a-p>{</a-p>
  <a-k>return</a-k> <a-v>param</a-v> <a-o>+</a-o> <a-n>1</a-n>
<a-p>}</a-p>
</code></pre>
<p>That is allowed with noImplicitAny disabled, it just “implicitly sets param to
type <code>any</code>”</p>
<p>The no-unsafe-* rule pack is made of ~5 rules aimed at removing usage of type
<code>any</code>, explicit or implicit in your code</p>
<ul>
<li><a href="https://typescript-eslint.io/rules/no-unsafe-argument"><code>@typescript-eslint/no-unsafe-argument</code></a> -
Disallow calling a function with a value with type <code>any</code></li>
<li><a href="https://typescript-eslint.io/rules/no-unsafe-assignment"><code>@typescript-eslint/no-unsafe-assignment</code></a> -
Disallow assigning a value with type <code>any</code> to variables and properties</li>
<li><a href="https://typescript-eslint.io/rules/no-unsafe-call"><code>@typescript-eslint/no-unsafe-call</code></a> -
Disallow calling a value with type <code>any</code></li>
<li><a href="https://typescript-eslint.io/rules/no-unsafe-member-access"><code>@typescript-eslint/no-unsafe-member-access</code></a> -
Disallow member access on a value with type <code>any</code></li>
<li><a href="https://typescript-eslint.io/rules/no-unsafe-return"><code>@typescript-eslint/no-unsafe-return</code></a> -
Disallow returning a value with type <code>any</code> from a function</li>
</ul>
<p>Fail</p>
<pre><code class="language-typescript"><a-k>function</a-k> <a-f>jsonParse</a-f><a-p>(</a-p><a-v>str</a-v>: <a-t>string</a-t><a-p>)</a-p> <a-p>{</a-p>
  <a-c>// @typescript-eslint/no-unsafe-assignment balks because JSON.parse returns type any</a-c>
  <a-k>const</a-k> <a-v>x</a-v> <a-o>=</a-o> <a-t>JSON</a-t><a-p>.</a-p><a-f>parse</a-f><a-p>(</a-p><a-v>str</a-v><a-p>)</a-p>
<a-p>}</a-p>
</code></pre>
<p>Pass</p>
<pre><code class="language-typescript"><a-k>function</a-k> <a-f>jsonParse</a-f><a-p>(</a-p><a-v>str</a-v>: <a-t>string</a-t><a-p>)</a-p> <a-p>{</a-p>
  <a-k>const</a-k> <a-v>x</a-v> <a-o>=</a-o> <a-t>JSON</a-t><a-p>.</a-p><a-f>parse</a-f><a-p>(</a-p><a-v>str</a-v><a-p>)</a-p> <a-k>as</a-k> <a-p>{</a-p> <a-pr>a</a-pr>: <a-t>number</a-t><a-p>;</a-p> <a-pr>b</a-pr>: <a-t>number</a-t> <a-p>}</a-p>
<a-p>}</a-p>
</code></pre>
<p>Whether it’s truly better to use the <code>as</code> casts is up to you, but it may be
better than insidious type <code>any</code> flowing through your type system!</p>
<p>Note 1: The no-unsafe rule set is part of the “types required”
<code>@typescript-eslint/recommended-type-checked</code> rule set which is separate from
<code>@typescript-eslint/recommended</code>!</p>
<p>Note 2: These rules might be difficult to enable because your code has been such
a bad mess for so long that you will have to incrementally work towards
enabling, if it even is possible at this point (smdh)</p>
<h3 id="typescript-eslintno-explicit-any">@typescript-eslint/no-explicit-any</h3>
<p>Link:
<a href="https://github.com/typescript-eslint/typescript-eslint/blob/main/packages/eslint-plugin/docs/rules/no-explicit-any.md">https://github.com/typescript-eslint/typescript-eslint/blob/main/packages/eslint-plugin/docs/rules/no-explicit-any.md</a></p>
<p>This rule is a true typescript classic if I do say so myself</p>
<p>If you ever explicitly write the type <code>any</code>, you have to additionally,
SHAEMFULLY, write out
<code>// eslint-disable-next-line @typescript-eslint/no-explicit-any</code> to allow it to
continue living on living as a line of code in your codebase. I happen to have
done this many times.</p>
<p>Fail</p>
<pre><code class="language-typescript"><a-k>function</a-k> <a-f>x</a-f><a-p>(</a-p><a-v>param</a-v>: <a-t>any</a-t><a-p>)</a-p> <a-p>{</a-p>
  <a-k>return</a-k> <a-v>param</a-v> <a-o>+</a-o> <a-n>1</a-n>
<a-p>}</a-p>
</code></pre>
<p>Pass</p>
<pre><code class="language-typescript"><a-c>// big muscle emoji energy, just disable the wimpy error</a-c>
<a-c>// eslint-disable-next-line @typescript-eslint/no-explicit-any</a-c>
<a-k>function</a-k> <a-f>x</a-f><a-p>(</a-p><a-v>param</a-v>: <a-t>any</a-t><a-p>)</a-p> <a-p>{</a-p>
  <a-k>return</a-k> <a-v>param</a-v> <a-o>+</a-o> <a-n>1</a-n>
<a-p>}</a-p>
</code></pre>
<h3 id="typescript-eslintno-floating-promises">@typescript-eslint/no-floating-promises</h3>
<p>Link:
<a href="https://github.com/typescript-eslint/typescript-eslint/blob/main/packages/eslint-plugin/docs/rules/no-floating-promises.md">https://github.com/typescript-eslint/typescript-eslint/blob/main/packages/eslint-plugin/docs/rules/no-floating-promises.md</a></p>
<p>Do you ever look in your web console and see a “Uncaught (in promise)” error? Do
you sheepishly blush, knowing your code is a terrible amalgamation of chaos?
Well you SHOULD.</p>
<p>But a shining light could come to you from this lint rule…you can turn on
<code>@typescript-eslint/no-floating-promises</code> and it will actually alert you when
you forget to handle a promise</p>
<p>Fail</p>
<pre><code class="language-typescript"><a-k>function</a-k> <a-f>getSomeStuff</a-f><a-p>()</a-p> <a-p>{</a-p>
  <a-c>// Uncaught (in promise) error if fails to fetch</a-c>
  <a-f>fetch</a-f><a-p>(</a-p><a-s>'http://google.com'</a-s><a-p>)</a-p>
<a-p>}</a-p>
</code></pre>
<p>Pass</p>
<pre><code class="language-typescript"><a-k>async</a-k> <a-k>function</a-k> <a-f>getSomeStuff</a-f><a-p>()</a-p> <a-p>{</a-p>
  <a-c>// properly awaited</a-c>
  <a-k>const</a-k> <a-v>result</a-v> <a-o>=</a-o> <a-k>await</a-k> <a-f>fetch</a-f><a-p>(</a-p><a-s>'http://google.com'</a-s><a-p>)</a-p>
<a-p>}</a-p>
</code></pre>
<p>Note 1: this issue happens more than you might think. It is a ‘types required’
rule and part of the recommended-type-checked pack, but even if you don’t enable
the full recommended-type-checked pack, I highly recommend enabling it. It could
have been my number one in the list.</p>
<p>Note 2: If you have an async “IIFE” (immediately invoked function expression),
you may have to explicitly disable this warning. This is common in useEffect in
React for example. But be aware, by ignoring the error you should have full
error handling built into your IIFE (see Footnote 3)</p>
<p>Note 3: there is also apparently a code-themed darkwave band that named
themselves “Uncaught (in promise)”. Enjoy
<a href="https://uncaughtinpromise.bandcamp.com/track/hamilton-leliumoj">https://uncaughtinpromise.bandcamp.com/track/hamilton-leliumoj</a></p>
<h3 id="unicornprefer-set-has">unicorn/prefer-set-has</h3>
<p>Link:
<a href="https://github.com/sindresorhus/eslint-plugin-unicorn/blob/main/docs/rules/prefer-set-has.md">https://github.com/sindresorhus/eslint-plugin-unicorn/blob/main/docs/rules/prefer-set-has.md</a></p>
<p>Coming to us from the land of eslint-plugin-unicorn, we have a rule that could
save you from making
<a href="https://accidentallyquadratic.tumblr.com/">accidentally quadratic</a> code</p>
<p>Fail</p>
<pre><code class="language-typescript"><a-k>const</a-k> <a-v>arr1</a-v> <a-o>=</a-o> <a-p>[</a-p><a-n>1</a-n><a-p>,</a-p> <a-n>2</a-n><a-p>,</a-p> <a-n>3</a-n><a-p>]</a-p>
<a-k>const</a-k> <a-v>arr2</a-v> <a-o>=</a-o> <a-p>[</a-p><a-n>4</a-n><a-p>,</a-p> <a-n>5</a-n><a-p>,</a-p> <a-n>6</a-n><a-p>]</a-p>
<a-k>for</a-k> <a-p>(</a-p><a-k>let</a-k> <a-v>i</a-v> <a-o>=</a-o> <a-n>0</a-n><a-p>;</a-p> <a-v>i</a-v> <a-o>&#x3C;</a-o> <a-v>arr1</a-v><a-p>.</a-p><a-pr>length</a-pr><a-p>;</a-p> <a-v>i</a-v><a-o>++</a-o><a-p>)</a-p> <a-p>{</a-p>
  <a-c>// bad: includes is linear inside already linear loop</a-c>
  <a-k>if</a-k> <a-p>(</a-p><a-v>arr2</a-v><a-p>.</a-p><a-f>includes</a-f><a-p>(</a-p><a-v>arr1</a-v><a-p>[</a-p><a-v>i</a-v><a-p>]))</a-p> <a-p>{</a-p>
    <a-f>alert</a-f><a-p>(</a-p><a-s>'Found an element in arr1 that matches arr2'</a-s><a-p>)</a-p>
  <a-p>}</a-p>
<a-p>}</a-p>
</code></pre>
<p>Pass (autofixed from above!)</p>
<pre><code class="language-typescript"><a-k>const</a-k> <a-v>arr1</a-v> <a-o>=</a-o> <a-p>[</a-p><a-n>1</a-n><a-p>,</a-p> <a-n>2</a-n><a-p>,</a-p> <a-n>3</a-n><a-p>]</a-p>
<a-k>const</a-k> <a-v>arr2</a-v> <a-o>=</a-o> <a-k>new</a-k> <a-t>Set</a-t><a-p>([</a-p><a-n>4</a-n><a-p>,</a-p> <a-n>5</a-n><a-p>,</a-p> <a-n>6</a-n><a-p>])</a-p>
<a-k>for</a-k> <a-p>(</a-p><a-k>let</a-k> <a-v>i</a-v> <a-o>=</a-o> <a-n>0</a-n><a-p>;</a-p> <a-v>i</a-v> <a-o>&#x3C;</a-o> <a-v>arr1</a-v><a-p>.</a-p><a-pr>length</a-pr><a-p>;</a-p> <a-v>i</a-v><a-o>++</a-o><a-p>)</a-p> <a-p>{</a-p>
  <a-c>// good: fast set based membership :+1:</a-c>
  <a-k>if</a-k> <a-p>(</a-p><a-v>arr2</a-v><a-p>.</a-p><a-f>has</a-f><a-p>(</a-p><a-v>arr1</a-v><a-p>[</a-p><a-v>i</a-v><a-p>]))</a-p> <a-p>{</a-p>
    <a-f>alert</a-f><a-p>(</a-p><a-s>'Found an element in arr1 that matches arr2'</a-s><a-p>)</a-p>
  <a-p>}</a-p>
<a-p>}</a-p>
</code></pre>
<p>Most usages of javascript don’t handle big enough datasets for this to matter,
but that’s what many accidentally quadratic authors think…before their code
blows up</p>
<h3 id="curly">curly</h3>
<p>Link: <a href="https://eslint.org/docs/latest/rules/curly">https://eslint.org/docs/latest/rules/curly</a></p>
<p>Coming to us from the land of ancient built-in eslint rules, this is one of the
few “stylistic” rules I like eslint performing, because prettier won’t do it</p>
<p>Fail</p>
<pre><code class="language-typescript"><a-k>if</a-k> <a-p>(</a-p><a-v>test</a-v><a-p>)</a-p> <a-v>console</a-v><a-p>.</a-p><a-f>log</a-f><a-p>(</a-p><a-s>'do thing'</a-s><a-p>)</a-p>
</code></pre>
<p>Pass (autofixed from above!)</p>
<pre><code class="language-typescript"><a-k>if</a-k> <a-p>(</a-p><a-v>test</a-v><a-p>)</a-p> <a-p>{</a-p>
  <a-v>console</a-v><a-p>.</a-p><a-f>log</a-f><a-p>(</a-p><a-s>'do thing'</a-s><a-p>)</a-p>
<a-p>}</a-p>
</code></pre>
<p>Discussion about prettier and curlies
<a href="https://github.com/prettier/prettier/issues/7659">https://github.com/prettier/prettier/issues/7659</a></p>
<p>Note: I know, I know, we all want that
<a href="https://en.wikipedia.org/wiki/Indentation_style">OG Horstmann style indentation</a>,
but we can’t have nice things</p>
<h3 id="unicornno-array-for-each-and-typescript-eslintprefer-for-of">unicorn/no-array-for-each (and @typescript-eslint/prefer-for-of)</h3>
<p>Link 1:
<a href="https://github.com/sindresorhus/eslint-plugin-unicorn/blob/main/docs/rules/no-array-for-each.md">https://github.com/sindresorhus/eslint-plugin-unicorn/blob/main/docs/rules/no-array-for-each.md</a></p>
<p>Like 2: see also <a href="https://typescript-eslint.io/rules/prefer-for-of/">https://typescript-eslint.io/rules/prefer-for-of/</a></p>
<p>This is perhaps a controversial one, but this rule bans use of
Array.prototype.forEach and calls JS programmers back ‘round to the fire of the
for loop. Specifically: the for-of loop</p>
<p>The callback based forEach dominated the jquery era, but the for-of loop is
pretty easy to write, and can be auto-fixed by this eslint rule, and as a bonus,
is sometimes a non-trivial-amount-faster</p>
<p>Fail</p>
<pre><code class="language-typescript"><a-v>array</a-v><a-p>.</a-p><a-f>forEach</a-f><a-p>(</a-p><a-v>elt</a-v> <a-o>=></a-o> <a-v>console</a-v><a-p>.</a-p><a-f>log</a-f><a-p>(</a-p><a-v>elt</a-v><a-p>))</a-p>
</code></pre>
<p>Pass</p>
<pre><code class="language-typescript"><a-k>for</a-k> <a-p>(</a-p><a-k>const</a-k> <a-v>elt</a-v> <a-k>of</a-k> <a-v>array</a-v><a-p>)</a-p> <a-p>{</a-p>
  <a-v>console</a-v><a-p>.</a-p><a-f>log</a-f><a-p>(</a-p><a-v>elt</a-v><a-p>)</a-p>
<a-p>}</a-p>
</code></pre>
<p>There is also an explanation at the rule link
(<a href="https://github.com/sindresorhus/eslint-plugin-unicorn/blob/main/docs/rules/no-array-for-each.md">https://github.com/sindresorhus/eslint-plugin-unicorn/blob/main/docs/rules/no-array-for-each.md</a>)
that there is improved “type narrowing” and better detection of unused variables
with the for-loop for typescript users.</p>
<h3 id="typescript-eslintprefer-ts-expect-error">@typescript-eslint/prefer-ts-expect-error</h3>
<p>Link: <a href="https://typescript-eslint.io/rules/prefer-ts-expect-error/">https://typescript-eslint.io/rules/prefer-ts-expect-error/</a></p>
<p>This is one for you machete wielding hackers of the javascript jungle who add,
despite the best of your intentions, one or more ill-advised <code>// @ts-ignore</code>
statements to their code.</p>
<p>Change those to <code>// @ts-expect-error</code> statements! It’s not much better, but you
can feel slightly cozier in that bed of yours. The wilderness of your javascript
jungle might one day change, causing that comment to one day be unneeded.</p>
<p>Fail</p>
<pre><code class="language-typescript"><a-c>// ts-ignore</a-c>
<a-f>doSomethingReallyDumb</a-f><a-p>()</a-p>
</code></pre>
<p>Pass</p>
<pre><code class="language-typescript"><a-c>// ts-expect-error</a-c>
<a-f>doSomethingReallyDumb</a-f><a-p>()</a-p> <a-c>// cool we're ok now</a-c>
</code></pre>
<h2 id="conclusion">Conclusion?</h2>
<p>There are many cool eslint rules. I think turning on the
<code>@typescript-eslint/recommended-type-checked</code> rule set is important to try out.
Try out the unicorn/recommended set also, and let me know if you have any other
favorites</p>
<h3 id="footnote-1-lint-your-lint">Footnote 1. Lint your lint</h3>
<p>Run your eslint with —report-unused-disable-directives —max-warnings 0. Don’t
accept warnings, and auto-remove unused eslint disables!</p>
<h3 id="footnote-2-in-older-typescript-eslint-versions">Footnote 2. In older @typescript-eslint versions</h3>
<p>The <code>@typescript-eslint/recommended-type-checked</code> is called
<code>@typescript-eslint/recommended-requiring-type-checking</code> in older versions</p>
<h3 id="footnote-3-example-of-the-full-error-handling-in-iife">Footnote 3. Example of the “full error handling” in IIFE</h3>
<pre><code class="language-typescript"><a-k>const</a-k> <a-p>[</a-p><a-v>data</a-v><a-p>,</a-p> <a-v>setData</a-v><a-p>]</a-p> <a-o>=</a-o> <a-f>useState</a-f><a-p>&#x3C;</a-p><a-t>MyData</a-t><a-p>>()</a-p>
<a-k>const</a-k> <a-p>[</a-p><a-v>data</a-v><a-p>,</a-p> <a-v>setError</a-v><a-p>]</a-p> <a-o>=</a-o> <a-f>useState</a-f><a-p>&#x3C;</a-p><a-t>unknown</a-t><a-p>>()</a-p>
<a-f>useEffect</a-f><a-p>(()</a-p> <a-o>=></a-o> <a-p>{</a-p>
  <a-c>// gotta ignore the warning in this case</a-c>
  <a-c>// eslint-disable-next-line @typescript-eslint/no-floating-promises</a-c>
  <a-p>;(</a-p><a-k>async</a-k> <a-p>()</a-p> <a-o>=></a-o> <a-p>{</a-p>
    <a-c>// do full try/catch error handling in here because the "buck stops here"</a-c>
    <a-c>// as far as the promise is concerned</a-c>
    <a-k>try</a-k> <a-p>{</a-p>
      <a-k>const</a-k> <a-v>response</a-v> <a-o>=</a-o> <a-k>await</a-k> <a-f>fetch</a-f><a-p>(</a-p><a-s>'http://google.com'</a-s><a-p>)</a-p>
      <a-k>if</a-k> <a-p>(</a-p><a-o>!</a-o><a-v>response</a-v><a-p>.</a-p><a-pr>ok</a-pr><a-p>)</a-p> <a-p>{</a-p>
        <a-k>throw</a-k> <a-k>new</a-k> <a-t>Error</a-t><a-p>(</a-p><a-s>`HTTP </a-s><a-p>${</a-p><a-v>response</a-v><a-p>.</a-p><a-pr>status</a-pr><a-p>}</a-p><a-s> </a-s><a-p>${</a-p><a-k>await</a-k><a-eb> </a-eb><a-v>response</a-v><a-p>.</a-p><a-f>text</a-f><a-p>()}</a-p><a-s>`</a-s><a-p>)</a-p>
      <a-p>}</a-p>
      <a-k>const</a-k> <a-v>result</a-v> <a-o>=</a-o> <a-k>await</a-k> <a-v>response</a-v><a-p>.</a-p><a-f>json</a-f><a-p>()</a-p>
      <a-f>setData</a-f><a-p>(</a-p><a-v>result</a-v><a-p>)</a-p>
    <a-p>}</a-p> <a-k>catch</a-k> <a-p>(</a-p><a-v>e</a-v><a-p>)</a-p> <a-p>{</a-p>
      <a-f>setError</a-f><a-p>(</a-p><a-v>e</a-v><a-p>)</a-p>
    <a-p>}</a-p>
  <a-p>})()</a-p>
<a-p>},</a-p> <a-p>[])</a-p>
</code></pre>
<p>alternatively, without the disable, you can add a catch handler</p>
<pre><code class="language-typescript"><a-k>const</a-k> <a-p>[</a-p><a-v>data</a-v><a-p>,</a-p> <a-v>setData</a-v><a-p>]</a-p> <a-o>=</a-o> <a-f>useState</a-f><a-p>&#x3C;</a-p><a-t>MyData</a-t><a-p>>()</a-p>
<a-k>const</a-k> <a-p>[</a-p><a-v>data</a-v><a-p>,</a-p> <a-v>setError</a-v><a-p>]</a-p> <a-o>=</a-o> <a-f>useState</a-f><a-p>&#x3C;</a-p><a-t>unknown</a-t><a-p>>()</a-p>
<a-f>useEffect</a-f><a-p>(()</a-p> <a-o>=></a-o> <a-p>{</a-p>
  <a-p>;(</a-p><a-k>async</a-k> <a-p>()</a-p> <a-o>=></a-o> <a-p>{</a-p>
    <a-k>const</a-k> <a-v>response</a-v> <a-o>=</a-o> <a-k>await</a-k> <a-f>fetch</a-f><a-p>(</a-p><a-s>'http://google.com'</a-s><a-p>)</a-p>
    <a-k>if</a-k> <a-p>(</a-p><a-o>!</a-o><a-v>response</a-v><a-p>.</a-p><a-pr>ok</a-pr><a-p>)</a-p> <a-p>{</a-p>
      <a-k>throw</a-k> <a-k>new</a-k> <a-t>Error</a-t><a-p>(</a-p><a-s>`HTTP </a-s><a-p>${</a-p><a-v>response</a-v><a-p>.</a-p><a-pr>status</a-pr><a-p>}</a-p><a-s> </a-s><a-p>${</a-p><a-k>await</a-k><a-eb> </a-eb><a-v>response</a-v><a-p>.</a-p><a-f>text</a-f><a-p>()}</a-p><a-s>`</a-s><a-p>)</a-p>
    <a-p>}</a-p>
    <a-k>const</a-k> <a-v>result</a-v> <a-o>=</a-o> <a-k>await</a-k> <a-v>response</a-v><a-p>.</a-p><a-f>json</a-f><a-p>()</a-p>
    <a-f>setData</a-f><a-p>(</a-p><a-v>result</a-v><a-p>)</a-p>
  <a-p>})().</a-p><a-f>catch</a-f><a-p>(</a-p><a-v>e</a-v> <a-o>=></a-o> <a-f>setError</a-f><a-p>(</a-p><a-v>e</a-v><a-p>))</a-p>
<a-p>},</a-p> <a-p>[])</a-p>
</code></pre>
<h3 id="footnote-4-example-of-the-type-narrowing">Footnote 4. Example of the type narrowing</h3>
<pre><code class="language-typescript"><a-k>export</a-k> <a-k>function</a-k> <a-f>typeNarrowingForLoop</a-f><a-p>()</a-p> <a-p>{</a-p>
  <a-k>let</a-k> <a-v>x</a-v>
  <a-k>const</a-k> <a-v>arr</a-v> <a-o>=</a-o> <a-p>[</a-p><a-n>1</a-n><a-p>,</a-p> <a-n>2</a-n><a-p>,</a-p> <a-n>3</a-n><a-p>]</a-p>
  <a-k>for</a-k> <a-p>(</a-p><a-k>const</a-k> <a-v>elt</a-v> <a-k>of</a-k> <a-v>arr</a-v><a-p>)</a-p> <a-p>{</a-p>
    <a-v>x</a-v> <a-o>=</a-o> <a-v>elt</a-v>
  <a-p>}</a-p>
  <a-k>return</a-k> <a-v>x</a-v> <a-c>// some type inference took place from usage inside for loop, type is number|undefined</a-c>
<a-p>}</a-p>

<a-k>export</a-k> <a-k>function</a-k> <a-f>nonTypeNarrowingForEach</a-f><a-p>()</a-p> <a-p>{</a-p>
  <a-k>let</a-k> <a-v>x</a-v>
  <a-k>const</a-k> <a-v>arr</a-v> <a-o>=</a-o> <a-p>[</a-p><a-n>1</a-n><a-p>,</a-p> <a-n>2</a-n><a-p>,</a-p> <a-n>3</a-n><a-p>]</a-p>
  <a-v>arr</a-v><a-p>.</a-p><a-f>forEach</a-f><a-p>(</a-p><a-v>elt</a-v> <a-o>=></a-o> <a-p>{</a-p>
    <a-v>x</a-v> <a-o>=</a-o> <a-v>elt</a-v>
  <a-p>})</a-p>
  <a-k>return</a-k> <a-v>x</a-v> <a-c>// no type inference took place from the forEach, type is undefined</a-c>
<a-p>}</a-p>
</code></pre> </div> <div id="giscus"></div> <script>
  const script = document.createElement('script');
  script.src = 'https://giscus.app/client.js';
  script.setAttribute('data-repo', 'cmdcolin/cmdcolin.github.io');
  script.setAttribute('data-repo-id', 'MDEwOlJlcG9zaXRvcnkyNjE0OTY3Nw==');
  script.setAttribute('data-category', 'General');
  script.setAttribute('data-category-id', 'DIC_kwDOAY8DLc4CO-L9');
  script.setAttribute('data-mapping', 'pathname');
  script.setAttribute('data-strict', '0');
  script.setAttribute('data-reactions-enabled', '1');
  script.setAttribute('data-emit-metadata', '0');
  script.setAttribute('data-input-position', 'bottom');
  script.setAttribute('data-theme', 'light');
  script.setAttribute('data-lang', 'en');
  script.setAttribute('crossorigin', 'anonymous');
  script.async = true;
  document.getElementById('giscus').appendChild(script);
</script> </article>  </div>   <footer class="footer-style" data-astro-cid-k2f5zb5c> <a class="footer-link" href="/" data-astro-cid-k2f5zb5c>Home</a> <a class="footer-link" href="/archive" data-astro-cid-k2f5zb5c>Blog archive</a> <a class="footer-link" href="https://github.com/cmdcolin/" data-astro-cid-k2f5zb5c>Github</a> <a class="footer-link" href="/projects" data-astro-cid-k2f5zb5c>Projects</a> <a class="footer-link" href="/about" data-astro-cid-k2f5zb5c>About</a> </footer> </body></html> 