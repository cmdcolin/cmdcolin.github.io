<!DOCTYPE html><html lang="en"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>You may not need a bundler for your NPM library</title><meta name="next-head-count" content="3"/><link rel="shortcut icon" href="favicon.ico"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><meta name="description" content="Blogging for the future"/><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/prism.min.js" integrity="sha512-hpZ5pDCF2bRCweL5WoA0/N1elet1KYL5mx3LP555Eg/0ZguaHawxNvEjF6O3rufAChs16HVNhEc6blF/rZoowQ==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="preload" href="/_next/static/css/0e13ae09fdc48bba.css" as="style"/><link rel="stylesheet" href="/_next/static/css/0e13ae09fdc48bba.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-01f10f588aa1f712.js" defer=""></script><script src="/_next/static/chunks/framework-a87821de553db91d.js" defer=""></script><script src="/_next/static/chunks/main-896947e153b7d53e.js" defer=""></script><script src="/_next/static/chunks/pages/_app-d6e6a35eb3960502.js" defer=""></script><script src="/_next/static/chunks/996-9e3c12b77542c098.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-9a0bc1852a8bf540.js" defer=""></script><script src="/_next/static/wNbQTlm53oWhGcEQSmk8L/_buildManifest.js" defer=""></script><script src="/_next/static/wNbQTlm53oWhGcEQSmk8L/_ssgManifest.js" defer=""></script><script src="/_next/static/wNbQTlm53oWhGcEQSmk8L/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><div><main><div><div style="margin-bottom:100px"><a href="/">Misc scribbles</a></div><article><div><h1>You may not need a bundler for your NPM library</h1><h4>2022-05-15</h4></div><p>Very often on twitter, people complain about the difficulty with publishing NPM
libraries or ask what &quot;starter kit&quot; they should use (or otherwise get
recommended starter packs by people trying to make it easier for them)</p>
<!-- --><p>Example threads</p>
<!-- --><ul>
<!-- --><li>https://twitter.com/cramforce/status/1513903035197526017</li>
<!-- --><li>https://twitter.com/oleg008/status/1510006191296061441</li>
<!-- --><li>https://twitter.com/iansu/status/1524860613943382017</li>
<!-- --><li>https://twitter.com/mpocock1/status/1525075901905522691</li>
<!-- --></ul>
<!-- --><p>I&#x27;m not trying to criticize the posters in these threads, but one thing that is
notable to me in these threads is that people often recommend that you use a
bundler, e.g. a program that combines the multiple files of your codebase, when
developing a library</p>
<!-- --><p>Examples of programs suggested in these threads that use bundlers</p>
<!-- --><ul>
<!-- --><li><code>microbundle</code> - https://github.com/developit/microbundle (uses rollup)<!-- --></li>
<!-- --><li><code>esno</code> - https://www.npmjs.com/package/esno (uses esbuild)<!-- --></li>
<!-- --><li><code>unbuild</code> - https://github.com/unjs/unbuild (uses rollup)<!-- --></li>
<!-- --><li><code>preconstruct</code> - https://github.com/preconstruct/preconstruct (uses rollup)<!-- --></li>
<!-- --><li><code>tsup</code> - https://github.com/egoist/tsup (uses esbuild)<!-- --></li>
<!-- --><li><code>tsdx</code> - https://github.com/jaredpalmer/tsdx (uses rollup)<!-- --></li>
<!-- --><li><code>vite library mode</code> - https://vitejs.dev/guide/build.html#library-mode<!-- --></li>
<!-- --><li><code>packemon</code> - https://github.com/milesj/packemon (uses rollup)<!-- --></li>
<!-- --><li><code>ts-library-template</code> - https://github.com/shortercode/ts-library-template (uses rollup)<!-- --></li>
<!-- --><li><code>parcel</code> - https://twitter.com/devongovett/status/1524944991402999810 (uses parcel)<!-- --></li>
<!-- --><li><code>dts</code> - https://weiran-zsd.github.io/dts-cli/<!-- --></li>
<!-- --></ul>
<!-- --><p>Not using bundlers</p>
<!-- --><ul>
<!-- --><li><code>gts</code> - https://github.com/google/gts<!-- --></li>
<!-- --><li><code>ts-react-toolbox</code> - https://github.com/zzarcon/ts-react-toolbox/<!-- --></li>
<!-- --></ul>
<!-- --><p>Other things people recommend</p>
<!-- --><ul>
<!-- --><li><code>deno</code> - not clear to me how this helps when deploying to npm<!-- --></li>
<!-- --><li><code>ts-node </code> - not clear to me how this helps when deploying to npm<!-- --></li>
<!-- --><li><code>nx</code> - heavy monorepo-based solution<!-- --></li>
<!-- --><li><code>elm</code> - that&#x27;s just a different thing<!-- --></li>
<!-- --><li><code>Typescript-Node-Starter</code> - https://github.com/microsoft/TypeScript-Node-Starter (not a library, full stack framework)<!-- --></li>
<!-- --><li><code>joystick</code> - https://github.com/CheatCode/joystick (not a library, full stack framework)<!-- --></li>
<!-- --></ul>
<!-- --><h2>My solution</h2>
<!-- --><p>To me, you do not need a bundler. If you are using typescript, at this stage in time, you should deploy js files to NPM though. In which case, you can run <!-- --><code>tsc</code> over your library code, and just deploy the folder of outputted files to NPM<!-- --></p>
<!-- --><p>Example</p>
<!-- --><p>package.json:</p>
<!-- --><pre><code class="language-json">{
  &quot;scripts&quot;: {
    &quot;build&quot;: &quot;tsc&quot;
  },
  &quot;files&quot;: [&quot;dist&quot;]
}
</code></pre>
<!-- --><h2>What about testing?</h2>
<!-- --><p>Performing testing is not immediately solved by the above</p>
<!-- --><p>Some options you have</p>
<!-- --><ul>
<!-- --><li>Use <!-- --><code>ts-jest</code></li>
<!-- --><li>Use <!-- --><code>jest</code> on it&#x27;s own, plus a <!-- --><code>babel</code> config with <!-- --><code>@babel/preset-typescript</code></li>
<!-- --><li>Use <!-- --><code>jest</code> on it&#x27;s own, run over the compiled output without a <!-- --><code>babel</code> config<!-- --></li>
<!-- --><li>Use <!-- --><code>vitest</code></li>
<!-- --><li>Possibly something else?</li>
<!-- --></ul>
<!-- --><h2>Caveats</h2>
<!-- --><p>If you really care about producing a UMD bundle that can be used in a script
tag, maybe you want a bundler, but the future does not seem to lie here. Even
the idea of a single file ESM module is, at best, a bit hazy: for example, are
you bundling your dependencies or not?</p>
<!-- --><ul>
<!-- --><li>If you are not bundling dependencies, then what is the benefit of using a
bundler anyways?</li>
<!-- --><li>If you are bundling dependencies, you are not allowing people to get updates
to the subdenpendencies with semver!</li>
<!-- --></ul>
<!-- --><h2>Conclusion</h2>
<!-- --><p>You may not need a bundler or a starter kit when developing NPM libraries.</p>
<!-- --><p>It is tempting to have a nice zero-config solutions and starter kits, but you
will benefit from understanding your tools: specifically, using <!-- --><code>tsc</code> by
itself. The starter kits may not be maintained for perpetuity. Our team used
<!-- --><code>tsdx</code> for some time, but it was not maintained well, and used old typescript
version 3.x, and it ended up being hard to remove from our codebase.<!-- --></p>
<!-- --><p>Similar things happen if you take on dependencies like <!-- --><code>create-react-app</code>. You
become very committed to their particular way of doing things, and can only
modify their config with things like <!-- --><code>rescripts</code>, <!-- --><code>craco</code> or <!-- --><code>rewired</code>. If you
crafted your setup with just <!-- --><code>webpack</code>, you may not be so tied down.<!-- --></p>
<!-- --><p>There is a nice speed to these starter kits, but I do think it is valuable to
learn your tools</p><div style="margin-top:200px"><giscus-widget id="comments" repo="cmdcolin/cmdcolin.github.io" repoid="MDEwOlJlcG9zaXRvcnkyNjE0OTY3Nw==" category="General" categoryid="DIC_kwDOAY8DLc4CO-L9" mapping="pathname" term="Welcome to @giscus/react component!" reactionsenabled="1" emitmetadata="0" inputposition="top" lang="en" loading="lazy"></giscus-widget></div></article></div></main></div><footer style="margin-top:100px"><a href="/">Home</a> <!-- --><a href="/archive">Blog archive</a> <!-- --><a href="https://github.com/cmdcolin/">Github</a> <!-- --><a href="https://twitter.com/cmdcolin">Twitter</a> <!-- --><a href="/projects">Projects</a> <!-- --><a href="/photos">Photos</a> <!-- --><a href="/rss.xml">RSS</a><a href="/about">About</a> <!-- --></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"You may not need a bundler for your NPM library","date":"2022-05-15","slug":"2022-05-27-youmaynotneedabundler","mdxSource":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, {})\n  })) : _createMdxContent();\n  function _createMdxContent() {\n    const _components = Object.assign({\n      p: \"p\",\n      ul: \"ul\",\n      li: \"li\",\n      code: \"code\",\n      h2: \"h2\",\n      pre: \"pre\"\n    }, _provideComponents(), props.components);\n    return _jsxs(_Fragment, {\n      children: [_jsx(_components.p, {\n        children: \"Very often on twitter, people complain about the difficulty with publishing NPM\\nlibraries or ask what \\\"starter kit\\\" they should use (or otherwise get\\nrecommended starter packs by people trying to make it easier for them)\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"Example threads\"\n      }), \"\\n\", _jsxs(_components.ul, {\n        children: [\"\\n\", _jsx(_components.li, {\n          children: \"https://twitter.com/cramforce/status/1513903035197526017\"\n        }), \"\\n\", _jsx(_components.li, {\n          children: \"https://twitter.com/oleg008/status/1510006191296061441\"\n        }), \"\\n\", _jsx(_components.li, {\n          children: \"https://twitter.com/iansu/status/1524860613943382017\"\n        }), \"\\n\", _jsx(_components.li, {\n          children: \"https://twitter.com/mpocock1/status/1525075901905522691\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"I'm not trying to criticize the posters in these threads, but one thing that is\\nnotable to me in these threads is that people often recommend that you use a\\nbundler, e.g. a program that combines the multiple files of your codebase, when\\ndeveloping a library\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"Examples of programs suggested in these threads that use bundlers\"\n      }), \"\\n\", _jsxs(_components.ul, {\n        children: [\"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.code, {\n            children: \"microbundle\"\n          }), \" - https://github.com/developit/microbundle (uses rollup)\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.code, {\n            children: \"esno\"\n          }), \" - https://www.npmjs.com/package/esno (uses esbuild)\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.code, {\n            children: \"unbuild\"\n          }), \" - https://github.com/unjs/unbuild (uses rollup)\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.code, {\n            children: \"preconstruct\"\n          }), \" - https://github.com/preconstruct/preconstruct (uses rollup)\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.code, {\n            children: \"tsup\"\n          }), \" - https://github.com/egoist/tsup (uses esbuild)\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.code, {\n            children: \"tsdx\"\n          }), \" - https://github.com/jaredpalmer/tsdx (uses rollup)\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.code, {\n            children: \"vite library mode\"\n          }), \" - https://vitejs.dev/guide/build.html#library-mode\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.code, {\n            children: \"packemon\"\n          }), \" - https://github.com/milesj/packemon (uses rollup)\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.code, {\n            children: \"ts-library-template\"\n          }), \" - https://github.com/shortercode/ts-library-template (uses rollup)\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.code, {\n            children: \"parcel\"\n          }), \" - https://twitter.com/devongovett/status/1524944991402999810 (uses parcel)\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.code, {\n            children: \"dts\"\n          }), \" - https://weiran-zsd.github.io/dts-cli/\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"Not using bundlers\"\n      }), \"\\n\", _jsxs(_components.ul, {\n        children: [\"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.code, {\n            children: \"gts\"\n          }), \" - https://github.com/google/gts\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.code, {\n            children: \"ts-react-toolbox\"\n          }), \" - https://github.com/zzarcon/ts-react-toolbox/\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"Other things people recommend\"\n      }), \"\\n\", _jsxs(_components.ul, {\n        children: [\"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.code, {\n            children: \"deno\"\n          }), \" - not clear to me how this helps when deploying to npm\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.code, {\n            children: \"ts-node \"\n          }), \" - not clear to me how this helps when deploying to npm\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.code, {\n            children: \"nx\"\n          }), \" - heavy monorepo-based solution\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.code, {\n            children: \"elm\"\n          }), \" - that's just a different thing\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.code, {\n            children: \"Typescript-Node-Starter\"\n          }), \" - https://github.com/microsoft/TypeScript-Node-Starter (not a library, full stack framework)\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.code, {\n            children: \"joystick\"\n          }), \" - https://github.com/CheatCode/joystick (not a library, full stack framework)\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsx(_components.h2, {\n        children: \"My solution\"\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"To me, you do not need a bundler. If you are using typescript, at this stage in time, you should deploy js files to NPM though. In which case, you can run \", _jsx(_components.code, {\n          children: \"tsc\"\n        }), \" over your library code, and just deploy the folder of outputted files to NPM\"]\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"Example\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"package.json:\"\n      }), \"\\n\", _jsx(_components.pre, {\n        children: _jsx(_components.code, {\n          className: \"language-json\",\n          children: \"{\\n  \\\"scripts\\\": {\\n    \\\"build\\\": \\\"tsc\\\"\\n  },\\n  \\\"files\\\": [\\\"dist\\\"]\\n}\\n\"\n        })\n      }), \"\\n\", _jsx(_components.h2, {\n        children: \"What about testing?\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"Performing testing is not immediately solved by the above\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"Some options you have\"\n      }), \"\\n\", _jsxs(_components.ul, {\n        children: [\"\\n\", _jsxs(_components.li, {\n          children: [\"Use \", _jsx(_components.code, {\n            children: \"ts-jest\"\n          })]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [\"Use \", _jsx(_components.code, {\n            children: \"jest\"\n          }), \" on it's own, plus a \", _jsx(_components.code, {\n            children: \"babel\"\n          }), \" config with \", _jsx(_components.code, {\n            children: \"@babel/preset-typescript\"\n          })]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [\"Use \", _jsx(_components.code, {\n            children: \"jest\"\n          }), \" on it's own, run over the compiled output without a \", _jsx(_components.code, {\n            children: \"babel\"\n          }), \" config\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [\"Use \", _jsx(_components.code, {\n            children: \"vitest\"\n          })]\n        }), \"\\n\", _jsx(_components.li, {\n          children: \"Possibly something else?\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsx(_components.h2, {\n        children: \"Caveats\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"If you really care about producing a UMD bundle that can be used in a script\\ntag, maybe you want a bundler, but the future does not seem to lie here. Even\\nthe idea of a single file ESM module is, at best, a bit hazy: for example, are\\nyou bundling your dependencies or not?\"\n      }), \"\\n\", _jsxs(_components.ul, {\n        children: [\"\\n\", _jsx(_components.li, {\n          children: \"If you are not bundling dependencies, then what is the benefit of using a\\nbundler anyways?\"\n        }), \"\\n\", _jsx(_components.li, {\n          children: \"If you are bundling dependencies, you are not allowing people to get updates\\nto the subdenpendencies with semver!\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsx(_components.h2, {\n        children: \"Conclusion\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"You may not need a bundler or a starter kit when developing NPM libraries.\"\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"It is tempting to have a nice zero-config solutions and starter kits, but you\\nwill benefit from understanding your tools: specifically, using \", _jsx(_components.code, {\n          children: \"tsc\"\n        }), \" by\\nitself. The starter kits may not be maintained for perpetuity. Our team used\\n\", _jsx(_components.code, {\n          children: \"tsdx\"\n        }), \" for some time, but it was not maintained well, and used old typescript\\nversion 3.x, and it ended up being hard to remove from our codebase.\"]\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"Similar things happen if you take on dependencies like \", _jsx(_components.code, {\n          children: \"create-react-app\"\n        }), \". You\\nbecome very committed to their particular way of doing things, and can only\\nmodify their config with things like \", _jsx(_components.code, {\n          children: \"rescripts\"\n        }), \", \", _jsx(_components.code, {\n          children: \"craco\"\n        }), \" or \", _jsx(_components.code, {\n          children: \"rewired\"\n        }), \". If you\\ncrafted your setup with just \", _jsx(_components.code, {\n          children: \"webpack\"\n        }), \", you may not be so tied down.\"]\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"There is a nice speed to these starter kits, but I do think it is valuable to\\nlearn your tools\"\n      })]\n    });\n  }\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{}}}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"2022-05-27-youmaynotneedabundler"},"buildId":"wNbQTlm53oWhGcEQSmk8L","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>