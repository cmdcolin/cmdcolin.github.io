<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/css/97dc5fe527f5d592.css" data-precedence="next"/><link rel="preload" href="/_next/static/chunks/webpack-40edba06f6f71edb.js" as="script" fetchPriority="low"/><script src="/_next/static/chunks/fd9d1056-2b15443312687f8a.js" async=""></script><script src="/_next/static/chunks/596-adeabdb313a347d9.js" async=""></script><script src="/_next/static/chunks/main-app-326dcaa46b1410fc.js" async=""></script><title>You may not need a bundler for your NPM library</title><meta name="description" content="A blog"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="128x128"/><script src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js" noModule=""></script></head><body><div style="margin-bottom:100px"><a href="/">Misc scribbles</a></div><article><div><h1>You may not need a bundler for your NPM library</h1><h4>2022-05-27</h4></div><div><p>I have seen a couple threads on twitter where people complain about the
difficulty with publishing NPM libraries or ask what starter kit they should use
(or, people recommended starter packs anyways)</p>
<p>Example threads</p>
<ul>
<li><a href="https://twitter.com/cramforce/status/1513903035197526017">https://twitter.com/cramforce/status/1513903035197526017</a></li>
<li><a href="https://twitter.com/oleg008/status/1510006191296061441">https://twitter.com/oleg008/status/1510006191296061441</a></li>
<li><a href="https://twitter.com/iansu/status/1524860613943382017">https://twitter.com/iansu/status/1524860613943382017</a></li>
<li><a href="https://twitter.com/mpocock1/status/1525075901905522691">https://twitter.com/mpocock1/status/1525075901905522691</a></li>
</ul>
<p>One thing that is notable to me in these threads is that people often recommend
that you use a bundler (a program that combines multiple src files into a single
or fewer output files) when developing a library</p>
<p>Examples of starter packs suggested in these threads that use bundlers</p>
<ul>
<li><code>microbundle</code> - <a href="https://github.com/developit/microbundle">https://github.com/developit/microbundle</a> - uses rollup</li>
<li><code>esno</code> - <a href="https://www.npmjs.com/package/esno">https://www.npmjs.com/package/esno</a> - uses esbuild</li>
<li><code>unbuild</code> - <a href="https://github.com/unjs/unbuild">https://github.com/unjs/unbuild</a> - uses rollup</li>
<li><code>preconstruct</code> - <a href="https://github.com/preconstruct/preconstruct">https://github.com/preconstruct/preconstruct</a> - uses rollup</li>
<li><code>tsup</code> - <a href="https://github.com/egoist/tsup">https://github.com/egoist/tsup</a> - uses esbuild</li>
<li><code>tsdx</code> - <a href="https://github.com/jaredpalmer/tsdx">https://github.com/jaredpalmer/tsdx</a> - uses rollup</li>
<li><code>vite library mode</code> - <a href="https://vitejs.dev/guide/build.html#library-mode">https://vitejs.dev/guide/build.html#library-mode</a> - uses
rollup</li>
<li><code>packemon</code> - <a href="https://github.com/milesj/packemon">https://github.com/milesj/packemon</a> - uses rollup</li>
<li><code>ts-library-template</code> - <a href="https://github.com/shortercode/ts-library-template">https://github.com/shortercode/ts-library-template</a> -
uses rollup</li>
<li><code>parcel</code> - <a href="https://twitter.com/devongovett/status/1524944991402999810">https://twitter.com/devongovett/status/1524944991402999810</a> - uses
parcel</li>
<li><code>dts</code> - <a href="https://weiran-zsd.github.io/dts-cli/">https://weiran-zsd.github.io/dts-cli/</a> - uses rollup</li>
<li><code>pkgroll</code> - <a href="https://github.com/privatenumber/pkgroll">https://github.com/privatenumber/pkgroll</a> - uses rollup</li>
<li><code>mkdist</code> - <a href="https://github.com/unjs/mkdist">https://github.com/unjs/mkdist</a> - referenced by <code>unbuild</code>, uses
esbuild</li>
</ul>
<p>Not using bundlers</p>
<ul>
<li><code>gts</code> - <a href="https://github.com/google/gts">https://github.com/google/gts</a></li>
<li><code>ts-react-toolbox</code> - <a href="https://github.com/zzarcon/ts-react-toolbox/">https://github.com/zzarcon/ts-react-toolbox/</a></li>
</ul>
<p>In summary 2/15 do not use a bundler, 13/15 do use a bundler. Sidenote: webpack
notably absent. Sidenote 2: I don't necessarily give praise to the two not using
bundlers, just saying they exist.</p>
<h2 id="why-would-you-not-want-a-bundler-for-your-library"><a aria-hidden="true" tabindex="-1" href="#why-would-you-not-want-a-bundler-for-your-library"><a href="#why-would-you-not-want-a-bundler-for-your-library" style="margin-right: 10px">#</a></a>Why would you <em>NOT</em> want a bundler for your library?</h2>
<p>My main argument is that the consumer of your library is the one that should use
a bundler if it is relevant to them. If the library uses a bundler:</p>
<ul>
<li>in the best case, it has no impact on the consumer</li>
<li>in the worst case, it affects the complexity of your library and makes
possible limitations for your consumers also.</li>
</ul>
<p>An example where it can actually create limitations, you might consider code
splitting with async <code>import()</code>. If you create a single file bundle, then the
consumer of your library may not be able to do code splitting properly via async
<code>import()</code></p>
<h2 id="why-would-you-maybe-want-a-bundler-for-your-library"><a aria-hidden="true" tabindex="-1" href="#why-would-you-maybe-want-a-bundler-for-your-library"><a href="#why-would-you-maybe-want-a-bundler-for-your-library" style="margin-right: 10px">#</a></a>Why would you <em>MAYBE</em> want a bundler for your library</h2>
<p>If you really care about producing a <code>UMD</code> bundle that can be used in a script
tag, maybe you want a bundler, but the future does not seem to be in <code>UMD</code>. One
other possible bundle type is maybe you like the idea of a single file <code>ESM</code>
module. It is similar where you could maybe reference this from a script tag
with type module, but this seems like a niche usage. For example, you would
still have to consider:</p>
<ul>
<li>If you are not bundling dependencies, then what is the benefit of using a
bundler?</li>
<li>If you are bundling dependencies, you are not allowing people to get updates
to your sub-dependencies with semver!</li>
</ul>
<p>Add-on: Another concern brought up by users in discussion thread: There is a
cost to having many small files, e.g. in app startup cost on serverless or any
nodejs application to loading many small files off disk. To me, this is an app
level concern, similar to bundling for the browser though.</p>
<h2 id="my-suggestion-no-bundler-no-starter-pack-just-tsc"><a aria-hidden="true" tabindex="-1" href="#my-suggestion-no-bundler-no-starter-pack-just-tsc"><a href="#my-suggestion-no-bundler-no-starter-pack-just-tsc" style="margin-right: 10px">#</a></a>My suggestion: no bundler, no starter pack, just <code>tsc</code></h2>
<p>I'd recommend just compiling your code with <code>tsc</code>, no bundler involved. This
way, you can develop with typescript, it will output <code>js</code> files, and you can
directly deploy a <code>dist</code> folder of <code>js</code> files to NPM.</p>
<h3 id="example-packagejson"><a aria-hidden="true" tabindex="-1" href="#example-packagejson"><a href="#example-packagejson" style="margin-right: 10px">#</a></a>Example <code>package.json</code></h3>
<pre class="shiki poimandres" style="background-color: #1b1e28" tabindex="0"><code><span class="line"><span style="color: #A6ACCD">{</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #A6ACCD">"</span><span style="color: #E4F0FB">name</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">: </span><span style="color: #A6ACCD">"</span><span style="color: #5DE4C7">yourlib</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">,</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #A6ACCD">"</span><span style="color: #E4F0FB">version</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">: </span><span style="color: #A6ACCD">"</span><span style="color: #5DE4C7">1.0.0</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">,</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #A6ACCD">"</span><span style="color: #E4F0FB">main</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">: </span><span style="color: #A6ACCD">"</span><span style="color: #5DE4C7">dist/index.js</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">,</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #A6ACCD">"</span><span style="color: #E4F0FB">scripts</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">: {</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #A6ACCD">"</span><span style="color: #ADD7FF">clean</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">: </span><span style="color: #A6ACCD">"</span><span style="color: #5DE4C7">rimraf dist</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">,</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #A6ACCD">"</span><span style="color: #ADD7FF">prebuild</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">: </span><span style="color: #A6ACCD">"</span><span style="color: #5DE4C7">npm run clean</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">,</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #A6ACCD">"</span><span style="color: #ADD7FF">build</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">: </span><span style="color: #A6ACCD">"</span><span style="color: #5DE4C7">tsc</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">,</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #A6ACCD">"</span><span style="color: #ADD7FF">preversion</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">: </span><span style="color: #A6ACCD">"</span><span style="color: #5DE4C7">npm run build</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">,</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #A6ACCD">"</span><span style="color: #ADD7FF">postversion</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">: </span><span style="color: #A6ACCD">"</span><span style="color: #5DE4C7">git push --follow-tags</span><span style="color: #A6ACCD">"</span></span>
<span class="line"><span style="color: #A6ACCD">  },</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #A6ACCD">"</span><span style="color: #E4F0FB">files</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">: [</span><span style="color: #A6ACCD">"</span><span style="color: #5DE4C7">dist</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">, </span><span style="color: #A6ACCD">"</span><span style="color: #5DE4C7">src</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">],</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #A6ACCD">"</span><span style="color: #E4F0FB">devDependencies</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">: {</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #A6ACCD">"</span><span style="color: #ADD7FF">rimraf</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">: </span><span style="color: #A6ACCD">"</span><span style="color: #5DE4C7">^3.0.2</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">,</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #A6ACCD">"</span><span style="color: #ADD7FF">typescript</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">: </span><span style="color: #A6ACCD">"</span><span style="color: #5DE4C7">^4.6.2</span><span style="color: #A6ACCD">"</span></span>
<span class="line"><span style="color: #A6ACCD">  }</span></span>
<span class="line"><span style="color: #A6ACCD">}</span></span></code></pre>
<h4 id="features-of-the-above-packagejson"><a aria-hidden="true" tabindex="-1" href="#features-of-the-above-packagejson"><a href="#features-of-the-above-packagejson" style="margin-right: 10px">#</a></a>Features of the above <code>package.json</code></h4>
<ul>
<li>We can use a single command, <code>yarn publish</code> to publish to npm</li>
<li>The single <code>yarn publish</code> automatically runs <code>clean</code> and <code>build</code> via
<code>preversion</code>, then <code>postversion</code>, which pushes the tag to the remote repo</li>
<li>The <code>"files": ["dist", "src"]</code> refers to publishing the <code>dist</code> and <code>src</code>
directories, and src is used for the <code>sourceMap</code></li>
</ul>
<h3 id="example-tsconfigjson"><a aria-hidden="true" tabindex="-1" href="#example-tsconfigjson"><a href="#example-tsconfigjson" style="margin-right: 10px">#</a></a>Example<code> tsconfig.json</code></h3>
<pre class="shiki poimandres" style="background-color: #1b1e28" tabindex="0"><code><span class="line"><span style="color: #A6ACCD">{</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #A6ACCD">"</span><span style="color: #E4F0FB">include</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">: [</span><span style="color: #A6ACCD">"</span><span style="color: #5DE4C7">src</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">],</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #A6ACCD">"</span><span style="color: #E4F0FB">compilerOptions</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">: {</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #A6ACCD">"</span><span style="color: #ADD7FF">target</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">: </span><span style="color: #A6ACCD">"</span><span style="color: #5DE4C7">es2018</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">,</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #A6ACCD">"</span><span style="color: #ADD7FF">outDir</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">: </span><span style="color: #A6ACCD">"</span><span style="color: #5DE4C7">dist</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">,</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #A6ACCD">"</span><span style="color: #ADD7FF">lib</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">: [</span><span style="color: #A6ACCD">"</span><span style="color: #5DE4C7">dom</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">, </span><span style="color: #A6ACCD">"</span><span style="color: #5DE4C7">esnext</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">],</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #A6ACCD">"</span><span style="color: #ADD7FF">declaration</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">: </span><span style="color: #5DE4C7">true</span><span style="color: #A6ACCD">,</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #A6ACCD">"</span><span style="color: #ADD7FF">moduleResolution</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">: </span><span style="color: #A6ACCD">"</span><span style="color: #5DE4C7">node</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">,</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #A6ACCD">"</span><span style="color: #ADD7FF">sourceMap</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">: </span><span style="color: #5DE4C7">true</span><span style="color: #A6ACCD">,</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #A6ACCD">"</span><span style="color: #ADD7FF">strict</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">: </span><span style="color: #5DE4C7">true</span><span style="color: #A6ACCD">,</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #A6ACCD">"</span><span style="color: #ADD7FF">esModuleInterop</span><span style="color: #A6ACCD">"</span><span style="color: #A6ACCD">: </span><span style="color: #5DE4C7">true</span></span>
<span class="line"><span style="color: #A6ACCD">  }</span></span>
<span class="line"><span style="color: #A6ACCD">}</span></span></code></pre>
<h4 id="features-of-the-above-tsconfigjson"><a aria-hidden="true" tabindex="-1" href="#features-of-the-above-tsconfigjson"><a href="#features-of-the-above-tsconfigjson" style="margin-right: 10px">#</a></a>Features of the above <code>tsconfig.json</code></h4>
<ul>
<li>Uses <code>"moduleResolution": "node"</code> - this is not pure-ESM because pure-ESM
expects you to import filenames with their file extension, while node module
resolution can import extensionless paths, but node module resolution
generally works well with consumers that use bundlers themselves</li>
<li>Uses <code>"target": "es2018"</code> - This is does a small amount of transpilation of
super modern features, but would generally not require your users to babel-ify
their <code>node_modules</code> if they consume your library</li>
</ul>
<h2 id="what-about-testing"><a aria-hidden="true" tabindex="-1" href="#what-about-testing"><a href="#what-about-testing" style="margin-right: 10px">#</a></a>What about testing?</h2>
<p>Adding testing is not immediately solved by the above, but bundling doesn't
really help testing anyways. It's just a starter pack feature we can add on.
Some options you have include</p>
<ul>
<li>Use <code>ts-jest</code></li>
<li>Use <code>jest</code> on it's own, plus a <code>babel</code> config with <code>@babel/preset-typescript</code></li>
<li>Use <code>jest</code> on it's own, run over the compiled output without a <code>babel</code> config</li>
<li>Use <code>vitest</code></li>
<li>Possibly something else? Node now has a built-in test runner. It will be a
slow road to adoption but might become more popular over time
<a href="https://fusebit.io/blog/node-testing-comes-to-core/">https://fusebit.io/blog/node-testing-comes-to-core/</a></li>
</ul>
<h2 id="conclusion"><a aria-hidden="true" tabindex="-1" href="#conclusion"><a href="#conclusion" style="margin-right: 10px">#</a></a>Conclusion</h2>
<p>It is tempting to have nice zero-config solutions and starter kits, but to me,
it is not really beneficial to use the bundler aspect of many of these for
publishing to NPM. Am I wrong? Let me know if I am.</p>
<p>Also, these starter kits may not be maintained for perpetuity. Our team used
<code>tsdx</code> for some time, but it was not maintained well, and used old typescript
version 3.x, and it ended up being hard to remove from our codebase. Learning
the basic tools like <code>tsc</code> will help</p>
<h2 id="footnote-1-shipping-pure-esm"><a aria-hidden="true" tabindex="-1" href="#footnote-1-shipping-pure-esm"><a href="#footnote-1-shipping-pure-esm" style="margin-right: 10px">#</a></a>Footnote 1: Shipping "pure-ESM"</h2>
<p>Do you want to make a pure-ESM package? Then you do not want to use
<code>"moduleResolution": "node"</code> in <code>tsconfig.json</code>, and you will want to set
<code>"type": "module"</code> in <code>package.json</code>. You may also need to explicitly import
with <code>.js</code> extensions in your source code, even if you write <code>.ts</code>. This is
awkward, and something the community is still grappling with.</p>
<p>If you have ever stumbled on this topic, you will probably want to see this link
<a href="https://gist.github.com/sindresorhus/a39789f98801d908bbc7ff3ecc99d99c">https://gist.github.com/sindresorhus/a39789f98801d908bbc7ff3ecc99d99c</a></p>
<h2 id="footnote-2-shipping-esm-and-commonjs-side-by-side-without-going-pure-esm"><a aria-hidden="true" tabindex="-1" href="#footnote-2-shipping-esm-and-commonjs-side-by-side-without-going-pure-esm"><a href="#footnote-2-shipping-esm-and-commonjs-side-by-side-without-going-pure-esm" style="margin-right: 10px">#</a></a>Footnote 2: Shipping ESM and CommonJS side by side without going "pure-ESM"</h2>
<p>It can be tricky to go pure-ESM, but you can go most of the way there by using
both the "main" and "module" fields in package.json</p>
<ul>
<li>Compile with tsc with <code>tsc --module commonjs --outDir dist</code></li>
<li>Compile with tsc again with <code>tsc --module esnext --outDir esm</code></li>
<li>Then set "main":"dist/index.js" for node and <code>"module":"esm/index.js"</code> for
bundlers</li>
</ul>
<p>The "module" field is a field only bundlers recognizes
<a href="https://stackoverflow.com/questions/42708484/what-is-the-module-package-json-field-for">https://stackoverflow.com/questions/42708484/what-is-the-module-package-json-field-for</a></p>
<p>Note: This is different from the "type":"module" which marks your module as
pure-ESM!</p>
<p>I have found this technique can go a long ways towards keeping your package
compatible with nodeJS and bundlers and it does not require "export maps" or
anything which I have found to be difficult to configure</p>
<h2 id="footnote-3-learning-your-tools"><a aria-hidden="true" tabindex="-1" href="#footnote-3-learning-your-tools"><a href="#footnote-3-learning-your-tools" style="margin-right: 10px">#</a></a>Footnote 3: Learning your tools</h2>
<p>Several people on the
<a href="https://cmdcolin.github.io/posts/2022-05-04-findseddangerous">my recent post</a>
post suggested that I did not understand my tools, and that I should just learn
the tools correctly and I wouldn't have the problem I had.</p>
<p>Indeed, what I am now telling people to do in this post is similar: I am saying
"just use <code>tsc</code> by itself! Understand you tools! You may have to do more
research and create more boilerplate, but it's <strong>better</strong>".</p>
<p>Ultimately though, it's up to you to choose your tools and starter packs and
whatnot.</p>
<h2 id="footnote-4-what-does-it-look-like-when-you-compile-with-tsc"><a aria-hidden="true" tabindex="-1" href="#footnote-4-what-does-it-look-like-when-you-compile-with-tsc"><a href="#footnote-4-what-does-it-look-like-when-you-compile-with-tsc" style="margin-right: 10px">#</a></a>Footnote 4: What does it look like when you compile with tsc?</h2>
<p>When I refer to compiling with tsc above, I compile a <code>src</code> directory into a
<code>dist</code> directory</p>
<p>So if I have:</p>
<pre><code>src/index.ts
src/util.ts
src/components/Button.ts
</code></pre>
<p>Running <code>tsc</code> will output:</p>
<pre><code>dist/index.js
dist/index.d.ts
dist/index.js.map
dist/util.js
dist/util.d.ts
dist/util.js.map
dist/components/Button.js
dist/components/Button.d.ts
dist/components/Button.js.map
</code></pre>
<p>Then, the <code>dist</code> and <code>src</code> directories are published to npm which enables the
<code>sourceMaps</code> to work.</p>
<p>Note: We do not need to explicitly say where the typescript types are with
"types" in <code>package.json</code>, many starter packs do this but it is unneeded for
this package as the d.ts files are automatically found.</p>
<p>See <a href="https://cmdcolin.github.io/posts/2021-12-31-npm-package">https://cmdcolin.github.io/posts/2021-12-31-npm-package</a> for my article on
creating a typescript package for npm</p>
<h2 id="footnote-5-other-things-people-recommend"><a aria-hidden="true" tabindex="-1" href="#footnote-5-other-things-people-recommend"><a href="#footnote-5-other-things-people-recommend" style="margin-right: 10px">#</a></a>Footnote 5: Other things people recommend</h2>
<p>Other things people recommend in the starter pack threads</p>
<ul>
<li><code>deno</code> - not clear to me how this helps when deploying to npm, but I still
gotta try deno</li>
<li><code>ts-node </code> - not clear to me how this helps when deploying to npm</li>
<li><code>nx</code> - heavy monorepo-based solution</li>
<li><code>elm</code> - that's just a different thing</li>
<li><code>Typescript-Node-Starter</code> -
<a href="https://github.com/microsoft/TypeScript-Node-Starter">https://github.com/microsoft/TypeScript-Node-Starter</a> - not a library, full
stack framework</li>
<li><code>joystick</code> - <a href="https://github.com/CheatCode/joystick">https://github.com/CheatCode/joystick</a> - not a library, full stack
framework</li>
</ul>
<h2 id="footnote-6"><a aria-hidden="true" tabindex="-1" href="#footnote-6"><a href="#footnote-6" style="margin-right: 10px">#</a></a>Footnote 6:</h2>
<p>Similar things happen if you take on dependencies of starter kits like
<code>create-react-app</code>. You become very committed to their particular way of doing
things, and can only modify their config with things like <code>rescripts</code>, <code>craco</code>
or <code>rewired</code>. If you crafted your setup with just <code>webpack</code>, you may not be so
tied down. But, I still use things like <code>create-react-app</code> because they do seem
to help me significantly. Now though, the tide seems to be turning other
directions like next.js which can do static site generation at a basic level and
extend to multiple pages more easily.</p>
<h2 id="footnote-7"><a aria-hidden="true" tabindex="-1" href="#footnote-7"><a href="#footnote-7" style="margin-right: 10px">#</a></a>Footnote 7:</h2>
<p>You may not even need <code>tsc</code> to compile your dist folder. You can literally
publish your source <code>.js</code> files as-is to NPM. This suggestion comes from
@trevmanz <a href="https://twitter.com/trevmanz/status/1534962190008172545">1</a>
<a href="https://twitter.com/trevmanz/status/1534962940348092417">2</a>. I don't personally
use this technique yet but there are many users with this workflow</p>
<p>An interesting thing is you can write in <code>.js</code> but still get <code>typescript</code> to get
type checking using <code>jsdoc</code>, just use <code>allowJs</code>/<code>checkJs</code> flags in
<code>tsconfig.json</code></p>
<h2 id="footnote-8"><a aria-hidden="true" tabindex="-1" href="#footnote-8"><a href="#footnote-8" style="margin-right: 10px">#</a></a>Footnote 8:</h2>
<p>What about React? Bundlers not needed, and not even babel is needed: you can
code your library as in <code>jsx</code> or <code>tsx</code> files and use <code>tsc</code> to compile it to
React.createElement statements or other jsx transforms.</p></div><div style="margin-top:200px"></div></article><footer style="margin-top:100px"><a href="/">Home</a> <a href="/archive">Blog archive</a> <a href="https://github.com/cmdcolin/">Github</a> <a href="https://twitter.com/cmdcolin">Twitter</a> <a href="/projects">Projects</a> <a href="/photos">Photos</a> <a href="/about">About</a></footer><script src="/_next/static/chunks/webpack-40edba06f6f71edb.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/97dc5fe527f5d592.css\",{\"as\":\"style\"}]\n0:\"$L2\"\n"])</script><script>self.__next_f.push([1,"3:I{\"id\":7948,\"chunks\":[\"272:static/chunks/webpack-40edba06f6f71edb.js\",\"971:static/chunks/fd9d1056-2b15443312687f8a.js\",\"596:static/chunks/596-adeabdb313a347d9.js\"],\"name\":\"default\",\"async\":false}\n5:I{\"id\":6628,\"chunks\":[\"272:static/chunks/webpack-40edba06f6f71edb.js\",\"971:static/chunks/fd9d1056-2b15443312687f8a.js\",\"596:static/chunks/596-adeabdb313a347d9.js\"],\"name\":\"\",\"async\":false}\n6:I{\"id\":6685,\"chunks\":[\"685:static/chunks/685-3ae734227e2e8975.js\",\"185:static/chunks/app/layout-3759995e3b279a75.js\"],\"na"])</script><script>self.__next_f.push([1,"me\":\"\",\"async\":false}\n7:I{\"id\":7767,\"chunks\":[\"272:static/chunks/webpack-40edba06f6f71edb.js\",\"971:static/chunks/fd9d1056-2b15443312687f8a.js\",\"596:static/chunks/596-adeabdb313a347d9.js\"],\"name\":\"default\",\"async\":false}\n8:I{\"id\":7920,\"chunks\":[\"272:static/chunks/webpack-40edba06f6f71edb.js\",\"971:static/chunks/fd9d1056-2b15443312687f8a.js\",\"596:static/chunks/596-adeabdb313a347d9.js\"],\"name\":\"default\",\"async\":false}\n"])</script><script>self.__next_f.push([1,"2:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/97dc5fe527f5d592.css\",\"precedence\":\"next\"}]],[\"$\",\"$L3\",null,{\"buildId\":\"nIbvSKgGHeozdQqqgxWEl\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/posts/2022-05-27-youmaynotneedabundler\",\"initialTree\":[\"\",{\"children\":[\"posts\",{\"children\":[[\"id\",\"2022-05-27-youmaynotneedabundler\",\"d\"],{\"children\":[\"__PAGE__?{\\\"id\\\":\\\"2022-05-27-youmaynotneedabundler\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialHead\":[false,\"$L4\"],\"globalErrorComponent\":\"$5\",\"children\":[null,[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"children\":[[\"$\",\"div\",null,{\"style\":{\"marginBottom\":100},\"children\":[\"$\",\"$L6\",null,{\"href\":\"/\",\"children\":\"Misc scribbles\"}]}],[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"childProp\":{\"current\":[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\",[\"id\",\"2022-05-27-youmaynotneedabundler\",\"d\"],\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$L9\",\"$La\",null],\"segment\":\"__PAGE__?{\\\"id\\\":\\\"2022-05-27-youmaynotneedabundler\\\"}\"},\"styles\":[]}],\"segment\":[\"id\",\"2022-05-27-youmaynotneedabundler\",\"d\"]},\"styles\":[]}],\"segment\":\"posts\"},\"styles\":[]}],[\"$\",\"footer\",null,{\"style\":{\"marginTop\":100},\"children\":[[\"$\",\"$L6\",null,{\"href\":\"/\",\"children\":\"Home\"}],\" \",[\"$\",\"$L6\",null,{\"href\":\"/archive\",\"children\":\"Blog archive\"}],\" \",[\"$\",\"$L6\",null,{\"href\":\"https://github.com/cmdcolin/\",\"children\":\"Github\"}],\" \",[\"$\",\"$L6\",null,{\"href\":\"https://twitter.com/cmdcolin\",\"children\":\"Twitter\"}],\" \",[\"$\",\"$L6\",null,{\"href\":\"/projects\",\"children\":\"Projects\"}],\" \",[\"$\",\"$L6\",null,{\"href\":\"/photos\",\"children\":\"Photos\"}],\" \",[\"$\",\"$L6\",null,{\"href\":\"/about\",\"children\":\"About\"}]]}]]}]}],null]}]]\n"])</script><script>self.__next_f.push([1,"c:I{\"id\":6306,\"chunks\":[\"722:static/chunks/app/posts/[id]/page-8cf76b3c924a344e.js\"],\"name\":\"\",\"async\":false}\nb:T65de,"])</script><script>self.__next_f.push([1,"\u003cp\u003eI have seen a couple threads on twitter where people complain about the\ndifficulty with publishing NPM libraries or ask what starter kit they should use\n(or, people recommended starter packs anyways)\u003c/p\u003e\n\u003cp\u003eExample threads\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://twitter.com/cramforce/status/1513903035197526017\"\u003ehttps://twitter.com/cramforce/status/1513903035197526017\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://twitter.com/oleg008/status/1510006191296061441\"\u003ehttps://twitter.com/oleg008/status/1510006191296061441\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://twitter.com/iansu/status/1524860613943382017\"\u003ehttps://twitter.com/iansu/status/1524860613943382017\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://twitter.com/mpocock1/status/1525075901905522691\"\u003ehttps://twitter.com/mpocock1/status/1525075901905522691\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eOne thing that is notable to me in these threads is that people often recommend\nthat you use a bundler (a program that combines multiple src files into a single\nor fewer output files) when developing a library\u003c/p\u003e\n\u003cp\u003eExamples of starter packs suggested in these threads that use bundlers\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003emicrobundle\u003c/code\u003e - \u003ca href=\"https://github.com/developit/microbundle\"\u003ehttps://github.com/developit/microbundle\u003c/a\u003e - uses rollup\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eesno\u003c/code\u003e - \u003ca href=\"https://www.npmjs.com/package/esno\"\u003ehttps://www.npmjs.com/package/esno\u003c/a\u003e - uses esbuild\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eunbuild\u003c/code\u003e - \u003ca href=\"https://github.com/unjs/unbuild\"\u003ehttps://github.com/unjs/unbuild\u003c/a\u003e - uses rollup\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003epreconstruct\u003c/code\u003e - \u003ca href=\"https://github.com/preconstruct/preconstruct\"\u003ehttps://github.com/preconstruct/preconstruct\u003c/a\u003e - uses rollup\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003etsup\u003c/code\u003e - \u003ca href=\"https://github.com/egoist/tsup\"\u003ehttps://github.com/egoist/tsup\u003c/a\u003e - uses esbuild\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003etsdx\u003c/code\u003e - \u003ca href=\"https://github.com/jaredpalmer/tsdx\"\u003ehttps://github.com/jaredpalmer/tsdx\u003c/a\u003e - uses rollup\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003evite library mode\u003c/code\u003e - \u003ca href=\"https://vitejs.dev/guide/build.html#library-mode\"\u003ehttps://vitejs.dev/guide/build.html#library-mode\u003c/a\u003e - uses\nrollup\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003epackemon\u003c/code\u003e - \u003ca href=\"https://github.com/milesj/packemon\"\u003ehttps://github.com/milesj/packemon\u003c/a\u003e - uses rollup\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ets-library-template\u003c/code\u003e - \u003ca href=\"https://github.com/shortercode/ts-library-template\"\u003ehttps://github.com/shortercode/ts-library-template\u003c/a\u003e -\nuses rollup\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eparcel\u003c/code\u003e - \u003ca href=\"https://twitter.com/devongovett/status/1524944991402999810\"\u003ehttps://twitter.com/devongovett/status/1524944991402999810\u003c/a\u003e - uses\nparcel\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003edts\u003c/code\u003e - \u003ca href=\"https://weiran-zsd.github.io/dts-cli/\"\u003ehttps://weiran-zsd.github.io/dts-cli/\u003c/a\u003e - uses rollup\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003epkgroll\u003c/code\u003e - \u003ca href=\"https://github.com/privatenumber/pkgroll\"\u003ehttps://github.com/privatenumber/pkgroll\u003c/a\u003e - uses rollup\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emkdist\u003c/code\u003e - \u003ca href=\"https://github.com/unjs/mkdist\"\u003ehttps://github.com/unjs/mkdist\u003c/a\u003e - referenced by \u003ccode\u003eunbuild\u003c/code\u003e, uses\nesbuild\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eNot using bundlers\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003egts\u003c/code\u003e - \u003ca href=\"https://github.com/google/gts\"\u003ehttps://github.com/google/gts\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ets-react-toolbox\u003c/code\u003e - \u003ca href=\"https://github.com/zzarcon/ts-react-toolbox/\"\u003ehttps://github.com/zzarcon/ts-react-toolbox/\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eIn summary 2/15 do not use a bundler, 13/15 do use a bundler. Sidenote: webpack\nnotably absent. Sidenote 2: I don't necessarily give praise to the two not using\nbundlers, just saying they exist.\u003c/p\u003e\n\u003ch2 id=\"why-would-you-not-want-a-bundler-for-your-library\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#why-would-you-not-want-a-bundler-for-your-library\"\u003e\u003ca href=\"#why-would-you-not-want-a-bundler-for-your-library\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eWhy would you \u003cem\u003eNOT\u003c/em\u003e want a bundler for your library?\u003c/h2\u003e\n\u003cp\u003eMy main argument is that the consumer of your library is the one that should use\na bundler if it is relevant to them. If the library uses a bundler:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ein the best case, it has no impact on the consumer\u003c/li\u003e\n\u003cli\u003ein the worst case, it affects the complexity of your library and makes\npossible limitations for your consumers also.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eAn example where it can actually create limitations, you might consider code\nsplitting with async \u003ccode\u003eimport()\u003c/code\u003e. If you create a single file bundle, then the\nconsumer of your library may not be able to do code splitting properly via async\n\u003ccode\u003eimport()\u003c/code\u003e\u003c/p\u003e\n\u003ch2 id=\"why-would-you-maybe-want-a-bundler-for-your-library\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#why-would-you-maybe-want-a-bundler-for-your-library\"\u003e\u003ca href=\"#why-would-you-maybe-want-a-bundler-for-your-library\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eWhy would you \u003cem\u003eMAYBE\u003c/em\u003e want a bundler for your library\u003c/h2\u003e\n\u003cp\u003eIf you really care about producing a \u003ccode\u003eUMD\u003c/code\u003e bundle that can be used in a script\ntag, maybe you want a bundler, but the future does not seem to be in \u003ccode\u003eUMD\u003c/code\u003e. One\nother possible bundle type is maybe you like the idea of a single file \u003ccode\u003eESM\u003c/code\u003e\nmodule. It is similar where you could maybe reference this from a script tag\nwith type module, but this seems like a niche usage. For example, you would\nstill have to consider:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eIf you are not bundling dependencies, then what is the benefit of using a\nbundler?\u003c/li\u003e\n\u003cli\u003eIf you are bundling dependencies, you are not allowing people to get updates\nto your sub-dependencies with semver!\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eAdd-on: Another concern brought up by users in discussion thread: There is a\ncost to having many small files, e.g. in app startup cost on serverless or any\nnodejs application to loading many small files off disk. To me, this is an app\nlevel concern, similar to bundling for the browser though.\u003c/p\u003e\n\u003ch2 id=\"my-suggestion-no-bundler-no-starter-pack-just-tsc\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#my-suggestion-no-bundler-no-starter-pack-just-tsc\"\u003e\u003ca href=\"#my-suggestion-no-bundler-no-starter-pack-just-tsc\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eMy suggestion: no bundler, no starter pack, just \u003ccode\u003etsc\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eI'd recommend just compiling your code with \u003ccode\u003etsc\u003c/code\u003e, no bundler involved. This\nway, you can develop with typescript, it will output \u003ccode\u003ejs\u003c/code\u003e files, and you can\ndirectly deploy a \u003ccode\u003edist\u003c/code\u003e folder of \u003ccode\u003ejs\u003c/code\u003e files to NPM.\u003c/p\u003e\n\u003ch3 id=\"example-packagejson\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#example-packagejson\"\u003e\u003ca href=\"#example-packagejson\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eExample \u003ccode\u003epackage.json\u003c/code\u003e\u003c/h3\u003e\n\u003cpre class=\"shiki poimandres\" style=\"background-color: #1b1e28\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #E4F0FB\"\u003ename\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e: \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #5DE4C7\"\u003eyourlib\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #E4F0FB\"\u003eversion\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e: \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #5DE4C7\"\u003e1.0.0\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #E4F0FB\"\u003emain\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e: \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #5DE4C7\"\u003edist/index.js\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #E4F0FB\"\u003escripts\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e: {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003eclean\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e: \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #5DE4C7\"\u003erimraf dist\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003eprebuild\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e: \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #5DE4C7\"\u003enpm run clean\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003ebuild\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e: \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #5DE4C7\"\u003etsc\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003epreversion\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e: \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #5DE4C7\"\u003enpm run build\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003epostversion\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e: \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #5DE4C7\"\u003egit push --follow-tags\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e  },\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #E4F0FB\"\u003efiles\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e: [\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #5DE4C7\"\u003edist\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e, \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #5DE4C7\"\u003esrc\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e],\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #E4F0FB\"\u003edevDependencies\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e: {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003erimraf\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e: \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #5DE4C7\"\u003e^3.0.2\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003etypescript\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e: \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #5DE4C7\"\u003e^4.6.2\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e  }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"features-of-the-above-packagejson\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#features-of-the-above-packagejson\"\u003e\u003ca href=\"#features-of-the-above-packagejson\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eFeatures of the above \u003ccode\u003epackage.json\u003c/code\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eWe can use a single command, \u003ccode\u003eyarn publish\u003c/code\u003e to publish to npm\u003c/li\u003e\n\u003cli\u003eThe single \u003ccode\u003eyarn publish\u003c/code\u003e automatically runs \u003ccode\u003eclean\u003c/code\u003e and \u003ccode\u003ebuild\u003c/code\u003e via\n\u003ccode\u003epreversion\u003c/code\u003e, then \u003ccode\u003epostversion\u003c/code\u003e, which pushes the tag to the remote repo\u003c/li\u003e\n\u003cli\u003eThe \u003ccode\u003e\"files\": [\"dist\", \"src\"]\u003c/code\u003e refers to publishing the \u003ccode\u003edist\u003c/code\u003e and \u003ccode\u003esrc\u003c/code\u003e\ndirectories, and src is used for the \u003ccode\u003esourceMap\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"example-tsconfigjson\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#example-tsconfigjson\"\u003e\u003ca href=\"#example-tsconfigjson\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eExample\u003ccode\u003e tsconfig.json\u003c/code\u003e\u003c/h3\u003e\n\u003cpre class=\"shiki poimandres\" style=\"background-color: #1b1e28\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #E4F0FB\"\u003einclude\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e: [\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #5DE4C7\"\u003esrc\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e],\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #E4F0FB\"\u003ecompilerOptions\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e: {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003etarget\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e: \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #5DE4C7\"\u003ees2018\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003eoutDir\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e: \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #5DE4C7\"\u003edist\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003elib\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e: [\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #5DE4C7\"\u003edom\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e, \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #5DE4C7\"\u003eesnext\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e],\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003edeclaration\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e: \u003c/span\u003e\u003cspan style=\"color: #5DE4C7\"\u003etrue\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003emoduleResolution\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e: \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #5DE4C7\"\u003enode\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003esourceMap\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e: \u003c/span\u003e\u003cspan style=\"color: #5DE4C7\"\u003etrue\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003estrict\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e: \u003c/span\u003e\u003cspan style=\"color: #5DE4C7\"\u003etrue\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003eesModuleInterop\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e: \u003c/span\u003e\u003cspan style=\"color: #5DE4C7\"\u003etrue\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e  }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"features-of-the-above-tsconfigjson\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#features-of-the-above-tsconfigjson\"\u003e\u003ca href=\"#features-of-the-above-tsconfigjson\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eFeatures of the above \u003ccode\u003etsconfig.json\u003c/code\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eUses \u003ccode\u003e\"moduleResolution\": \"node\"\u003c/code\u003e - this is not pure-ESM because pure-ESM\nexpects you to import filenames with their file extension, while node module\nresolution can import extensionless paths, but node module resolution\ngenerally works well with consumers that use bundlers themselves\u003c/li\u003e\n\u003cli\u003eUses \u003ccode\u003e\"target\": \"es2018\"\u003c/code\u003e - This is does a small amount of transpilation of\nsuper modern features, but would generally not require your users to babel-ify\ntheir \u003ccode\u003enode_modules\u003c/code\u003e if they consume your library\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"what-about-testing\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#what-about-testing\"\u003e\u003ca href=\"#what-about-testing\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eWhat about testing?\u003c/h2\u003e\n\u003cp\u003eAdding testing is not immediately solved by the above, but bundling doesn't\nreally help testing anyways. It's just a starter pack feature we can add on.\nSome options you have include\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eUse \u003ccode\u003ets-jest\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eUse \u003ccode\u003ejest\u003c/code\u003e on it's own, plus a \u003ccode\u003ebabel\u003c/code\u003e config with \u003ccode\u003e@babel/preset-typescript\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eUse \u003ccode\u003ejest\u003c/code\u003e on it's own, run over the compiled output without a \u003ccode\u003ebabel\u003c/code\u003e config\u003c/li\u003e\n\u003cli\u003eUse \u003ccode\u003evitest\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003ePossibly something else? Node now has a built-in test runner. It will be a\nslow road to adoption but might become more popular over time\n\u003ca href=\"https://fusebit.io/blog/node-testing-comes-to-core/\"\u003ehttps://fusebit.io/blog/node-testing-comes-to-core/\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"conclusion\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#conclusion\"\u003e\u003ca href=\"#conclusion\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eConclusion\u003c/h2\u003e\n\u003cp\u003eIt is tempting to have nice zero-config solutions and starter kits, but to me,\nit is not really beneficial to use the bundler aspect of many of these for\npublishing to NPM. Am I wrong? Let me know if I am.\u003c/p\u003e\n\u003cp\u003eAlso, these starter kits may not be maintained for perpetuity. Our team used\n\u003ccode\u003etsdx\u003c/code\u003e for some time, but it was not maintained well, and used old typescript\nversion 3.x, and it ended up being hard to remove from our codebase. Learning\nthe basic tools like \u003ccode\u003etsc\u003c/code\u003e will help\u003c/p\u003e\n\u003ch2 id=\"footnote-1-shipping-pure-esm\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#footnote-1-shipping-pure-esm\"\u003e\u003ca href=\"#footnote-1-shipping-pure-esm\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eFootnote 1: Shipping \"pure-ESM\"\u003c/h2\u003e\n\u003cp\u003eDo you want to make a pure-ESM package? Then you do not want to use\n\u003ccode\u003e\"moduleResolution\": \"node\"\u003c/code\u003e in \u003ccode\u003etsconfig.json\u003c/code\u003e, and you will want to set\n\u003ccode\u003e\"type\": \"module\"\u003c/code\u003e in \u003ccode\u003epackage.json\u003c/code\u003e. You may also need to explicitly import\nwith \u003ccode\u003e.js\u003c/code\u003e extensions in your source code, even if you write \u003ccode\u003e.ts\u003c/code\u003e. This is\nawkward, and something the community is still grappling with.\u003c/p\u003e\n\u003cp\u003eIf you have ever stumbled on this topic, you will probably want to see this link\n\u003ca href=\"https://gist.github.com/sindresorhus/a39789f98801d908bbc7ff3ecc99d99c\"\u003ehttps://gist.github.com/sindresorhus/a39789f98801d908bbc7ff3ecc99d99c\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"footnote-2-shipping-esm-and-commonjs-side-by-side-without-going-pure-esm\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#footnote-2-shipping-esm-and-commonjs-side-by-side-without-going-pure-esm\"\u003e\u003ca href=\"#footnote-2-shipping-esm-and-commonjs-side-by-side-without-going-pure-esm\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eFootnote 2: Shipping ESM and CommonJS side by side without going \"pure-ESM\"\u003c/h2\u003e\n\u003cp\u003eIt can be tricky to go pure-ESM, but you can go most of the way there by using\nboth the \"main\" and \"module\" fields in package.json\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eCompile with tsc with \u003ccode\u003etsc --module commonjs --outDir dist\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eCompile with tsc again with \u003ccode\u003etsc --module esnext --outDir esm\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eThen set \"main\":\"dist/index.js\" for node and \u003ccode\u003e\"module\":\"esm/index.js\"\u003c/code\u003e for\nbundlers\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThe \"module\" field is a field only bundlers recognizes\n\u003ca href=\"https://stackoverflow.com/questions/42708484/what-is-the-module-package-json-field-for\"\u003ehttps://stackoverflow.com/questions/42708484/what-is-the-module-package-json-field-for\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eNote: This is different from the \"type\":\"module\" which marks your module as\npure-ESM!\u003c/p\u003e\n\u003cp\u003eI have found this technique can go a long ways towards keeping your package\ncompatible with nodeJS and bundlers and it does not require \"export maps\" or\nanything which I have found to be difficult to configure\u003c/p\u003e\n\u003ch2 id=\"footnote-3-learning-your-tools\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#footnote-3-learning-your-tools\"\u003e\u003ca href=\"#footnote-3-learning-your-tools\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eFootnote 3: Learning your tools\u003c/h2\u003e\n\u003cp\u003eSeveral people on the\n\u003ca href=\"https://cmdcolin.github.io/posts/2022-05-04-findseddangerous\"\u003emy recent post\u003c/a\u003e\npost suggested that I did not understand my tools, and that I should just learn\nthe tools correctly and I wouldn't have the problem I had.\u003c/p\u003e\n\u003cp\u003eIndeed, what I am now telling people to do in this post is similar: I am saying\n\"just use \u003ccode\u003etsc\u003c/code\u003e by itself! Understand you tools! You may have to do more\nresearch and create more boilerplate, but it's \u003cstrong\u003ebetter\u003c/strong\u003e\".\u003c/p\u003e\n\u003cp\u003eUltimately though, it's up to you to choose your tools and starter packs and\nwhatnot.\u003c/p\u003e\n\u003ch2 id=\"footnote-4-what-does-it-look-like-when-you-compile-with-tsc\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#footnote-4-what-does-it-look-like-when-you-compile-with-tsc\"\u003e\u003ca href=\"#footnote-4-what-does-it-look-like-when-you-compile-with-tsc\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eFootnote 4: What does it look like when you compile with tsc?\u003c/h2\u003e\n\u003cp\u003eWhen I refer to compiling with tsc above, I compile a \u003ccode\u003esrc\u003c/code\u003e directory into a\n\u003ccode\u003edist\u003c/code\u003e directory\u003c/p\u003e\n\u003cp\u003eSo if I have:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003esrc/index.ts\nsrc/util.ts\nsrc/components/Button.ts\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eRunning \u003ccode\u003etsc\u003c/code\u003e will output:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003edist/index.js\ndist/index.d.ts\ndist/index.js.map\ndist/util.js\ndist/util.d.ts\ndist/util.js.map\ndist/components/Button.js\ndist/components/Button.d.ts\ndist/components/Button.js.map\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThen, the \u003ccode\u003edist\u003c/code\u003e and \u003ccode\u003esrc\u003c/code\u003e directories are published to npm which enables the\n\u003ccode\u003esourceMaps\u003c/code\u003e to work.\u003c/p\u003e\n\u003cp\u003eNote: We do not need to explicitly say where the typescript types are with\n\"types\" in \u003ccode\u003epackage.json\u003c/code\u003e, many starter packs do this but it is unneeded for\nthis package as the d.ts files are automatically found.\u003c/p\u003e\n\u003cp\u003eSee \u003ca href=\"https://cmdcolin.github.io/posts/2021-12-31-npm-package\"\u003ehttps://cmdcolin.github.io/posts/2021-12-31-npm-package\u003c/a\u003e for my article on\ncreating a typescript package for npm\u003c/p\u003e\n\u003ch2 id=\"footnote-5-other-things-people-recommend\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#footnote-5-other-things-people-recommend\"\u003e\u003ca href=\"#footnote-5-other-things-people-recommend\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eFootnote 5: Other things people recommend\u003c/h2\u003e\n\u003cp\u003eOther things people recommend in the starter pack threads\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003edeno\u003c/code\u003e - not clear to me how this helps when deploying to npm, but I still\ngotta try deno\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ets-node \u003c/code\u003e - not clear to me how this helps when deploying to npm\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003enx\u003c/code\u003e - heavy monorepo-based solution\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eelm\u003c/code\u003e - that's just a different thing\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eTypescript-Node-Starter\u003c/code\u003e -\n\u003ca href=\"https://github.com/microsoft/TypeScript-Node-Starter\"\u003ehttps://github.com/microsoft/TypeScript-Node-Starter\u003c/a\u003e - not a library, full\nstack framework\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ejoystick\u003c/code\u003e - \u003ca href=\"https://github.com/CheatCode/joystick\"\u003ehttps://github.com/CheatCode/joystick\u003c/a\u003e - not a library, full stack\nframework\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"footnote-6\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#footnote-6\"\u003e\u003ca href=\"#footnote-6\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eFootnote 6:\u003c/h2\u003e\n\u003cp\u003eSimilar things happen if you take on dependencies of starter kits like\n\u003ccode\u003ecreate-react-app\u003c/code\u003e. You become very committed to their particular way of doing\nthings, and can only modify their config with things like \u003ccode\u003erescripts\u003c/code\u003e, \u003ccode\u003ecraco\u003c/code\u003e\nor \u003ccode\u003erewired\u003c/code\u003e. If you crafted your setup with just \u003ccode\u003ewebpack\u003c/code\u003e, you may not be so\ntied down. But, I still use things like \u003ccode\u003ecreate-react-app\u003c/code\u003e because they do seem\nto help me significantly. Now though, the tide seems to be turning other\ndirections like next.js which can do static site generation at a basic level and\nextend to multiple pages more easily.\u003c/p\u003e\n\u003ch2 id=\"footnote-7\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#footnote-7\"\u003e\u003ca href=\"#footnote-7\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eFootnote 7:\u003c/h2\u003e\n\u003cp\u003eYou may not even need \u003ccode\u003etsc\u003c/code\u003e to compile your dist folder. You can literally\npublish your source \u003ccode\u003e.js\u003c/code\u003e files as-is to NPM. This suggestion comes from\n@trevmanz \u003ca href=\"https://twitter.com/trevmanz/status/1534962190008172545\"\u003e1\u003c/a\u003e\n\u003ca href=\"https://twitter.com/trevmanz/status/1534962940348092417\"\u003e2\u003c/a\u003e. I don't personally\nuse this technique yet but there are many users with this workflow\u003c/p\u003e\n\u003cp\u003eAn interesting thing is you can write in \u003ccode\u003e.js\u003c/code\u003e but still get \u003ccode\u003etypescript\u003c/code\u003e to get\ntype checking using \u003ccode\u003ejsdoc\u003c/code\u003e, just use \u003ccode\u003eallowJs\u003c/code\u003e/\u003ccode\u003echeckJs\u003c/code\u003e flags in\n\u003ccode\u003etsconfig.json\u003c/code\u003e\u003c/p\u003e\n\u003ch2 id=\"footnote-8\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#footnote-8\"\u003e\u003ca href=\"#footnote-8\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eFootnote 8:\u003c/h2\u003e\n\u003cp\u003eWhat about React? Bundlers not needed, and not even babel is needed: you can\ncode your library as in \u003ccode\u003ejsx\u003c/code\u003e or \u003ccode\u003etsx\u003c/code\u003e files and use \u003ccode\u003etsc\u003c/code\u003e to compile it to\nReact.createElement statements or other jsx transforms.\u003c/p\u003e"])</script><script>self.__next_f.push([1,"a:[\"$\",\"article\",null,{\"children\":[[\"$\",\"div\",null,{\"children\":[[\"$\",\"h1\",null,{\"children\":\"You may not need a bundler for your NPM library\"}],[\"$\",\"h4\",null,{\"children\":\"2022-05-27\"}]]}],[\"$\",\"div\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$b\"}}],[\"$\",\"$Lc\",null,{}]]}]\n4:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"You may not need a bundler for your NPM library\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"A blog\"}],[\"$\",\"meta\",\"3\",{\"name\":\"viewport\",\"content\":\"width=device-w"])</script><script>self.__next_f.push([1,"idth, initial-scale=1\"}],[\"$\",\"link\",\"4\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"128x128\"}]]\n9:null\n"])</script></body></html>