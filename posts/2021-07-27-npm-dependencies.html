<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/css/b91f195cb0d427e8.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-446ef0bde4e4a401.js"/><script src="/_next/static/chunks/4bd1b696-5b771028f2b6de5d.js" async=""></script><script src="/_next/static/chunks/684-1e0e459a7d2479b8.js" async=""></script><script src="/_next/static/chunks/main-app-289de56c66005406.js" async=""></script><script src="/_next/static/chunks/874-cc77e63bbbcd39b2.js" async=""></script><script src="/_next/static/chunks/app/page-5d40f192aa75eac6.js" async=""></script><script src="/_next/static/chunks/app/posts/%5Bid%5D/page-ea4ed377e9c48f28.js" async=""></script><title>Do you understand your NPM dependencies?</title><meta name="description" content="A blog"/><script>document.querySelectorAll('body link[rel="icon"], body link[rel="apple-touch-icon"]').forEach(el => document.head.appendChild(el))</script><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body><div class="mb-8"><a href="/">Misc scribbles</a></div><div class="lg:w-1/2 m-auto"><div><h1>Do you understand your NPM dependencies?</h1><h4>2021-07-27</h4></div><div><p>You are writing a library...or you are writing an app and you want to publish
some of the components of it as a library...</p>
<p>Here are some questions in the form of comments</p>
<ul>
<li>
<p>Did you realize that your yarn.lock will be ignored for anyone who installs
your libraries?</p>
</li>
<li>
<p>Did you realize this means that your perfectly running test suite with your
yarn.lock could be a failing case for consumers of your library unless you
don’t use semver strings like ^1.0.0 and just hardcode it to 1.0.0?</p>
</li>
<li>
<p>Did you realize the default of ^1.0.0 automatically gets minor version bumps
which are often fairly substantial changes, e.g. even breaking possibly?</p>
</li>
<li>
<p>Did you know that larger libraries like @material-ui/core don’t like to bump
their major version all the time for example so large changes are often made
to the minor version?</p>
</li>
<li>
<p>Did you know if you run <code>yarn upgrade</code>, it may update what is in your
yarn.lock file but will not update what is in your package.json?</p>
</li>
<li>
<p>Did you realize that this means that if you depend on the results of running
<code>yarn upgrade</code> e.g. it gave you a bugfix, you could be shipping buggy code to
consumers of your library?</p>
</li>
</ul>
<p>Just something to be aware of! You can always ride the dragon and accept these
minor breakages from semver bumps, but it can introduce some issues for your
consumers</p>
<p>Random fun thing: Adding a yarn package can even downgrade some other packages.
For example if you have ^6.0.0 in your package.json, you yarn upgrade it so in
the lockfile it says 6.1.0 but then later install another library that requires
a hard 6.0.1, yarn will decide to downgrade you to 6.0.1 (it will not have a
duplicate entry in yarn.lock, just that the 6.1.0 in the yarn.lock will
downgrade to 6.0.1)</p></div><div class="mt-5"></div></div><!--$--><!--/$--><!--$--><!--/$--><footer class="mt-16"><a class="m-2" href="/">Home</a><a class="m-2" href="/archive">Blog archive</a><a class="m-2" href="https://github.com/cmdcolin/">Github</a><a class="m-2" href="/projects">Projects</a><a class="m-2" href="/books">Books</a><a class="m-2" href="/about">About</a><a class="m-2" href="/rss.xml">RSS</a></footer><script src="/_next/static/chunks/webpack-446ef0bde4e4a401.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[6874,[\"874\",\"static/chunks/874-cc77e63bbbcd39b2.js\",\"974\",\"static/chunks/app/page-5d40f192aa75eac6.js\"],\"\"]\n3:I[7555,[],\"\"]\n4:I[1295,[],\"\"]\n6:I[9665,[],\"MetadataBoundary\"]\n8:I[9665,[],\"OutletBoundary\"]\nb:I[4911,[],\"AsyncMetadataOutlet\"]\nd:I[9665,[],\"ViewportBoundary\"]\nf:I[6614,[],\"\"]\n:HL[\"/_next/static/css/b91f195cb0d427e8.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"OIr7CjDNRmieFsNRHbAxC\",\"p\":\"\",\"c\":[\"\",\"posts\",\"2021-07-27-npm-dependencies\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"posts\",{\"children\":[[\"id\",\"2021-07-27-npm-dependencies\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/b91f195cb0d427e8.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"children\":[[\"$\",\"div\",null,{\"className\":\"mb-8\",\"children\":[\"$\",\"$L2\",null,{\"href\":\"/\",\"children\":\"Misc scribbles\"}]}],[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}],[\"$\",\"footer\",null,{\"className\":\"mt-16\",\"children\":[[\"$\",\"$L2\",null,{\"className\":\"m-2\",\"href\":\"/\",\"children\":\"Home\"}],[\"$\",\"$L2\",null,{\"className\":\"m-2\",\"href\":\"/archive\",\"children\":\"Blog archive\"}],[\"$\",\"$L2\",null,{\"className\":\"m-2\",\"href\":\"https://github.com/cmdcolin/\",\"children\":\"Github\"}],[\"$\",\"$L2\",null,{\"className\":\"m-2\",\"href\":\"/projects\",\"children\":\"Projects\"}],[\"$\",\"$L2\",null,{\"className\":\"m-2\",\"href\":\"/books\",\"children\":\"Books\"}],[\"$\",\"$L2\",null,{\"className\":\"m-2\",\"href\":\"/about\",\"children\":\"About\"}],[\"$\",\"$L2\",null,{\"className\":\"m-2\",\"href\":\"/rss.xml\",\"children\":\"RSS\"}]]}]]}]}]]}],{\"children\":[\"posts\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"id\",\"2021-07-27-npm-dependencies\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",[\"$\",\"$L6\",null,{\"children\":\"$L7\"}],null,[\"$\",\"$L8\",null,{\"children\":[\"$L9\",\"$La\",[\"$\",\"$Lb\",null,{\"promise\":\"$@c\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"sv1uSHL0oKx4ZxiQTpSZ_\",{\"children\":[[\"$\",\"$Ld\",null,{\"children\":\"$Le\"}],null]}],null]}],false]],\"m\":\"$undefined\",\"G\":[\"$f\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"10:\"$Sreact.suspense\"\n11:I[4911,[],\"AsyncMetadata\"]\n7:[\"$\",\"$10\",null,{\"fallback\":null,\"children\":[\"$\",\"$L11\",null,{\"promise\":\"$@12\"}]}]\n"])</script><script>self.__next_f.push([1,"a:null\n"])</script><script>self.__next_f.push([1,"e:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n9:null\n"])</script><script>self.__next_f.push([1,"14:I[1401,[\"880\",\"static/chunks/app/posts/%5Bid%5D/page-ea4ed377e9c48f28.js\"],\"default\"]\n13:T74f,\u003cp\u003eYou are writing a library...or you are writing an app and you want to publish\nsome of the components of it as a library...\u003c/p\u003e\n\u003cp\u003eHere are some questions in the form of comments\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eDid you realize that your yarn.lock will be ignored for anyone who installs\nyour libraries?\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDid you realize this means that your perfectly running test suite with your\nyarn.lock could be a failing case for consumers of your library unless you\ndon’t use semver strings like ^1.0.0 and just hardcode it to 1.0.0?\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDid you realize the default of ^1.0.0 automatically gets minor version bumps\nwhich are often fairly substantial changes, e.g. even breaking possibly?\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDid you know that larger libraries like @material-ui/core don’t like to bump\ntheir major version all the time for example so large changes are often made\nto the minor version?\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDid you know if you run \u003ccode\u003eyarn upgrade\u003c/code\u003e, it may update what is in your\nyarn.lock file but will not update what is in your package.json?\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDid you realize that this means that if you depend on the results of running\n\u003ccode\u003eyarn upgrade\u003c/code\u003e e.g. it gave you a bugfix, you could be shipping buggy code to\nconsumers of your library?\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eJust something to be aware of! You can always ride the dragon and accept these\nminor breakages from semver bumps, but it can introduce some issues for your\nconsumers\u003c/p\u003e\n\u003cp\u003eRandom fun thing: Adding a yarn package can even downgrade some other packages.\nFor example if you have ^6.0.0 in your package.json, you yarn upgrade it so in\nthe lockfile it says 6.1.0 but then later install another library that requires\na hard 6.0.1, yarn will decide to downgrade you to 6.0.1 (it will not have a\nduplicate entry in yarn.lock, just that the 6.1.0 in the yarn.lock will\ndowngrade to 6.0.1)\u003c/p\u003e5:[\"$\",\"div\",null,{\"className\":\"lg:w-1/2 m-auto\",\"children\":[[\"$\",\"div\",null,{\"c"])</script><script>self.__next_f.push([1,"hildren\":[[\"$\",\"h1\",null,{\"children\":\"Do you understand your NPM dependencies?\"}],[\"$\",\"h4\",null,{\"children\":\"2021-07-27\"}]]}],[\"$\",\"div\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$13\"}}],[\"$\",\"$L14\",null,{}]]}]\n"])</script><script>self.__next_f.push([1,"12:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"Do you understand your NPM dependencies?\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"A blog\"}]],\"error\":null,\"digest\":\"$undefined\"}\nc:{\"metadata\":\"$12:metadata\",\"error\":null,\"digest\":\"$undefined\"}\n"])</script></body></html>