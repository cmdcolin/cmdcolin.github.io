1:HL["/_next/static/css/97dc5fe527f5d592.css","style",{"crossOrigin":""}]
0:["cBymwiTeb3Y8PR_jQwD_q",[[["",{"children":["posts",{"children":[["id","2016-11-10","d"],{"children":["__PAGE__?{\"id\":\"2016-11-10\"}",{}]}]}]},"$undefined","$undefined",true],"$L2",[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/97dc5fe527f5d592.css","precedence":"next","crossOrigin":""}]],"$L3"]]]]
4:I[8326,["326","static/chunks/326-f70436363102ecf4.js","931","static/chunks/app/page-0c1302a539e2db94.js"],""]
5:I[6954,[],""]
6:I[7264,[],""]
2:[null,["$","html",null,{"lang":"en","children":["$","body",null,{"children":[["$","div",null,{"style":{"marginBottom":100},"children":["$","$L4",null,{"href":"/","children":"Misc scribbles"}]}],["$","$L5",null,{"parallelRouterKey":"children","segmentPath":["children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":"404"}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],"notFoundStyles":[],"childProp":{"current":["$","$L5",null,{"parallelRouterKey":"children","segmentPath":["children","posts","children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$L5",null,{"parallelRouterKey":"children","segmentPath":["children","posts","children",["id","2016-11-10","d"],"children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$L7","$L8",null],"segment":"__PAGE__?{\"id\":\"2016-11-10\"}"},"styles":null}],"segment":["id","2016-11-10","d"]},"styles":null}],"segment":"posts"},"styles":null}],["$","footer",null,{"style":{"marginTop":100},"children":[["$","$L4",null,{"href":"/","children":"Home"}],["$","$L4",null,{"href":"/archive","children":"Blog archive"}],["$","$L4",null,{"href":"https://github.com/cmdcolin/","children":"Github"}],["$","$L4",null,{"href":"https://twitter.com/cmdcolin","children":"Twitter"}],["$","$L4",null,{"href":"/projects","children":"Projects"}]," ",["$","$L4",null,{"href":"/photos","children":"Photos"}],["$","$L4",null,{"href":"/books","children":"Books"}],["$","$L4",null,{"href":"/about","children":"About"}]]}]]}]}],null]
a:I[5854,["722","static/chunks/app/posts/%5Bid%5D/page-64ff32a4d1c61109.js"],""]
9:T3389,<p>I have been very impressed with peoples creativity and willingness to dig into
all the details of JBrowse to customize it's features. One great way to do this
in a modular way is to create a "JBrowse plugin". This concept sounds hard but
you can set up a simple couple of files and refresh your browser and it will
"just work"!</p>
<h2 id="introduction-to-the-plugin-mindset"><a aria-hidden="true" tabindex="-1" href="#introduction-to-the-plugin-mindset"><a href="#introduction-to-the-plugin-mindset" style="margin-right: 10px">#</a></a>Introduction to the plugin mindset</h2>
<p>In a plugin, you can define new things like custom track types, custom adaptors
to new file types, new track selectors, or something really different. A key
insight about the custom types of tracks and things though is that you can put
the name of your new custom class in the jbrowse config file which will then
find the code in your plugin and run it. Plugins can do other things, but the
ability to just swap out track types or other components in the config file is a
great benefit.</p>
<h2 id="a-scenario"><a aria-hidden="true" tabindex="-1" href="#a-scenario"><a href="#a-scenario" style="margin-right: 10px">#</a></a>A scenario</h2>
<p>One example that was talked about on the mailing list might involve adding new
menu items for a given track. We might consider a plugin that defines a custom
track type to add that functionality.</p>
<p>Basically, we can use object- oriented principles to "inherit" from some
existing track type like CanvasFeatures and then extend its functionality by
overriding the functions.</p>
<p>If you are not familiar with object-oriented javascript, dojo makes it pretty
easy (but, especially get a background on this if you need to, see footnotes
below).</p>
<p>We can inherit a new track type by using the "define" function to include the
dependencies needed in a file, and they are listed in an array at the top of
your file.</p>
<p>Then the "declare" function creates a new class. The first argument to declare
is the is your parent class, like CanvasFeatures, and we type "return declare"
because we are returning our new track class from the module.</p>
<pre class="shiki poimandres" style="background-color: #1b1e28" tabindex="0"><code><span class="line"><span style="color: #E4F0FBD0">define</span><span style="color: #A6ACCD">([</span><span style="color: #A6ACCD">'</span><span style="color: #5DE4C7">dojo/_base/declare</span><span style="color: #A6ACCD">'</span><span style="color: #A6ACCD">, </span><span style="color: #A6ACCD">'</span><span style="color: #5DE4C7">JBrowse/View/Track/CanvasFeatures</span><span style="color: #A6ACCD">'</span><span style="color: #A6ACCD">], </span><span style="color: #91B4D5">function</span><span style="color: #A6ACCD"> (</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #E4F0FB">declare</span><span style="color: #A6ACCD">,</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #E4F0FB">CanvasFeatures</span><span style="color: #A6ACCD">,</span></span>
<span class="line"><span style="color: #A6ACCD">) {</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #5DE4C7C0">return</span><span style="color: #A6ACCD"> </span><span style="color: #E4F0FBD0">declare</span><span style="color: #A6ACCD">(</span><span style="color: #E4F0FB">CanvasFeatures</span><span style="color: #A6ACCD">, {</span></span>
<span class="line"><span style="color: #E4F0FB">    </span><span style="color: #ADD7FF">_trackMenuOptions</span><span style="color: #A6ACCD">:</span><span style="color: #ADD7FF"> </span><span style="color: #91B4D5">function</span><span style="color: #ADD7FF"> </span><span style="color: #A6ACCD">()</span><span style="color: #ADD7FF"> </span><span style="color: #A6ACCD">{</span></span>
<span class="line"><span style="color: #ADD7FF">      </span><span style="color: #91B4D5">var</span><span style="color: #ADD7FF"> </span><span style="color: #E4F0FB">opts</span><span style="color: #ADD7FF"> </span><span style="color: #91B4D5">=</span><span style="color: #ADD7FF"> </span><span style="color: #5DE4C7; font-style: italic">this</span><span style="color: #A6ACCD">.</span><span style="color: #E4F0FBD0">inherited</span><span style="color: #A6ACCD">(</span><span style="color: #ADD7FF; font-style: italic">arguments</span><span style="color: #A6ACCD">)</span><span style="color: #ADD7FF"> </span><span style="color: #767C9DB0; font-style: italic">//call the parent classes function</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ADD7FF">      </span><span style="color: #E4F0FB">opts</span><span style="color: #A6ACCD">.</span><span style="color: #E4F0FBD0">push</span><span style="color: #A6ACCD">(</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #767C9DB0; font-style: italic">// add an extra menu item to the array returned from parent class function</span></span>
<span class="line"><span style="color: #ADD7FF">        </span><span style="color: #A6ACCD">{</span></span>
<span class="line"><span style="color: #E4F0FB">          </span><span style="color: #ADD7FF">label</span><span style="color: #A6ACCD">:</span><span style="color: #ADD7FF"> </span><span style="color: #A6ACCD">'</span><span style="color: #5DE4C7">Custom item</span><span style="color: #A6ACCD">'</span><span style="color: #A6ACCD">,</span></span>
<span class="line"><span style="color: #E4F0FB">          </span><span style="color: #ADD7FF">type</span><span style="color: #A6ACCD">:</span><span style="color: #ADD7FF"> </span><span style="color: #A6ACCD">'</span><span style="color: #5DE4C7">dijit/CheckedMenuItem</span><span style="color: #A6ACCD">'</span><span style="color: #A6ACCD">,</span></span>
<span class="line"><span style="color: #E4F0FB">          </span><span style="color: #ADD7FF">onClick</span><span style="color: #A6ACCD">:</span><span style="color: #ADD7FF"> </span><span style="color: #91B4D5">function</span><span style="color: #ADD7FF"> </span><span style="color: #A6ACCD">(</span><span style="color: #E4F0FB">event</span><span style="color: #A6ACCD">)</span><span style="color: #ADD7FF"> </span><span style="color: #A6ACCD">{</span></span>
<span class="line"><span style="color: #ADD7FF">            </span><span style="color: #E4F0FB">console</span><span style="color: #A6ACCD">.</span><span style="color: #E4F0FBD0">log</span><span style="color: #A6ACCD">(</span><span style="color: #A6ACCD">'</span><span style="color: #5DE4C7">Clicked</span><span style="color: #A6ACCD">'</span><span style="color: #A6ACCD">)</span></span>
<span class="line"><span style="color: #ADD7FF">          </span><span style="color: #A6ACCD">},</span></span>
<span class="line"><span style="color: #E4F0FB">          </span><span style="color: #ADD7FF">iconClass</span><span style="color: #A6ACCD">:</span><span style="color: #ADD7FF"> </span><span style="color: #A6ACCD">'</span><span style="color: #5DE4C7">dijitIconPackage</span><span style="color: #A6ACCD">'</span><span style="color: #A6ACCD">,</span></span>
<span class="line"><span style="color: #E4F0FB">        </span><span style="color: #A6ACCD">},</span></span>
<span class="line"><span style="color: #ADD7FF">      </span><span style="color: #A6ACCD">)</span></span>
<span class="line"><span style="color: #ADD7FF">      </span><span style="color: #5DE4C7C0">return</span><span style="color: #ADD7FF"> </span><span style="color: #E4F0FB">opts</span></span>
<span class="line"><span style="color: #ADD7FF">    </span><span style="color: #A6ACCD">},</span></span>
<span class="line"><span style="color: #E4F0FB">  </span><span style="color: #A6ACCD">})</span></span>
<span class="line"><span style="color: #A6ACCD">})</span></span></code></pre>
<p>Code listing 1. an example custom track type, MyTrack.js, that adds an extra
track menu item</p>
<h2 id="now-how-do-we-make-this-a-plugin"><a aria-hidden="true" tabindex="-1" href="#now-how-do-we-make-this-a-plugin"><a href="#now-how-do-we-make-this-a-plugin" style="margin-right: 10px">#</a></a>Now how do we make this a plugin?</h2>
<p>In the above section, we created a new track subclass with a custom menu option.
How do we use this track? We want to turn it into part of afine the boilerplate
code from the
<a href="http://gmod.org/wiki/JBrowse_Configuration_Guide#Writing_JBrowse_Plugins">Writing plugins</a>
guide.</p>
<pre class="shiki poimandres" style="background-color: #1b1e28" tabindex="0"><code><span class="line"><span style="color: #E4F0FBD0">define</span><span style="color: #A6ACCD">([</span><span style="color: #A6ACCD">'</span><span style="color: #5DE4C7">dojo/_base/declare</span><span style="color: #A6ACCD">'</span><span style="color: #A6ACCD">, </span><span style="color: #A6ACCD">'</span><span style="color: #5DE4C7">JBrowse/Plugin</span><span style="color: #A6ACCD">'</span><span style="color: #A6ACCD">], </span><span style="color: #91B4D5">function</span><span style="color: #A6ACCD"> (</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #E4F0FB">declare</span><span style="color: #A6ACCD">,</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #E4F0FB">JBrowsePlugin</span><span style="color: #A6ACCD">,</span></span>
<span class="line"><span style="color: #A6ACCD">) {</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #5DE4C7C0">return</span><span style="color: #A6ACCD"> </span><span style="color: #E4F0FBD0">declare</span><span style="color: #A6ACCD">(</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #E4F0FB">JBrowsePlugin</span><span style="color: #A6ACCD">, </span><span style="color: #767C9DB0; font-style: italic">// this line says our plugin's main.js derives from the "JBrowse/Plugin" base class</span></span>
<span class="line"><span style="color: #A6ACCD">    {</span></span>
<span class="line"><span style="color: #E4F0FB">      </span><span style="color: #ADD7FF">constructor</span><span style="color: #A6ACCD">:</span><span style="color: #ADD7FF"> </span><span style="color: #91B4D5">function</span><span style="color: #ADD7FF"> </span><span style="color: #A6ACCD">(</span><span style="color: #E4F0FB">args</span><span style="color: #A6ACCD">)</span><span style="color: #ADD7FF"> </span><span style="color: #A6ACCD">{</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #767C9DB0; font-style: italic">//don't necessarily have to do any initializing here, but you</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #767C9DB0; font-style: italic">//can get a handle to various jbrowse components if any initialization</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #767C9DB0; font-style: italic">//is needed from the args.browser variable</span></span>
<span class="line"><span style="color: #ADD7FF">      </span><span style="color: #A6ACCD">},</span></span>
<span class="line"><span style="color: #E4F0FB">    </span><span style="color: #A6ACCD">},</span></span>
<span class="line"><span style="color: #A6ACCD">  )</span></span>
<span class="line"><span style="color: #A6ACCD">})</span></span></code></pre>
<p>Code listing 2. Our plugin's main.js</p>
<p>After this, we create the plugin directory structure</p>
<blockquote>
<p>jbrowse/plugins/MyPlugin</p>
<blockquote>
<p>jbrowse/plugins/MyPlugin/js</p>
<blockquote>
<p>jbrowse/plugins/MyPlugin/js/main.js</p>
<p>jbrowse/plugins/MyPlugin/js/MyTrack.js</p>
</blockquote>
</blockquote>
</blockquote>
<p>Then we can add our new plugin to a config file like <code>jbrowse_conf.json</code> as
<code>"plugins": ["MyPlugin"]</code> and then make a track in <code>trackList.json</code> have
<code>"type": "MyPlugin/MyTrack"</code> instead of for example <code>"type": "CanvasFeatures"</code>.
That will tell jbrowse to load the <code>MyTrack</code> class from your plugin instead of
the normal <code>CanvasFeatures</code> class.</p>
<p>That's about it!</p>
<p>Note that the <code>bin/new-plugin.pl</code> script can automatically initialize some of
this directory structure too. Try running <code>bin/new-plugin.pl MyPlugin</code> and see
what happens.</p>
<h3 id="footnotes"><a aria-hidden="true" tabindex="-1" href="#footnotes"><a href="#footnotes" style="margin-right: 10px">#</a></a>Footnotes:</h3>
<p>It is important to understand the module format (AMD) which is what the "define"
function is about and the dojo way of defining classes using the "declare"
function. Together, this allows the dojo to create object-oriented programs that
are modular in javascript. See
<a href="http://dojotoolkit.org/reference-guide/1.10/dojo/_base/declare.html">http://dojotoolkit.org/reference-guide/1.10/dojo/_base/declare.html</a> and
<a href="http://dojotoolkit.org/documentation/tutorials/1.9/modules/">http://dojotoolkit.org/documentation/tutorials/1.9/modules/</a> (understanding this
helps you understand the "preamble" for declaring a jbrowse plugin)</p>8:["$","article",null,{"children":[["$","div",null,{"children":[["$","h1",null,{"children":"Creating a JBrowse plugin"}],["$","h4",null,{"children":"2016-11-10"}]]}],["$","div",null,{"dangerouslySetInnerHTML":{"__html":"$9"}}],["$","$La",null,{}]]}]
3:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","title","2",{"children":"Creating a JBrowse plugin"}],["$","meta","3",{"name":"description","content":"A blog"}],["$","link","4",{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"128x128"}]]
7:null
