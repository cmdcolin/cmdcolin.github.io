<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/css/97dc5fe527f5d592.css" crossorigin="" data-precedence="next"/><link rel="preload" href="/_next/static/chunks/webpack-19ac6e418b88dab7.js" as="script" fetchPriority="low" crossorigin=""/><script src="/_next/static/chunks/fd9d1056-e43fdc25c1167267.js" async="" crossorigin=""></script><script src="/_next/static/chunks/864-f0261ea346b46dc5.js" async="" crossorigin=""></script><script src="/_next/static/chunks/main-app-fe7c20d256316568.js" async="" crossorigin=""></script><title>Creating a JBrowse plugin</title><meta name="description" content="A blog"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="128x128"/><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" crossorigin="" noModule=""></script></head><body><div style="margin-bottom:100px"><a href="/">Misc scribbles</a></div><article><div><h1>Creating a JBrowse plugin</h1><h4>2016-11-10</h4></div><div><p>I have been very impressed with peoples creativity and willingness to dig into
all the details of JBrowse to customize it's features. One great way to do this
in a modular way is to create a "JBrowse plugin". This concept sounds hard but
you can set up a simple couple of files and refresh your browser and it will
"just work"!</p>
<h2 id="introduction-to-the-plugin-mindset"><a aria-hidden="true" tabindex="-1" href="#introduction-to-the-plugin-mindset"><a href="#introduction-to-the-plugin-mindset" style="margin-right: 10px">#</a></a>Introduction to the plugin mindset</h2>
<p>In a plugin, you can define new things like custom track types, custom adaptors
to new file types, new track selectors, or something really different. A key
insight about the custom types of tracks and things though is that you can put
the name of your new custom class in the jbrowse config file which will then
find the code in your plugin and run it. Plugins can do other things, but the
ability to just swap out track types or other components in the config file is a
great benefit.</p>
<h2 id="a-scenario"><a aria-hidden="true" tabindex="-1" href="#a-scenario"><a href="#a-scenario" style="margin-right: 10px">#</a></a>A scenario</h2>
<p>One example that was talked about on the mailing list might involve adding new
menu items for a given track. We might consider a plugin that defines a custom
track type to add that functionality.</p>
<p>Basically, we can use object- oriented principles to "inherit" from some
existing track type like CanvasFeatures and then extend its functionality by
overriding the functions.</p>
<p>If you are not familiar with object-oriented javascript, dojo makes it pretty
easy (but, especially get a background on this if you need to, see footnotes
below).</p>
<p>We can inherit a new track type by using the "define" function to include the
dependencies needed in a file, and they are listed in an array at the top of
your file.</p>
<p>Then the "declare" function creates a new class. The first argument to declare
is the is your parent class, like CanvasFeatures, and we type "return declare"
because we are returning our new track class from the module.</p>
<pre class="shiki poimandres" style="background-color: #1b1e28" tabindex="0"><code><span class="line"><span style="color: #E4F0FBD0">define</span><span style="color: #A6ACCD">([</span><span style="color: #A6ACCD">'</span><span style="color: #5DE4C7">dojo/_base/declare</span><span style="color: #A6ACCD">'</span><span style="color: #A6ACCD">, </span><span style="color: #A6ACCD">'</span><span style="color: #5DE4C7">JBrowse/View/Track/CanvasFeatures</span><span style="color: #A6ACCD">'</span><span style="color: #A6ACCD">], </span><span style="color: #91B4D5">function</span><span style="color: #A6ACCD"> (</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #E4F0FB">declare</span><span style="color: #A6ACCD">,</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #E4F0FB">CanvasFeatures</span><span style="color: #A6ACCD">,</span></span>
<span class="line"><span style="color: #A6ACCD">) {</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #5DE4C7C0">return</span><span style="color: #A6ACCD"> </span><span style="color: #E4F0FBD0">declare</span><span style="color: #A6ACCD">(</span><span style="color: #E4F0FB">CanvasFeatures</span><span style="color: #A6ACCD">, {</span></span>
<span class="line"><span style="color: #E4F0FB">    </span><span style="color: #ADD7FF">_trackMenuOptions</span><span style="color: #A6ACCD">:</span><span style="color: #ADD7FF"> </span><span style="color: #91B4D5">function</span><span style="color: #ADD7FF"> </span><span style="color: #A6ACCD">()</span><span style="color: #ADD7FF"> </span><span style="color: #A6ACCD">{</span></span>
<span class="line"><span style="color: #ADD7FF">      </span><span style="color: #91B4D5">var</span><span style="color: #ADD7FF"> </span><span style="color: #E4F0FB">opts</span><span style="color: #ADD7FF"> </span><span style="color: #91B4D5">=</span><span style="color: #ADD7FF"> </span><span style="color: #5DE4C7; font-style: italic">this</span><span style="color: #A6ACCD">.</span><span style="color: #E4F0FBD0">inherited</span><span style="color: #A6ACCD">(</span><span style="color: #ADD7FF; font-style: italic">arguments</span><span style="color: #A6ACCD">)</span><span style="color: #ADD7FF"> </span><span style="color: #767C9DB0; font-style: italic">//call the parent classes function</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ADD7FF">      </span><span style="color: #E4F0FB">opts</span><span style="color: #A6ACCD">.</span><span style="color: #E4F0FBD0">push</span><span style="color: #A6ACCD">(</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #767C9DB0; font-style: italic">// add an extra menu item to the array returned from parent class function</span></span>
<span class="line"><span style="color: #ADD7FF">        </span><span style="color: #A6ACCD">{</span></span>
<span class="line"><span style="color: #E4F0FB">          </span><span style="color: #ADD7FF">label</span><span style="color: #A6ACCD">:</span><span style="color: #ADD7FF"> </span><span style="color: #A6ACCD">'</span><span style="color: #5DE4C7">Custom item</span><span style="color: #A6ACCD">'</span><span style="color: #A6ACCD">,</span></span>
<span class="line"><span style="color: #E4F0FB">          </span><span style="color: #ADD7FF">type</span><span style="color: #A6ACCD">:</span><span style="color: #ADD7FF"> </span><span style="color: #A6ACCD">'</span><span style="color: #5DE4C7">dijit/CheckedMenuItem</span><span style="color: #A6ACCD">'</span><span style="color: #A6ACCD">,</span></span>
<span class="line"><span style="color: #E4F0FB">          </span><span style="color: #ADD7FF">onClick</span><span style="color: #A6ACCD">:</span><span style="color: #ADD7FF"> </span><span style="color: #91B4D5">function</span><span style="color: #ADD7FF"> </span><span style="color: #A6ACCD">(</span><span style="color: #E4F0FB">event</span><span style="color: #A6ACCD">)</span><span style="color: #ADD7FF"> </span><span style="color: #A6ACCD">{</span></span>
<span class="line"><span style="color: #ADD7FF">            </span><span style="color: #E4F0FB">console</span><span style="color: #A6ACCD">.</span><span style="color: #E4F0FBD0">log</span><span style="color: #A6ACCD">(</span><span style="color: #A6ACCD">'</span><span style="color: #5DE4C7">Clicked</span><span style="color: #A6ACCD">'</span><span style="color: #A6ACCD">)</span></span>
<span class="line"><span style="color: #ADD7FF">          </span><span style="color: #A6ACCD">},</span></span>
<span class="line"><span style="color: #E4F0FB">          </span><span style="color: #ADD7FF">iconClass</span><span style="color: #A6ACCD">:</span><span style="color: #ADD7FF"> </span><span style="color: #A6ACCD">'</span><span style="color: #5DE4C7">dijitIconPackage</span><span style="color: #A6ACCD">'</span><span style="color: #A6ACCD">,</span></span>
<span class="line"><span style="color: #E4F0FB">        </span><span style="color: #A6ACCD">},</span></span>
<span class="line"><span style="color: #ADD7FF">      </span><span style="color: #A6ACCD">)</span></span>
<span class="line"><span style="color: #ADD7FF">      </span><span style="color: #5DE4C7C0">return</span><span style="color: #ADD7FF"> </span><span style="color: #E4F0FB">opts</span></span>
<span class="line"><span style="color: #ADD7FF">    </span><span style="color: #A6ACCD">},</span></span>
<span class="line"><span style="color: #E4F0FB">  </span><span style="color: #A6ACCD">})</span></span>
<span class="line"><span style="color: #A6ACCD">})</span></span></code></pre>
<p>Code listing 1. an example custom track type, MyTrack.js, that adds an extra
track menu item</p>
<h2 id="now-how-do-we-make-this-a-plugin"><a aria-hidden="true" tabindex="-1" href="#now-how-do-we-make-this-a-plugin"><a href="#now-how-do-we-make-this-a-plugin" style="margin-right: 10px">#</a></a>Now how do we make this a plugin?</h2>
<p>In the above section, we created a new track subclass with a custom menu option.
How do we use this track? We want to turn it into part of afine the boilerplate
code from the
<a href="http://gmod.org/wiki/JBrowse_Configuration_Guide#Writing_JBrowse_Plugins">Writing plugins</a>
guide.</p>
<pre class="shiki poimandres" style="background-color: #1b1e28" tabindex="0"><code><span class="line"><span style="color: #E4F0FBD0">define</span><span style="color: #A6ACCD">([</span><span style="color: #A6ACCD">'</span><span style="color: #5DE4C7">dojo/_base/declare</span><span style="color: #A6ACCD">'</span><span style="color: #A6ACCD">, </span><span style="color: #A6ACCD">'</span><span style="color: #5DE4C7">JBrowse/Plugin</span><span style="color: #A6ACCD">'</span><span style="color: #A6ACCD">], </span><span style="color: #91B4D5">function</span><span style="color: #A6ACCD"> (</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #E4F0FB">declare</span><span style="color: #A6ACCD">,</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #E4F0FB">JBrowsePlugin</span><span style="color: #A6ACCD">,</span></span>
<span class="line"><span style="color: #A6ACCD">) {</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #5DE4C7C0">return</span><span style="color: #A6ACCD"> </span><span style="color: #E4F0FBD0">declare</span><span style="color: #A6ACCD">(</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #E4F0FB">JBrowsePlugin</span><span style="color: #A6ACCD">, </span><span style="color: #767C9DB0; font-style: italic">// this line says our plugin's main.js derives from the "JBrowse/Plugin" base class</span></span>
<span class="line"><span style="color: #A6ACCD">    {</span></span>
<span class="line"><span style="color: #E4F0FB">      </span><span style="color: #ADD7FF">constructor</span><span style="color: #A6ACCD">:</span><span style="color: #ADD7FF"> </span><span style="color: #91B4D5">function</span><span style="color: #ADD7FF"> </span><span style="color: #A6ACCD">(</span><span style="color: #E4F0FB">args</span><span style="color: #A6ACCD">)</span><span style="color: #ADD7FF"> </span><span style="color: #A6ACCD">{</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #767C9DB0; font-style: italic">//don't necessarily have to do any initializing here, but you</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #767C9DB0; font-style: italic">//can get a handle to various jbrowse components if any initialization</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #767C9DB0; font-style: italic">//is needed from the args.browser variable</span></span>
<span class="line"><span style="color: #ADD7FF">      </span><span style="color: #A6ACCD">},</span></span>
<span class="line"><span style="color: #E4F0FB">    </span><span style="color: #A6ACCD">},</span></span>
<span class="line"><span style="color: #A6ACCD">  )</span></span>
<span class="line"><span style="color: #A6ACCD">})</span></span></code></pre>
<p>Code listing 2. Our plugin's main.js</p>
<p>After this, we create the plugin directory structure</p>
<blockquote>
<p>jbrowse/plugins/MyPlugin</p>
<blockquote>
<p>jbrowse/plugins/MyPlugin/js</p>
<blockquote>
<p>jbrowse/plugins/MyPlugin/js/main.js</p>
<p>jbrowse/plugins/MyPlugin/js/MyTrack.js</p>
</blockquote>
</blockquote>
</blockquote>
<p>Then we can add our new plugin to a config file like <code>jbrowse_conf.json</code> as
<code>"plugins": ["MyPlugin"]</code> and then make a track in <code>trackList.json</code> have
<code>"type": "MyPlugin/MyTrack"</code> instead of for example <code>"type": "CanvasFeatures"</code>.
That will tell jbrowse to load the <code>MyTrack</code> class from your plugin instead of
the normal <code>CanvasFeatures</code> class.</p>
<p>That's about it!</p>
<p>Note that the <code>bin/new-plugin.pl</code> script can automatically initialize some of
this directory structure too. Try running <code>bin/new-plugin.pl MyPlugin</code> and see
what happens.</p>
<h3 id="footnotes"><a aria-hidden="true" tabindex="-1" href="#footnotes"><a href="#footnotes" style="margin-right: 10px">#</a></a>Footnotes:</h3>
<p>It is important to understand the module format (AMD) which is what the "define"
function is about and the dojo way of defining classes using the "declare"
function. Together, this allows the dojo to create object-oriented programs that
are modular in javascript. See
<a href="http://dojotoolkit.org/reference-guide/1.10/dojo/_base/declare.html">http://dojotoolkit.org/reference-guide/1.10/dojo/_base/declare.html</a> and
<a href="http://dojotoolkit.org/documentation/tutorials/1.9/modules/">http://dojotoolkit.org/documentation/tutorials/1.9/modules/</a> (understanding this
helps you understand the "preamble" for declaring a jbrowse plugin)</p></div><div style="margin-top:200px"></div></article><footer style="margin-top:100px"><a href="/">Home</a><a href="/archive">Blog archive</a><a href="https://github.com/cmdcolin/">Github</a><a href="https://twitter.com/cmdcolin">Twitter</a><a href="/projects">Projects</a> <a href="/photos">Photos</a><a href="/books">Books</a><a href="/about">About</a></footer><script src="/_next/static/chunks/webpack-19ac6e418b88dab7.js" crossorigin="" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/97dc5fe527f5d592.css\",\"style\",{\"crossOrigin\":\"\"}]\n0:\"$L2\"\n"])</script><script>self.__next_f.push([1,"3:I{\"id\":6054,\"chunks\":[\"272:static/chunks/webpack-19ac6e418b88dab7.js\",\"971:static/chunks/fd9d1056-e43fdc25c1167267.js\",\"864:static/chunks/864-f0261ea346b46dc5.js\"],\"name\":\"\",\"async\":false}\n5:I{\"id\":1729,\"chunks\":[\"272:static/chunks/webpack-19ac6e418b88dab7.js\",\"971:static/chunks/fd9d1056-e43fdc25c1167267.js\",\"864:static/chunks/864-f0261ea346b46dc5.js\"],\"name\":\"\",\"async\":false}\n6:I{\"id\":4724,\"chunks\":[\"724:static/chunks/724-f777e11942c9f205.js\",\"931:static/chunks/app/page-dc728b3619945451.js\"],\"name\":\"\",\"a"])</script><script>self.__next_f.push([1,"sync\":false}\n7:I{\"id\":1443,\"chunks\":[\"272:static/chunks/webpack-19ac6e418b88dab7.js\",\"971:static/chunks/fd9d1056-e43fdc25c1167267.js\",\"864:static/chunks/864-f0261ea346b46dc5.js\"],\"name\":\"\",\"async\":false}\n8:I{\"id\":8639,\"chunks\":[\"272:static/chunks/webpack-19ac6e418b88dab7.js\",\"971:static/chunks/fd9d1056-e43fdc25c1167267.js\",\"864:static/chunks/864-f0261ea346b46dc5.js\"],\"name\":\"\",\"async\":false}\n"])</script><script>self.__next_f.push([1,"2:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/97dc5fe527f5d592.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]],[\"$\",\"$L3\",null,{\"buildId\":\"tDkfGaT-pKESnHzYO60C7\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/posts/2016-11-10\",\"initialTree\":[\"\",{\"children\":[\"posts\",{\"children\":[[\"id\",\"2016-11-10\",\"d\"],{\"children\":[\"__PAGE__?{\\\"id\\\":\\\"2016-11-10\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialHead\":[false,\"$L4\"],\"globalErrorComponent\":\"$5\",\"children\":[null,[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"children\":[[\"$\",\"div\",null,{\"style\":{\"marginBottom\":100},\"children\":[\"$\",\"$L6\",null,{\"href\":\"/\",\"children\":\"Misc scribbles\"}]}],[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"childProp\":{\"current\":[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\",[\"id\",\"2016-11-10\",\"d\"],\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$L9\",\"$La\",null],\"segment\":\"__PAGE__?{\\\"id\\\":\\\"2016-11-10\\\"}\"},\"styles\":[]}],\"segment\":[\"id\",\"2016-11-10\",\"d\"]},\"styles\":[]}],\"segment\":\"posts\"},\"styles\":[]}],[\"$\",\"footer\",null,{\"style\":{\"marginTop\":100},\"children\":[[\"$\",\"$L6\",null,{\"href\":\"/\",\"children\":\"Home\"}],[\"$\",\"$L6\",null,{\"href\":\"/archive\",\"children\":\"Blog archive\"}],[\"$\",\"$L6\",null,{\"href\":\"https://github.com/cmdcolin/\",\"children\":\"Github\"}],[\"$\",\"$L6\",null,{\"href\":\"https://twitter.com/cmdcolin\",\"children\":\"Twitter\"}],[\"$\",\"$L6\",null,{\"href\":\"/projects\",\"children\":\"Projects\"}],\" \",[\"$\",\"$L6\",null,{\"href\":\"/photos\",\"children\":\"Photos\"}],[\"$\",\"$L6\",null,{\"href\":\"/books\",\"children\":\"Books\"}],[\"$\",\"$L6\",null,{\"href\":\"/about\",\"children\":\"About\"}]]}]]}]}],null]}]]\n"])</script><script>self.__next_f.push([1,"c:I{\"id\":2775,\"chunks\":[\"722:static/chunks/app/posts/[id]/page-cca14fd8141e3e22.js\"],\"name\":\"\",\"async\":false}\nb:T3389,"])</script><script>self.__next_f.push([1,"\u003cp\u003eI have been very impressed with peoples creativity and willingness to dig into\nall the details of JBrowse to customize it's features. One great way to do this\nin a modular way is to create a \"JBrowse plugin\". This concept sounds hard but\nyou can set up a simple couple of files and refresh your browser and it will\n\"just work\"!\u003c/p\u003e\n\u003ch2 id=\"introduction-to-the-plugin-mindset\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#introduction-to-the-plugin-mindset\"\u003e\u003ca href=\"#introduction-to-the-plugin-mindset\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eIntroduction to the plugin mindset\u003c/h2\u003e\n\u003cp\u003eIn a plugin, you can define new things like custom track types, custom adaptors\nto new file types, new track selectors, or something really different. A key\ninsight about the custom types of tracks and things though is that you can put\nthe name of your new custom class in the jbrowse config file which will then\nfind the code in your plugin and run it. Plugins can do other things, but the\nability to just swap out track types or other components in the config file is a\ngreat benefit.\u003c/p\u003e\n\u003ch2 id=\"a-scenario\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#a-scenario\"\u003e\u003ca href=\"#a-scenario\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eA scenario\u003c/h2\u003e\n\u003cp\u003eOne example that was talked about on the mailing list might involve adding new\nmenu items for a given track. We might consider a plugin that defines a custom\ntrack type to add that functionality.\u003c/p\u003e\n\u003cp\u003eBasically, we can use object- oriented principles to \"inherit\" from some\nexisting track type like CanvasFeatures and then extend its functionality by\noverriding the functions.\u003c/p\u003e\n\u003cp\u003eIf you are not familiar with object-oriented javascript, dojo makes it pretty\neasy (but, especially get a background on this if you need to, see footnotes\nbelow).\u003c/p\u003e\n\u003cp\u003eWe can inherit a new track type by using the \"define\" function to include the\ndependencies needed in a file, and they are listed in an array at the top of\nyour file.\u003c/p\u003e\n\u003cp\u003eThen the \"declare\" function creates a new class. The first argument to declare\nis the is your parent class, like CanvasFeatures, and we type \"return declare\"\nbecause we are returning our new track class from the module.\u003c/p\u003e\n\u003cpre class=\"shiki poimandres\" style=\"background-color: #1b1e28\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #E4F0FBD0\"\u003edefine\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e([\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e'\u003c/span\u003e\u003cspan style=\"color: #5DE4C7\"\u003edojo/_base/declare\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e'\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e, \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e'\u003c/span\u003e\u003cspan style=\"color: #5DE4C7\"\u003eJBrowse/View/Track/CanvasFeatures\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e'\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e], \u003c/span\u003e\u003cspan style=\"color: #91B4D5\"\u003efunction\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e (\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #E4F0FB\"\u003edeclare\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #E4F0FB\"\u003eCanvasFeatures\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #5DE4C7C0\"\u003ereturn\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e \u003c/span\u003e\u003cspan style=\"color: #E4F0FBD0\"\u003edeclare\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e(\u003c/span\u003e\u003cspan style=\"color: #E4F0FB\"\u003eCanvasFeatures\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e, {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #E4F0FB\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003e_trackMenuOptions\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003e \u003c/span\u003e\u003cspan style=\"color: #91B4D5\"\u003efunction\u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003e \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e()\u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003e \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #ADD7FF\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #91B4D5\"\u003evar\u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003e \u003c/span\u003e\u003cspan style=\"color: #E4F0FB\"\u003eopts\u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003e \u003c/span\u003e\u003cspan style=\"color: #91B4D5\"\u003e=\u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003e \u003c/span\u003e\u003cspan style=\"color: #5DE4C7; font-style: italic\"\u003ethis\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e.\u003c/span\u003e\u003cspan style=\"color: #E4F0FBD0\"\u003einherited\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e(\u003c/span\u003e\u003cspan style=\"color: #ADD7FF; font-style: italic\"\u003earguments\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e)\u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003e \u003c/span\u003e\u003cspan style=\"color: #767C9DB0; font-style: italic\"\u003e//call the parent classes function\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #ADD7FF\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #E4F0FB\"\u003eopts\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e.\u003c/span\u003e\u003cspan style=\"color: #E4F0FBD0\"\u003epush\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e(\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e        \u003c/span\u003e\u003cspan style=\"color: #767C9DB0; font-style: italic\"\u003e// add an extra menu item to the array returned from parent class function\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #ADD7FF\"\u003e        \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #E4F0FB\"\u003e          \u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003elabel\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003e \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e'\u003c/span\u003e\u003cspan style=\"color: #5DE4C7\"\u003eCustom item\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e'\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #E4F0FB\"\u003e          \u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003etype\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003e \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e'\u003c/span\u003e\u003cspan style=\"color: #5DE4C7\"\u003edijit/CheckedMenuItem\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e'\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #E4F0FB\"\u003e          \u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003eonClick\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003e \u003c/span\u003e\u003cspan style=\"color: #91B4D5\"\u003efunction\u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003e \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e(\u003c/span\u003e\u003cspan style=\"color: #E4F0FB\"\u003eevent\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e)\u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003e \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #ADD7FF\"\u003e            \u003c/span\u003e\u003cspan style=\"color: #E4F0FB\"\u003econsole\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e.\u003c/span\u003e\u003cspan style=\"color: #E4F0FBD0\"\u003elog\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e(\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e'\u003c/span\u003e\u003cspan style=\"color: #5DE4C7\"\u003eClicked\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e'\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #ADD7FF\"\u003e          \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e},\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #E4F0FB\"\u003e          \u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003eiconClass\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003e \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e'\u003c/span\u003e\u003cspan style=\"color: #5DE4C7\"\u003edijitIconPackage\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e'\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #E4F0FB\"\u003e        \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e},\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #ADD7FF\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #ADD7FF\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #5DE4C7C0\"\u003ereturn\u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003e \u003c/span\u003e\u003cspan style=\"color: #E4F0FB\"\u003eopts\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #ADD7FF\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e},\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #E4F0FB\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e})\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e})\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eCode listing 1. an example custom track type, MyTrack.js, that adds an extra\ntrack menu item\u003c/p\u003e\n\u003ch2 id=\"now-how-do-we-make-this-a-plugin\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#now-how-do-we-make-this-a-plugin\"\u003e\u003ca href=\"#now-how-do-we-make-this-a-plugin\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eNow how do we make this a plugin?\u003c/h2\u003e\n\u003cp\u003eIn the above section, we created a new track subclass with a custom menu option.\nHow do we use this track? We want to turn it into part of afine the boilerplate\ncode from the\n\u003ca href=\"http://gmod.org/wiki/JBrowse_Configuration_Guide#Writing_JBrowse_Plugins\"\u003eWriting plugins\u003c/a\u003e\nguide.\u003c/p\u003e\n\u003cpre class=\"shiki poimandres\" style=\"background-color: #1b1e28\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #E4F0FBD0\"\u003edefine\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e([\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e'\u003c/span\u003e\u003cspan style=\"color: #5DE4C7\"\u003edojo/_base/declare\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e'\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e, \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e'\u003c/span\u003e\u003cspan style=\"color: #5DE4C7\"\u003eJBrowse/Plugin\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e'\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e], \u003c/span\u003e\u003cspan style=\"color: #91B4D5\"\u003efunction\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e (\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #E4F0FB\"\u003edeclare\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #E4F0FB\"\u003eJBrowsePlugin\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #5DE4C7C0\"\u003ereturn\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e \u003c/span\u003e\u003cspan style=\"color: #E4F0FBD0\"\u003edeclare\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e(\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #E4F0FB\"\u003eJBrowsePlugin\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e, \u003c/span\u003e\u003cspan style=\"color: #767C9DB0; font-style: italic\"\u003e// this line says our plugin's main.js derives from the \"JBrowse/Plugin\" base class\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e    {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #E4F0FB\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003econstructor\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003e \u003c/span\u003e\u003cspan style=\"color: #91B4D5\"\u003efunction\u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003e \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e(\u003c/span\u003e\u003cspan style=\"color: #E4F0FB\"\u003eargs\u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e)\u003c/span\u003e\u003cspan style=\"color: #ADD7FF\"\u003e \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e        \u003c/span\u003e\u003cspan style=\"color: #767C9DB0; font-style: italic\"\u003e//don't necessarily have to do any initializing here, but you\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e        \u003c/span\u003e\u003cspan style=\"color: #767C9DB0; font-style: italic\"\u003e//can get a handle to various jbrowse components if any initialization\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e        \u003c/span\u003e\u003cspan style=\"color: #767C9DB0; font-style: italic\"\u003e//is needed from the args.browser variable\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #ADD7FF\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e},\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #E4F0FB\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #A6ACCD\"\u003e},\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e  )\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color: #A6ACCD\"\u003e})\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eCode listing 2. Our plugin's main.js\u003c/p\u003e\n\u003cp\u003eAfter this, we create the plugin directory structure\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003ejbrowse/plugins/MyPlugin\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003ejbrowse/plugins/MyPlugin/js\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003ejbrowse/plugins/MyPlugin/js/main.js\u003c/p\u003e\n\u003cp\u003ejbrowse/plugins/MyPlugin/js/MyTrack.js\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/blockquote\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eThen we can add our new plugin to a config file like \u003ccode\u003ejbrowse_conf.json\u003c/code\u003e as\n\u003ccode\u003e\"plugins\": [\"MyPlugin\"]\u003c/code\u003e and then make a track in \u003ccode\u003etrackList.json\u003c/code\u003e have\n\u003ccode\u003e\"type\": \"MyPlugin/MyTrack\"\u003c/code\u003e instead of for example \u003ccode\u003e\"type\": \"CanvasFeatures\"\u003c/code\u003e.\nThat will tell jbrowse to load the \u003ccode\u003eMyTrack\u003c/code\u003e class from your plugin instead of\nthe normal \u003ccode\u003eCanvasFeatures\u003c/code\u003e class.\u003c/p\u003e\n\u003cp\u003eThat's about it!\u003c/p\u003e\n\u003cp\u003eNote that the \u003ccode\u003ebin/new-plugin.pl\u003c/code\u003e script can automatically initialize some of\nthis directory structure too. Try running \u003ccode\u003ebin/new-plugin.pl MyPlugin\u003c/code\u003e and see\nwhat happens.\u003c/p\u003e\n\u003ch3 id=\"footnotes\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#footnotes\"\u003e\u003ca href=\"#footnotes\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eFootnotes:\u003c/h3\u003e\n\u003cp\u003eIt is important to understand the module format (AMD) which is what the \"define\"\nfunction is about and the dojo way of defining classes using the \"declare\"\nfunction. Together, this allows the dojo to create object-oriented programs that\nare modular in javascript. See\n\u003ca href=\"http://dojotoolkit.org/reference-guide/1.10/dojo/_base/declare.html\"\u003ehttp://dojotoolkit.org/reference-guide/1.10/dojo/_base/declare.html\u003c/a\u003e and\n\u003ca href=\"http://dojotoolkit.org/documentation/tutorials/1.9/modules/\"\u003ehttp://dojotoolkit.org/documentation/tutorials/1.9/modules/\u003c/a\u003e (understanding this\nhelps you understand the \"preamble\" for declaring a jbrowse plugin)\u003c/p\u003e"])</script><script>self.__next_f.push([1,"a:[\"$\",\"article\",null,{\"children\":[[\"$\",\"div\",null,{\"children\":[[\"$\",\"h1\",null,{\"children\":\"Creating a JBrowse plugin\"}],[\"$\",\"h4\",null,{\"children\":\"2016-11-10\"}]]}],[\"$\",\"div\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$b\"}}],[\"$\",\"$Lc\",null,{}]]}]\n4:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"Creating a JBrowse plugin\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"A blog\"}],[\"$\",\"meta\",\"3\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"link\",\"4\",{\"r"])</script><script>self.__next_f.push([1,"el\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"128x128\"}]]\n9:null\n"])</script></body></html>