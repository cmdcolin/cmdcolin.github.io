<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/_next/static/css/82eb5efba2a6c9217a68.css" as="style"/><link rel="stylesheet" href="/_next/static/css/82eb5efba2a6c9217a68.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="/_next/static/chunks/webpack-7c4c4c05609ee1ee2453.js" defer=""></script><script src="/_next/static/chunks/framework-7915ac2dcad08ccffd1a.js" defer=""></script><script src="/_next/static/chunks/main-d0187c47f4d0d1b19d72.js" defer=""></script><script src="/_next/static/chunks/pages/_app-75e0706c9e1cdf9d8afe.js" defer=""></script><script src="/_next/static/chunks/pages/2017-04-11-e7f8a77a51334bda9c34.js" defer=""></script><script src="/_next/static/aBRBZMOJeZ3Ssz59H1ZuR/_buildManifest.js" defer=""></script><script src="/_next/static/aBRBZMOJeZ3Ssz59H1ZuR/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div><a href="/">Return home</a><div class="blog"><h1>Studying nonlinear dynamics and chaos pt 2: the chaosining</h1><p>In the first part of our series
(<a href="http://searchvoidstar.tumblr.com/post/158949147558/studying-chaos-starting-with-an-overview-of-ode">http://searchvoidstar.tumblr.com/post/158949147558/studying-chaos-starting-with-an-overview-of-ode</a>),
we started reading Non-linear Dynamics and Chaos by Strogatz and found
that there are a number of mathematical concepts being introduced right
off the bat. We took it slowly and introduced the idea of the
differential equation and how to simulate one using R and the deSolve
package.</p><p>We also looked at a simple system, a damped oscillator, or basically a
spring type system that experiences some damping like friction. The last
part of the problem our figure had something called a phase plot or
&quot;portrait&quot; which is a good way to illustrate the relationship between
position and velocity of our
oscillator <a href="https://en.wikipedia.org/wiki/Phase_portrait">https://en.wikipedia.org/wiki/Phase_portrait</a></p><p><img src="../../media/159472912758_0.png"/></p><p>In this post, we will look at a &quot;damped driven oscillator&quot;, introduced
in chapter 1 of the book as well. </p><p>\</p><p>This system is similar to the simple &quot;damped oscillator&quot; but it adds an
extra &quot;forcing&quot; so that instead of just decaying, the system receives an
extra inputted force that goes back and forth. This system is well
studied because it can lead to some &quot;sporadic resonance&quot; in systems that
should not be resonating, e.g. bridge designs, and cause collapse. Here
is a good demo of a damped driven oscillator on a
table <a href="https://www.youtube.com/watch?v=OINsClhiUyo">https://www.youtube.com/watch?v=OINsClhiUyo</a></p><p>Here is the equation:\</p><p><img src="../../media/159472912758_1.png"/></p><p>We can now implement this as code by altering our first program slightly
(the plot function is switched out for ggplot2 here for fun)</p><p>\</p><pre><code>library(deSolve)
library(ggplot2)
library(cowplot)
# x1 = initial position
# x2 = initial velocity
# x3 = initial &quot;time&quot;, note that it is used by cos, and you can give it a multiplier to increase frequency
state &lt;- c(x1 = 0, x2 = 0, x3 = 0)
# b = damping constant (e.g. friction)
# m = mass
# F = oscillating force
# k = spring constant for oscillator
parameters &lt;- c(b = 0.1, F = 10, k = 30, m = 1)
DampedDrivenOscillator&lt;-function(t, state, parameters) {
 with(as.list(c(state, parameters)), {
   dX &lt;- x2
   dY &lt;- 1/m*(-k*x1-b*x2+F*cos(2*x3))
   dZ &lt;- 1
   list(c(dX, dY, dZ))
 })
}
# go from time 0 to 100, iterating by 0.01 seconds
times &lt;- seq(0, 100, by = 0.001)
# run simulation for each timestep
out &lt;- ode(y = state, times = times, func = DampedDrivenOscillator, parms = parameters)
# plot of position over time
out2=data.frame(position=out[,&#x27;x1&#x27;],velocity=out[,&#x27;x2&#x27;],t=out[,&#x27;x3&#x27;],time=out[,&#x27;time&#x27;])
# plot of variable over time
p1&lt;-ggplot(out2, aes(time, position))+geom_line()
# plot of position vs velocity
p2&lt;-ggplot(out2, aes(time, velocity))+geom_line()
# phase plot
p3&lt;-ggplot(out2, aes(position, velocity))+geom_path()
# plotting our fake &quot;time&quot; variable
p4&lt;-ggplot(out2, aes(time, t))+geom_line()
# phase plot
plot_grid(p1, p2, p3, p4, align=&#x27;hv&#x27;, labels=c(&#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;, &#x27;D&#x27;))
</code></pre><p>In this example, we can start our system at position 0, velocity 0, and
the forcing will start moving our system. We can see from this that it
begins a little chaotically but it will then fall into a &quot;resonant&quot; mode</p><p><img src="../../media/159472912758_2.png"/></p><p>\</p><p>\</p><p>If the forcing becomes very large (increase F) then it will take over
the system entirely</p><p>state \&lt;- c(x1 = 0, x2 = 0, x3 = 0)\
parameters \&lt;- c(b = 10, F = 100, k = 30, m = 1)\</p><p>\</p><p><img src="../../media/159472912758_3.png"/></p><p>Now let&#x27;s bring F back down to a small value, and then also change the
2<!-- -->*<!-- -->x3 to 0.1<!-- -->*<!-- -->x3, then we can see that the forcing is slower and will
have less influence on the system</p><p>state \&lt;- c(x1 = 0, x2 = 0, x3 = 0)\
parameters \&lt;- c(b = 0.1, F = 10, k = 30, m = 10)</p><p>\</p><p><img src="../../media/159472912758_4.png"/></p><p>\</p><p>With these examples, you can see that the forcing takes over some of the
oscillations, but that the damping will chaotically work against the
resonance. </p><p>\</p><p>There are some good take homes here. On the applied side, this system
can be applied by engineers to modelling dynamics of a structure, and we
can use our program to simulate outcomes.</p><p>For our interest though, it is also interesting that we can also just
see that chaos starts to emerge from a fairly simple set of equations.</p><p>::: {#footer}
<!-- -->[ April 11th, 2017 9:29pm ]<!-- -->{#timestamp} <!-- -->[chaos]<!-- -->{.tag} <!-- -->[R]<!-- -->{.tag}
<!-- -->[math]<!-- -->{.tag} <!-- -->[desolve]<!-- -->{.tag} <!-- -->[calculus]<!-- -->{.tag}
:::</p></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/2017-04-11","query":{},"buildId":"aBRBZMOJeZ3Ssz59H1ZuR","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>