Studying nonlinear dynamics and chaos pt 2: the chaosining
==========================================================

In the first part of our series
(<http://searchvoidstar.tumblr.com/post/158949147558/studying-chaos-starting-with-an-overview-of-ode>),
we started reading Non-linear Dynamics and Chaos by Strogatz and found
that there are a number of mathematical concepts being introduced right
off the bat. We took it slowly and introduced the idea of the
differential equation and how to simulate one using R and the deSolve
package.

We also looked at a simple system, a damped oscillator, or basically a
spring type system that experiences some damping like friction. The last
part of the problem our figure had something called a phase plot or
"portrait" which is a good way to illustrate the relationship between
position and velocity of our
oscillator <https://en.wikipedia.org/wiki/Phase_portrait>

![](../../media/159472912758_0.png)

In this post, we will look at a "damped driven oscillator", introduced
in chapter 1 of the book as well. 

\

This system is similar to the simple "damped oscillator" but it adds an
extra "forcing" so that instead of just decaying, the system receives an
extra inputted force that goes back and forth. This system is well
studied because it can lead to some "sporadic resonance" in systems that
should not be resonating, e.g. bridge designs, and cause collapse. Here
is a good demo of a damped driven oscillator on a
table <https://www.youtube.com/watch?v=OINsClhiUyo>

Here is the equation:\

![](../../media/159472912758_1.png)

We can now implement this as code by altering our first program slightly
(the plot function is switched out for ggplot2 here for fun)

\

    library(deSolve)
    library(ggplot2)
    library(cowplot)
    # x1 = initial position
    # x2 = initial velocity
    # x3 = initial "time", note that it is used by cos, and you can give it a multiplier to increase frequency
    state <- c(x1 = 0, x2 = 0, x3 = 0)
    # b = damping constant (e.g. friction)
    # m = mass
    # F = oscillating force
    # k = spring constant for oscillator
    parameters <- c(b = 0.1, F = 10, k = 30, m = 1)
    DampedDrivenOscillator<-function(t, state, parameters) {
     with(as.list(c(state, parameters)), {
       dX <- x2
       dY <- 1/m*(-k*x1-b*x2+F*cos(2*x3))
       dZ <- 1
       list(c(dX, dY, dZ))
     })
    }
    # go from time 0 to 100, iterating by 0.01 seconds
    times <- seq(0, 100, by = 0.001)
    # run simulation for each timestep
    out <- ode(y = state, times = times, func = DampedDrivenOscillator, parms = parameters)
    # plot of position over time
    out2=data.frame(position=out[,'x1'],velocity=out[,'x2'],t=out[,'x3'],time=out[,'time'])
    # plot of variable over time
    p1<-ggplot(out2, aes(time, position))+geom_line()
    # plot of position vs velocity
    p2<-ggplot(out2, aes(time, velocity))+geom_line()
    # phase plot
    p3<-ggplot(out2, aes(position, velocity))+geom_path()
    # plotting our fake "time" variable
    p4<-ggplot(out2, aes(time, t))+geom_line()
    # phase plot
    plot_grid(p1, p2, p3, p4, align='hv', labels=c('A', 'B', 'C', 'D'))

In this example, we can start our system at position 0, velocity 0, and
the forcing will start moving our system. We can see from this that it
begins a little chaotically but it will then fall into a "resonant" mode

![](../../media/159472912758_2.png)

\

\

If the forcing becomes very large (increase F) then it will take over
the system entirely

state \<- c(x1 = 0, x2 = 0, x3 = 0)\
parameters \<- c(b = 10, F = 100, k = 30, m = 1)\

\

![](../../media/159472912758_3.png)

Now let's bring F back down to a small value, and then also change the
2\*x3 to 0.1\*x3, then we can see that the forcing is slower and will
have less influence on the system

state \<- c(x1 = 0, x2 = 0, x3 = 0)\
parameters \<- c(b = 0.1, F = 10, k = 30, m = 10)

\

![](../../media/159472912758_4.png)

\

With these examples, you can see that the forcing takes over some of the
oscillations, but that the damping will chaotically work against the
resonance. 

\

There are some good take homes here. On the applied side, this system
can be applied by engineers to modelling dynamics of a structure, and we
can use our program to simulate outcomes.

For our interest though, it is also interesting that we can also just
see that chaos starts to emerge from a fairly simple set of equations.

::: {#footer}
[ April 11th, 2017 9:29pm ]{#timestamp} [chaos]{.tag} [R]{.tag}
[math]{.tag} [desolve]{.tag} [calculus]{.tag}
:::
